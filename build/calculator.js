(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class s{constructor(e){this.cells=e}getCell(e){const s=this.cells.filter((t=>t.address===e));return 0==s.length?new t(e,"0"):s[0]}}class i{static numberToEncodedLetter(e){if(isNaN(e))return;let t,s=(e=Math.abs(Math.floor(e)))%26,i=e/26;return e<=26?this.numToLetter(e):(i>=1&&(0===s&&i--,t=this.numberToEncodedLetter(i)),0===s&&(s=26),t+this.numToLetter(s))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}i.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var o=(e=>(e[e.uk=0]="uk",e[e.en=1]="en",e))(o||{});class n{constructor(e,t=!1){if(t)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const s in e)"length"!==s&&"costPerMetre"!=s&&"color"!=s&&("true"!==String(e[s])?"false"!==String(e[s])?isFinite(Number(e[s]))?t[s]=Number(e[s]):t[s]=e[s]:t[s]=0:t[s]=1);return JSON.stringify(t)}}$((function(){fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json").then((e=>e.text())).then((e=>{const o=JSON.parse(e.substring(e.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,n=new s(o.map(((e,s)=>e.c.map((function(e,o){if(null!==e&&null!==e.v)return new t(`${i.numberToEncodedLetter(o+1)}${s+1}`,e.v)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t])));document.getElementById("dollarCourse").innerText=n.getCell("G7").formattedNumerical()}));window.innerWidth||document.documentElement.clientWidth;const a=document.getElementById("total"),r=document.getElementById("totalWhole"),c=document.getElementById("space"),l=new n(o.uk,!0);function h(){return t=this,s=null,i=function*(){return u(),fetch("https://api.fortes.agency/calc",{body:l.storageToRequestBody(localStorage),headers:{"Content-Type":"application/json"},method:"POST"}).then((e=>e.json())).then((t=>{const s=parseFloat(t.cost_per_meter);l.set("costPerMetre",s),l.set("summedPrice",t.cost_per_meter*l.get("space")),a.innerText=e.formatCurrency(s),r.innerText=e.formatCurrency(s*l.get("space"))}))},new Promise(((e,o)=>{var n=e=>{try{r(i.next(e))}catch(e){o(e)}},a=e=>{try{r(i.throw(e))}catch(e){o(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,a);r((i=i.apply(t,s)).next())}));var t,s,i}function u(){l.set("space",c.value),l.set("amount_of_rooms",$("#amountOfRooms").val()),l.set("amount_of_bathrooms",$("#amountOfBathrooms").val()),l.set("heated_flooring",$("#heatedFlooring").val()),l.set("conditioning",$("#conditioning").val()),l.set("hygienic_shower",$("#hygienicShower").is(":checked")),l.set("second_gypsum_layer",$("#secondGypsumLayer").is(":checked")),l.set("furniture_bool",$("#furnitureBool").is(":checked")),l.set("bath",$("#bathtub").is(":checked")),l.set("shower",$("#shower").is(":checked")),l.set("appliances_bool_total",$("#appliancesBool").is(":checked")),l.set("floor_screed",$("#floorscreed").is(":checked")),l.set("denoising",$("#noise").is(":checked")),l.set("entrance_doors",$("#doors").is(":checked")),l.set("ceiling",$(":radio[name='ceiling']:checked").val()),l.set("flooring",$(":radio[name='flooring']:checked").val())}c.value="50",h(),$(".calculator input").not(".form-2 input").on("change",(()=>{u(),h()})),$("#space").on("focusout",(function(){if($(this).val($(this).val().toString().match(/\d*\.?\d+/)),l.set("space",c.value),0===l.get("space")||0===l.get("amount_of_rooms"))return a.innerText="0",void(r.innerText="0");h()})),c.addEventListener("focusout",(function(){(0==this.value.length||isNaN(parseInt(this.value))||parseInt(this.value)<30)&&(c.value="30",l.set("space",30),h())})),$(".increment-field .increment").on("click",(function(e){if(e.preventDefault(),$(this).siblings(".increment-input").val(parseInt($(this).siblings(".increment-input").val())+parseInt($(this).val())),"0"===$(this).siblings(".increment-input").val()?"1"===$(this).val()?$(this).siblings(".increment").toggleClass("disabled"):$(this).toggleClass("disabled"):parseInt($(this).siblings(".increment-input").val())>0&&$(this).siblings(".disabled").toggleClass("disabled"),0==l.get("amount_of_rooms"))return a.innerText="0",void(r.innerText="0");h()})),document.querySelectorAll(".calculator-tab, .tab-new").forEach((e=>e.addEventListener("click",h))),$(".choice").on("click",(function(){$("#node").is(":checked")&&($(".choiceActiveBorder").removeClass("choiceActiveBorder"),$(this).parent().toggleClass("choiceActiveBorder"),$("#appliancesBool").prop("checked",!0),$("#node").siblings("div").removeClass("w--redirected-checked"),$("#appliancesBool").siblings("div").addClass("w--redirected-checked")),l.set("appliances_bool_total",!0),l.set("appliances",$(this).data("appliances")),h()})),$("#node").on("click",(function(){l.set("appliances_bool_total",!1),h()})),$("#appliancesBool").on("click",(function(){$(this).is(":checked")&&(document.querySelector(".choiceActiveBorder")||(l.set("appliances_bool_total",1),l.set("appliances","gorenje"),h()))})),$("#appliancesBool").on("change",(function(){$(this).is(":checked")&&(l.set("appliances_bool_total",!0),h())}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW1CcEQ5QixFQUFFLFdBQVcwQyxHQUFHLFNBQVMsV0FDbkIxQyxFQUFFLFNBQVN3QyxHQUFHLGNBQ2hCeEMsRUFBRSx1QkFBdUJxRCxZQUFZLHNCQUNyQ3JELEVBQUVoRCxNQUFNc0csU0FBU0wsWUFBWSxzQkFDN0JqRCxFQUFFLG1CQUFtQnVELEtBQUssV0FBVyxHQUNyQ3ZELEVBQUUsU0FBU2dELFNBQVMsT0FBT0ssWUFBWSx5QkFDdkNyRCxFQUFFLG1CQUFtQmdELFNBQVMsT0FBT1EsU0FBUywwQkFHaEQ5RCxFQUFRSixJQUFJLHlCQUF5QixHQUNyQ0ksRUFBUUosSUFBSSxhQUFjVSxFQUFFaEQsTUFBTXlHLEtBQUssZUFDdkMzQixHQUNGLElBRUE5QixFQUFFLFNBQVMwQyxHQUFHLFNBQVMsV0FDckJoRCxFQUFRSixJQUFJLHlCQUF5QixHQUVyQ3dDLEdBQ0YsSUFFQTlCLEVBQUUsbUJBQW1CMEMsR0FBRyxTQUFTLFdBQzFCMUMsRUFBRWhELE1BQU13RixHQUFHLGNBSVhyQixTQUFTdUMsY0FBYyx5QkFDMUJoRSxFQUFRSixJQUFJLHdCQUF5QixHQUNyQ0ksRUFBUUosSUFBSSxhQUFjLFdBRTFCd0MsS0FFSixJQUVBOUIsRUFBRSxtQkFBbUIwQyxHQUFHLFVBQVUsV0FDNUIxQyxFQUFFaEQsTUFBTXdGLEdBQUcsY0FDYjlDLEVBQVFKLElBQUkseUJBQXlCLEdBQ3JDd0MsSUFFSixHQTRDRixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZm9ydGVzLy4vc3JjL3V0aWxzL0Zvcm1hdHRlci50cyIsIndlYnBhY2s6Ly9mb3J0ZXMvLi9zcmMvbW9kZWxzL0NlbGwudHMiLCJ3ZWJwYWNrOi8vZm9ydGVzLy4vc3JjL21vZGVscy9UYWJsZS50cyIsIndlYnBhY2s6Ly9mb3J0ZXMvLi9zcmMvdXRpbHMvVXRpbHMudHMiLCJ3ZWJwYWNrOi8vZm9ydGVzLy4vc3JjL3V0aWxzL0xvY2FsU3RvcmFnZUhhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vZm9ydGVzLy4vc3JjL2NhbGN1bGF0b3JfMjgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiYWJzdHJhY3QgY2xhc3MgRm9ybWF0dGVyIHtcbiAgcHVibGljIHN0YXRpYyBmb3JtYXRDdXJyZW5jeShudW06IG51bWJlcikge1xuICAgIHJldHVybiBJbnRsLk51bWJlckZvcm1hdChcInVrLVVBXCIsIHtcbiAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMixcbiAgICB9KS5mb3JtYXQobnVtKTtcbiAgfVxufVxuXG5leHBvcnQgeyBGb3JtYXR0ZXIgfTtcbiIsImltcG9ydCB7IEZvcm1hdHRlciB9IGZyb20gXCIuLi91dGlscy9Gb3JtYXR0ZXJcIjtcblxuZXhwb3J0IGNsYXNzIENlbGwge1xuICBwdWJsaWMgcmVhZG9ubHkgYWRkcmVzczogc3RyaW5nO1xuICBwcml2YXRlIHJlYWRvbmx5IF92YWx1ZTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKGFkZHJlc3M6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XG4gICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIGhhc1ZhbHVlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZSAhPT0gbnVsbCAmJiB0aGlzLl92YWx1ZS5sZW5ndGggPiAwO1xuICB9XG5cbiAgcHVibGljIHZhbHVlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICB9XG5cbiAgcHVibGljIG51bWVyaWMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGFyc2VGbG9hdCh0aGlzLl92YWx1ZSk7XG4gIH1cblxuICBwdWJsaWMgZm9ybWF0dGVkTnVtZXJpY2FsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIEZvcm1hdHRlci5mb3JtYXRDdXJyZW5jeShwYXJzZUZsb2F0KHRoaXMudmFsdWUoKSkpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBDZWxsIH0gZnJvbSBcIi4vQ2VsbFwiO1xuXG5leHBvcnQgY2xhc3MgVGFibGUge1xuICBwdWJsaWMgY2VsbHM6IENlbGxbXTtcblxuICBjb25zdHJ1Y3RvcihjZWxsczogQ2VsbFtdKSB7XG4gICAgdGhpcy5jZWxscyA9IGNlbGxzO1xuICB9XG5cbiAgZ2V0Q2VsbChhZGRyZXNzOiBzdHJpbmcpOiBDZWxsIHtcbiAgICBjb25zdCByZXN1bHQ6IENlbGxbXSA9IHRoaXMuY2VsbHMuZmlsdGVyKFxuICAgICAgKGl0ZW0pID0+IGl0ZW0uYWRkcmVzcyA9PT0gYWRkcmVzc1xuICAgICk7XG5cbiAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICByZXR1cm4gbmV3IENlbGwoYWRkcmVzcywgXCIwXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcmVzdWx0WzBdO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIFV0aWxzIHtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgYWxwaGFiZXQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaXCI7XG5cbiAgcHVibGljIHN0YXRpYyBudW1iZXJUb0VuY29kZWRMZXR0ZXIobnVtYmVyOiBudW1iZXIpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGlmIChpc05hTihudW1iZXIpKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIG51bWJlciA9IE1hdGguYWJzKE1hdGguZmxvb3IobnVtYmVyKSk7XG5cbiAgICBsZXQgaW5kZXggPSBudW1iZXIgJSAyNjtcbiAgICBsZXQgcXVvdGllbnQgPSBudW1iZXIgLyAyNjtcbiAgICBsZXQgcmVzdWx0OiBzdHJpbmc7XG5cbiAgICBpZiAobnVtYmVyIDw9IDI2KSB7XG4gICAgICByZXR1cm4gdGhpcy5udW1Ub0xldHRlcihudW1iZXIpO1xuICAgIH1cblxuICAgIGlmIChxdW90aWVudCA+PSAxKSB7XG4gICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgcXVvdGllbnQtLTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdCA9IHRoaXMubnVtYmVyVG9FbmNvZGVkTGV0dGVyKHF1b3RpZW50KTtcbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgIGluZGV4ID0gMjY7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdCArIHRoaXMubnVtVG9MZXR0ZXIoaW5kZXgpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgbnVtVG9MZXR0ZXIobnVtYmVyOiBudW1iZXIpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGlmIChudW1iZXIgPiAyNiB8fCBudW1iZXIgPCAwKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmIChudW1iZXIgPT09IDApIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5hbHBoYWJldC5zbGljZShudW1iZXIgLSAxLCBudW1iZXIpO1xuICAgIH1cbiAgfVxufVxuIiwiZW51bSBMb2NhbFN0b3JhZ2VEZXN0aW5hdGlvbiB7XG4gIHVrLFxuICBlbixcbn1cblxuY2xhc3MgTG9jYWxTdG9yYWdlSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRlc3RpbmF0aW9uOiBMb2NhbFN0b3JhZ2VEZXN0aW5hdGlvbixcbiAgICBzaG91bGRJbml0OiBib29sZWFuID0gZmFsc2VcbiAgKSB7XG4gICAgaWYgKHNob3VsZEluaXQpIHtcbiAgICAgIHN3aXRjaCAoZGVzdGluYXRpb24pIHtcbiAgICAgICAgY2FzZSBMb2NhbFN0b3JhZ2VEZXN0aW5hdGlvbi51azpcbiAgICAgICAgICB0aGlzLl9pbml0KCk7XG4gICAgICAgIGNhc2UgTG9jYWxTdG9yYWdlRGVzdGluYXRpb24uZW46XG4gICAgICAgICAgdGhpcy5faW5pdFBvcnR1Z2FsKCk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhpcy5faW5pdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldChuYW1lOiBzdHJpbmcpOiBhbnkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShuYW1lKSk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0obmFtZSk7XG4gICAgfVxuICB9XG5cbiAgc2V0KG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIHZhbHVlLnRvU3RyaW5nKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBfaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnNldChcInN0eWxlXCIsIFwiY296eVwiKTtcbiAgICB0aGlzLnNldChcImJhdGhcIiwgdHJ1ZSk7XG4gICAgdGhpcy5zZXQoXCJzaG93ZXJcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiY2VpbGluZ1wiLCBcInN0cmV0Y2ggY2VpbGluZ1wiKTtcbiAgICB0aGlzLnNldChcImZsb29yaW5nXCIsIFwibGFtaW5hdFwiKTtcbiAgICB0aGlzLnNldChcImh5Z2llbmljX3Nob3dlclwiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJzZWNvbmRfZ3lwc3VtX2xheWVyXCIsIGZhbHNlKTtcbiAgICB0aGlzLnNldChcImZsb29yX3NjcmVlZFwiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJoZWF0ZWRfZmxvb3JpbmdcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiZGVub2lzaW5nXCIsIGZhbHNlKTtcbiAgICB0aGlzLnNldChcImVudHJhbmNlX2Rvb3JzXCIsIGZhbHNlKTtcbiAgICB0aGlzLnNldChcImNvbmRpdGlvbmluZ1wiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJhbW91bnRfb2Zfcm9vbXNcIiwgMik7XG4gICAgdGhpcy5zZXQoXCJhbW91bnRfb2ZfYmF0aHJvb21zXCIsIDEpO1xuICAgIHRoaXMuc2V0KFwiYXBwbGlhbmNlc1wiLCBcImdvcmVuamVcIik7XG4gICAgdGhpcy5zZXQoXCJhcHBsaWFuY2VzX2Jvb2xfdG90YWxcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiZnVybml0dXJlX2Jvb2xcIiwgdHJ1ZSk7XG4gICAgdGhpcy5zZXQoXCJzcGFjZVwiLCA1MCk7XG4gICAgdGhpcy5zZXQoXCJjb2xvclwiLCAxKTtcbiAgfVxuXG4gIHByaXZhdGUgX2luaXRQb3J0dWdhbCgpOiB2b2lkIHtcbiAgICB0aGlzLnNldChcInN0eWxlXCIsIFwiY296eVwiKTtcbiAgICB0aGlzLnNldChcImNvbG9yXCIsIDEpO1xuICAgIHRoaXMuc2V0KFwic3BhY2VcIiwgNTApO1xuICAgIHRoaXMuc2V0KFwiYW1vdW50X29mX3Jvb21zXCIsIDIpO1xuICAgIHRoaXMuc2V0KFwiYW1vdW50X29mX2JhdGhyb29tc1wiLCAxKTtcbiAgICB0aGlzLnNldChcImJhdGhcIiwgdHJ1ZSk7XG4gICAgdGhpcy5zZXQoXCJzaG93ZXJcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiZmxvb3JpbmdcIiwgXCJsYW1pbmF0XCIpO1xuICAgIHRoaXMuc2V0KFwiZmluaXNoaW5nX21hdGVyaWFsc1wiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJkZW1vbnRhZ2VcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiY2VtZW50X3NjcmVlZFwiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJoZWF0ZWRfZmxvb3JpbmdcIiwgMCk7XG4gICAgdGhpcy5zZXQoXCJkZW5vaXNpbmdcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiZW50cmFuY2VfZG9vcnNcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwid2luZG93c19pbnN0YWxsYXRpb25cIiwgMCk7XG4gICAgdGhpcy5zZXQoXCJidWlsdGluX2Z1cm5pdHVyZVwiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJjb25kaXRpb25pbmdcIiwgMCk7XG4gICAgdGhpcy5zZXQoXCJmdXJuaXR1cmVfYm9vbFwiLCBmYWxzZSk7XG4gICAgdGhpcy5zZXQoXCJhcHBsaWFuY2VzX2Jvb2xfdG90YWxcIiwgZmFsc2UpO1xuICAgIHRoaXMuc2V0KFwiYXBwbGlhbmNlc1wiLCBcImdvcmVuamVcIik7XG4gICAgdGhpcy5zZXQoXCJ0cmFuc3BvcnRhdGlvbl9leHBlbnNlc1wiLCA1KTtcbiAgfVxuXG4gIHN0b3JhZ2VUb1JlcXVlc3RCb2R5KHN0b3JhZ2U6IFN0b3JhZ2UpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgZm9yIChjb25zdCBrZXkgaW4gc3RvcmFnZSkge1xuICAgICAgaWYgKGtleSA9PT0gXCJsZW5ndGhcIiB8fCBrZXkgPT0gXCJjb3N0UGVyTWV0cmVcIiB8fCBrZXkgPT0gXCJjb2xvclwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoU3RyaW5nKHN0b3JhZ2Vba2V5XSkgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gMTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2UgaWYgKFN0cmluZyhzdG9yYWdlW2tleV0pID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSAwO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzRmluaXRlKE51bWJlcihzdG9yYWdlW2tleV0pKSkge1xuICAgICAgICByZXN1bHRba2V5XSA9IE51bWJlcihzdG9yYWdlW2tleV0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0W2tleV0gPSBzdG9yYWdlW2tleV07XG4gICAgfVxuXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHJlc3VsdCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgTG9jYWxTdG9yYWdlSGFuZGxlciwgTG9jYWxTdG9yYWdlRGVzdGluYXRpb24gfTtcbiIsImltcG9ydCB7IENlbGwgfSBmcm9tIFwiLi9tb2RlbHMvQ2VsbFwiO1xuaW1wb3J0IHsgUmVzcG9uc2VSb3cgfSBmcm9tIFwiLi9tb2RlbHMvaW50ZXJmYWNlcy9Sb3dcIjtcbmltcG9ydCB7IFRhYmxlIH0gZnJvbSBcIi4vbW9kZWxzL1RhYmxlXCI7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gXCIuL3V0aWxzL1V0aWxzXCI7XG5pbXBvcnQgeyBGb3JtYXR0ZXIgfSBmcm9tIFwiLi91dGlscy9Gb3JtYXR0ZXJcIjtcbmltcG9ydCB7XG4gIExvY2FsU3RvcmFnZURlc3RpbmF0aW9uLFxuICBMb2NhbFN0b3JhZ2VIYW5kbGVyLFxufSBmcm9tIFwiLi91dGlscy9Mb2NhbFN0b3JhZ2VIYW5kbGVyXCI7XG5cbiQoZnVuY3Rpb24gKCkge1xuICBmZXRjaChcbiAgICBcImh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kLzFLa2twS2J5dHp0dDQ4bXdQMVJHZ3BWRnBma2U4LUlxQjBLTFdBOFNuMkZFL2d2aXovdHE/dHF4PW91dDpqc29uXCJcbiAgKVxuICAgIC50aGVuKChyZXM6IFJlc3BvbnNlKSA9PiByZXMudGV4dCgpKVxuICAgIC50aGVuKCh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShcbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zdWJzdHJpbmcodGV4dC5sZW5ndGggLSAyLCAwKVxuICAgICAgICAgIC5yZXBsYWNlKGAvKk9fbyovXFxuZ29vZ2xlLnZpc3VhbGl6YXRpb24uUXVlcnkuc2V0UmVzcG9uc2UoYCwgXCJcIilcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlUm93czogQXJyYXk8UmVzcG9uc2VSb3c+ID0gcmVzcG9uc2UudGFibGUucm93cztcblxuICAgICAgY29uc3QgdGFibGU6IFRhYmxlID0gbmV3IFRhYmxlKFxuICAgICAgICByZXNwb25zZVJvd3NcbiAgICAgICAgICAubWFwKChyb3c6IFJlc3BvbnNlUm93LCBvdXRlckluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByb3cuY1xuICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChjZWxsLCBpbmRleDogbnVtYmVyKTogQ2VsbCB7XG4gICAgICAgICAgICAgICAgaWYgKGNlbGwgPT09IG51bGwgfHwgY2VsbC52ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDZWxsKFxuICAgICAgICAgICAgICAgICAgYCR7VXRpbHMubnVtYmVyVG9FbmNvZGVkTGV0dGVyKGluZGV4ICsgMSl9JHtvdXRlckluZGV4ICsgMX1gLFxuICAgICAgICAgICAgICAgICAgY2VsbC52XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmZpbHRlcigoY2VsbCkgPT4gY2VsbCAhPSBudWxsKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5yZWR1Y2UoKHB2LCBjdikgPT4gWy4uLnB2LCAuLi5jdl0pXG4gICAgICApO1xuXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRvbGxhckNvdXJzZVwiKS5pbm5lclRleHQgPSB0YWJsZVxuICAgICAgICAuZ2V0Q2VsbChcIkc3XCIpXG4gICAgICAgIC5mb3JtYXR0ZWROdW1lcmljYWwoKTtcbiAgICB9KTtcblxuICBjb25zdCB2dyA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcblxuICBjb25zdCAkdG90YWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsXCIpO1xuICBjb25zdCAkdG90YWxXaG9sZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG90YWxXaG9sZVwiKTtcbiAgY29uc3QgJHNwYWNlID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzcGFjZVwiKTtcbiAgY29uc3Qgc3RvcmFnZTogTG9jYWxTdG9yYWdlSGFuZGxlciA9IG5ldyBMb2NhbFN0b3JhZ2VIYW5kbGVyKFxuICAgIExvY2FsU3RvcmFnZURlc3RpbmF0aW9uLnVrLFxuICAgIHRydWVcbiAgKTtcblxuICAkc3BhY2UudmFsdWUgPSBcIjUwXCI7XG5cbiAgY2FsY3VsYXRlKCk7XG5cbiAgJChcIi5jYWxjdWxhdG9yIGlucHV0XCIpXG4gICAgLm5vdChcIi5mb3JtLTIgaW5wdXRcIilcbiAgICAub24oXCJjaGFuZ2VcIiwgKCkgPT4ge1xuICAgICAgdXBkYXRlVXNlckRhdGEoKTtcbiAgICAgIGNhbGN1bGF0ZSgpO1xuICAgIH0pO1xuXG4gICQoXCIjc3BhY2VcIikub24oXCJmb2N1c291dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzKS52YWwoXG4gICAgICAkKHRoaXMpXG4gICAgICAgIC52YWwoKVxuICAgICAgICAudG9TdHJpbmcoKVxuICAgICAgICAubWF0Y2goL1xcZCpcXC4/XFxkKy8pXG4gICAgKTtcbiAgICBzdG9yYWdlLnNldChcInNwYWNlXCIsICRzcGFjZS52YWx1ZSk7XG5cbiAgICBpZiAoc3RvcmFnZS5nZXQoXCJzcGFjZVwiKSA9PT0gMCB8fCBzdG9yYWdlLmdldChcImFtb3VudF9vZl9yb29tc1wiKSA9PT0gMCkge1xuICAgICAgJHRvdGFsLmlubmVyVGV4dCA9IFwiMFwiO1xuICAgICAgJHRvdGFsV2hvbGUuaW5uZXJUZXh0ID0gXCIwXCI7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYWxjdWxhdGUoKTtcbiAgfSk7XG5cbiAgJHNwYWNlLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c291dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKFxuICAgICAgdGhpcy52YWx1ZS5sZW5ndGggPT0gMCB8fFxuICAgICAgaXNOYU4ocGFyc2VJbnQodGhpcy52YWx1ZSkpIHx8XG4gICAgICBwYXJzZUludCh0aGlzLnZhbHVlKSA8IDMwXG4gICAgKSB7XG4gICAgICAkc3BhY2UudmFsdWUgPSBcIjMwXCI7XG4gICAgICBzdG9yYWdlLnNldChcInNwYWNlXCIsIDMwKTtcbiAgICAgIGNhbGN1bGF0ZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgJChcIi5pbmNyZW1lbnQtZmllbGQgLmluY3JlbWVudFwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgJCh0aGlzKVxuICAgICAgLnNpYmxpbmdzKFwiLmluY3JlbWVudC1pbnB1dFwiKVxuICAgICAgLnZhbChcbiAgICAgICAgcGFyc2VJbnQoJCh0aGlzKS5zaWJsaW5ncyhcIi5pbmNyZW1lbnQtaW5wdXRcIikudmFsKCkgYXMgc3RyaW5nKSArXG4gICAgICAgICAgcGFyc2VJbnQoJCh0aGlzKS52YWwoKSBhcyBzdHJpbmcpXG4gICAgICApO1xuXG4gICAgaWYgKCQodGhpcykuc2libGluZ3MoXCIuaW5jcmVtZW50LWlucHV0XCIpLnZhbCgpID09PSBcIjBcIikge1xuICAgICAgaWYgKCQodGhpcykudmFsKCkgPT09IFwiMVwiKSB7XG4gICAgICAgICQodGhpcykuc2libGluZ3MoXCIuaW5jcmVtZW50XCIpLnRvZ2dsZUNsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIHBhcnNlSW50KDxzdHJpbmc+JCh0aGlzKS5zaWJsaW5ncyhcIi5pbmNyZW1lbnQtaW5wdXRcIikudmFsKCkpID4gMFxuICAgICkge1xuICAgICAgJCh0aGlzKS5zaWJsaW5ncyhcIi5kaXNhYmxlZFwiKS50b2dnbGVDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgIH1cblxuICAgIGlmIChzdG9yYWdlLmdldChcImFtb3VudF9vZl9yb29tc1wiKSA9PSAwKSB7XG4gICAgICAkdG90YWwuaW5uZXJUZXh0ID0gXCIwXCI7XG4gICAgICAkdG90YWxXaG9sZS5pbm5lclRleHQgPSBcIjBcIjtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYWxjdWxhdGUoKTtcbiAgfSk7XG5cbiAgZG9jdW1lbnRcbiAgICAucXVlcnlTZWxlY3RvckFsbChcIi5jYWxjdWxhdG9yLXRhYiwgLnRhYi1uZXdcIilcbiAgICAuZm9yRWFjaCgoZWxlbSkgPT4gZWxlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2FsY3VsYXRlKSk7XG5cbiAgLyokKFwiI2NhbGN1bGF0ZVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzbGlkZU51bWJlcjogbnVtYmVyID0gcGFyc2VJbnQoXG4gICAgICAkKFwiLnNsaWRlci10YWIudy0tY3VycmVudFwiKS5kYXRhKFwic2xpZGVyLWluZGV4XCIpXG4gICAgKTtcbiAgICBnZXRVc2VyU3R5bGUoc2xpZGVOdW1iZXIpO1xuICAgICQoXCIuY2FsY3VsYXRvci10YWJcIikucmVtb3ZlQ2xhc3MoXCJ3LS1jdXJyZW50XCIpO1xuICAgICQoXCIuY2FsY3VsYXRvci10YWJbZGF0YS1zbGlkZXItaW5kZXg9J1wiICsgc2xpZGVOdW1iZXIgKyBcIiddXCIpLmFkZENsYXNzKFxuICAgICAgXCJ3LS1jdXJyZW50XCJcbiAgICApO1xuICAgIGNhbGN1bGF0ZSgpO1xuICAgICQoXCIuY2FsY3VsYXRvci1zbGlkZVwiKS50b2dnbGUoZmFsc2UpO1xuICAgICQoXCIuY2FsY3VsYXRvci1zbGlkZS5tYWluXCIpLnRvZ2dsZSh0cnVlKTtcbiAgICAkKFwiLmNhbGN1bGF0b3Itc2xpZGUuXCIgKyBzdG9yYWdlLmdldChcInN0eWxlXCIpKS50b2dnbGUodHJ1ZSk7XG4gICAgJChcIi5jYWxjdWxhdG9yLXNsaWRlci1vcHRpb24uYWN0aXZlXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICQoXCIuY2FsY3VsYXRvci1zbGlkZXItb3B0aW9uOmVxKDApXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICB9KTsqL1xuXG4gICQoXCIuY2hvaWNlXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKFwiI25vZGVcIikuaXMoXCI6Y2hlY2tlZFwiKSkge1xuICAgICAgJChcIi5jaG9pY2VBY3RpdmVCb3JkZXJcIikucmVtb3ZlQ2xhc3MoXCJjaG9pY2VBY3RpdmVCb3JkZXJcIik7XG4gICAgICAkKHRoaXMpLnBhcmVudCgpLnRvZ2dsZUNsYXNzKFwiY2hvaWNlQWN0aXZlQm9yZGVyXCIpO1xuICAgICAgJChcIiNhcHBsaWFuY2VzQm9vbFwiKS5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcbiAgICAgICQoXCIjbm9kZVwiKS5zaWJsaW5ncyhcImRpdlwiKS5yZW1vdmVDbGFzcyhcInctLXJlZGlyZWN0ZWQtY2hlY2tlZFwiKTtcbiAgICAgICQoXCIjYXBwbGlhbmNlc0Jvb2xcIikuc2libGluZ3MoXCJkaXZcIikuYWRkQ2xhc3MoXCJ3LS1yZWRpcmVjdGVkLWNoZWNrZWRcIik7XG4gICAgfVxuXG4gICAgc3RvcmFnZS5zZXQoXCJhcHBsaWFuY2VzX2Jvb2xfdG90YWxcIiwgdHJ1ZSk7XG4gICAgc3RvcmFnZS5zZXQoXCJhcHBsaWFuY2VzXCIsICQodGhpcykuZGF0YShcImFwcGxpYW5jZXNcIikpO1xuICAgIGNhbGN1bGF0ZSgpO1xuICB9KTtcblxuICAkKFwiI25vZGVcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgc3RvcmFnZS5zZXQoXCJhcHBsaWFuY2VzX2Jvb2xfdG90YWxcIiwgZmFsc2UpO1xuXG4gICAgY2FsY3VsYXRlKCk7XG4gIH0pO1xuXG4gICQoXCIjYXBwbGlhbmNlc0Jvb2xcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCEkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hvaWNlQWN0aXZlQm9yZGVyXCIpKSB7XG4gICAgICBzdG9yYWdlLnNldChcImFwcGxpYW5jZXNfYm9vbF90b3RhbFwiLCAxKTtcbiAgICAgIHN0b3JhZ2Uuc2V0KFwiYXBwbGlhbmNlc1wiLCBcImdvcmVuamVcIik7XG5cbiAgICAgIGNhbGN1bGF0ZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgJChcIiNhcHBsaWFuY2VzQm9vbFwiKS5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCQodGhpcykuaXMoXCI6Y2hlY2tlZFwiKSkge1xuICAgICAgc3RvcmFnZS5zZXQoXCJhcHBsaWFuY2VzX2Jvb2xfdG90YWxcIiwgdHJ1ZSk7XG4gICAgICBjYWxjdWxhdGUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIGNhbGN1bGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB1cGRhdGVVc2VyRGF0YSgpO1xuXG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcGkuZm9ydGVzLmFnZW5jeS9jYWxjXCIsIHtcbiAgICAgIGJvZHk6IHN0b3JhZ2Uuc3RvcmFnZVRvUmVxdWVzdEJvZHkobG9jYWxTdG9yYWdlKSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgICBjb25zdCBjb3N0ID0gcGFyc2VGbG9hdChqc29uLmNvc3RfcGVyX21ldGVyKTtcblxuICAgICAgICBzdG9yYWdlLnNldChcImNvc3RQZXJNZXRyZVwiLCBjb3N0KTtcbiAgICAgICAgc3RvcmFnZS5zZXQoXCJzdW1tZWRQcmljZVwiLCBqc29uLmNvc3RfcGVyX21ldGVyICogc3RvcmFnZS5nZXQoXCJzcGFjZVwiKSk7XG5cbiAgICAgICAgJHRvdGFsLmlubmVyVGV4dCA9IEZvcm1hdHRlci5mb3JtYXRDdXJyZW5jeShjb3N0KTtcbiAgICAgICAgJHRvdGFsV2hvbGUuaW5uZXJUZXh0ID0gRm9ybWF0dGVyLmZvcm1hdEN1cnJlbmN5KFxuICAgICAgICAgIGNvc3QgKiBzdG9yYWdlLmdldChcInNwYWNlXCIpXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZVVzZXJEYXRhKCkge1xuICAgIHN0b3JhZ2Uuc2V0KFwic3BhY2VcIiwgJHNwYWNlLnZhbHVlKTtcbiAgICBzdG9yYWdlLnNldChcImFtb3VudF9vZl9yb29tc1wiLCAkKFwiI2Ftb3VudE9mUm9vbXNcIikudmFsKCkpO1xuICAgIHN0b3JhZ2Uuc2V0KFwiYW1vdW50X29mX2JhdGhyb29tc1wiLCAkKFwiI2Ftb3VudE9mQmF0aHJvb21zXCIpLnZhbCgpKTtcbiAgICBzdG9yYWdlLnNldChcImhlYXRlZF9mbG9vcmluZ1wiLCAkKFwiI2hlYXRlZEZsb29yaW5nXCIpLnZhbCgpKTtcbiAgICBzdG9yYWdlLnNldChcImNvbmRpdGlvbmluZ1wiLCAkKFwiI2NvbmRpdGlvbmluZ1wiKS52YWwoKSk7XG4gICAgc3RvcmFnZS5zZXQoXCJoeWdpZW5pY19zaG93ZXJcIiwgJChcIiNoeWdpZW5pY1Nob3dlclwiKS5pcyhcIjpjaGVja2VkXCIpKTtcbiAgICBzdG9yYWdlLnNldChcInNlY29uZF9neXBzdW1fbGF5ZXJcIiwgJChcIiNzZWNvbmRHeXBzdW1MYXllclwiKS5pcyhcIjpjaGVja2VkXCIpKTtcbiAgICBzdG9yYWdlLnNldChcImZ1cm5pdHVyZV9ib29sXCIsICQoXCIjZnVybml0dXJlQm9vbFwiKS5pcyhcIjpjaGVja2VkXCIpKTtcbiAgICBzdG9yYWdlLnNldChcImJhdGhcIiwgJChcIiNiYXRodHViXCIpLmlzKFwiOmNoZWNrZWRcIikpO1xuICAgIHN0b3JhZ2Uuc2V0KFwic2hvd2VyXCIsICQoXCIjc2hvd2VyXCIpLmlzKFwiOmNoZWNrZWRcIikpO1xuICAgIHN0b3JhZ2Uuc2V0KFwiYXBwbGlhbmNlc19ib29sX3RvdGFsXCIsICQoXCIjYXBwbGlhbmNlc0Jvb2xcIikuaXMoXCI6Y2hlY2tlZFwiKSk7XG4gICAgc3RvcmFnZS5zZXQoXCJmbG9vcl9zY3JlZWRcIiwgJChcIiNmbG9vcnNjcmVlZFwiKS5pcyhcIjpjaGVja2VkXCIpKTtcbiAgICBzdG9yYWdlLnNldChcImRlbm9pc2luZ1wiLCAkKFwiI25vaXNlXCIpLmlzKFwiOmNoZWNrZWRcIikpO1xuICAgIHN0b3JhZ2Uuc2V0KFwiZW50cmFuY2VfZG9vcnNcIiwgJChcIiNkb29yc1wiKS5pcyhcIjpjaGVja2VkXCIpKTtcbiAgICBzdG9yYWdlLnNldChcImNlaWxpbmdcIiwgJChcIjpyYWRpb1tuYW1lPSdjZWlsaW5nJ106Y2hlY2tlZFwiKS52YWwoKSk7XG4gICAgc3RvcmFnZS5zZXQoXCJmbG9vcmluZ1wiLCAkKFwiOnJhZGlvW25hbWU9J2Zsb29yaW5nJ106Y2hlY2tlZFwiKS52YWwoKSk7XG4gIH1cbn0pO1xuIl0sIm5hbWVzIjpbIkZvcm1hdHRlciIsIm51bSIsIkludGwiLCJOdW1iZXJGb3JtYXQiLCJtYXhpbXVtRnJhY3Rpb25EaWdpdHMiLCJmb3JtYXQiLCJDZWxsIiwiY29uc3RydWN0b3IiLCJhZGRyZXNzIiwidmFsdWUiLCJ0aGlzIiwiX3ZhbHVlIiwiaGFzVmFsdWUiLCJsZW5ndGgiLCJudW1lcmljIiwicGFyc2VGbG9hdCIsImZvcm1hdHRlZE51bWVyaWNhbCIsImZvcm1hdEN1cnJlbmN5IiwiVGFibGUiLCJjZWxscyIsImdldENlbGwiLCJyZXN1bHQiLCJmaWx0ZXIiLCJpdGVtIiwiVXRpbHMiLCJudW1iZXIiLCJpc05hTiIsImluZGV4IiwiTWF0aCIsImFicyIsImZsb29yIiwicXVvdGllbnQiLCJudW1Ub0xldHRlciIsIm51bWJlclRvRW5jb2RlZExldHRlciIsImFscGhhYmV0Iiwic2xpY2UiLCJMb2NhbFN0b3JhZ2VEZXN0aW5hdGlvbiIsIkxvY2FsU3RvcmFnZUhhbmRsZXIiLCJkZXN0aW5hdGlvbiIsInNob3VsZEluaXQiLCJfaW5pdCIsIl9pbml0UG9ydHVnYWwiLCJnZXQiLCJuYW1lIiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNldCIsInNldEl0ZW0iLCJ0b1N0cmluZyIsInN0b3JhZ2VUb1JlcXVlc3RCb2R5Iiwic3RvcmFnZSIsImtleSIsIlN0cmluZyIsImlzRmluaXRlIiwiTnVtYmVyIiwic3RyaW5naWZ5IiwiJCIsImZldGNoIiwidGhlbiIsInJlcyIsInRleHQiLCJyZXNwb25zZVJvd3MiLCJzdWJzdHJpbmciLCJyZXBsYWNlIiwidGFibGUiLCJyb3dzIiwibWFwIiwicm93Iiwib3V0ZXJJbmRleCIsImMiLCJjZWxsIiwidiIsInJlZHVjZSIsInB2IiwiY3YiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJUZXh0Iiwid2luZG93IiwiaW5uZXJXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwiJHRvdGFsIiwiJHRvdGFsV2hvbGUiLCIkc3BhY2UiLCJ1ayIsImNhbGN1bGF0ZSIsInVwZGF0ZVVzZXJEYXRhIiwiYm9keSIsImhlYWRlcnMiLCJtZXRob2QiLCJyZXNwb25zZSIsImpzb24iLCJjb3N0IiwiY29zdF9wZXJfbWV0ZXIiLCJ2YWwiLCJpcyIsIm5vdCIsIm9uIiwibWF0Y2giLCJhZGRFdmVudExpc3RlbmVyIiwicGFyc2VJbnQiLCJlIiwicHJldmVudERlZmF1bHQiLCJzaWJsaW5ncyIsInRvZ2dsZUNsYXNzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbGVtIiwicmVtb3ZlQ2xhc3MiLCJwYXJlbnQiLCJwcm9wIiwiYWRkQ2xhc3MiLCJkYXRhIiwicXVlcnlTZWxlY3RvciJdLCJzb3VyY2VSb290IjoiIn0=