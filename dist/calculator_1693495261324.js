(()=>{"use strict";var R={};class k{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class I{constructor(e,t){this.address=e,this._value=t}hasValue(){return this._value!==null&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return k.formatCurrency(parseFloat(this.value()))}}class L{constructor(e){this.cells=e}getCell(e){const t=this.cells.filter(n=>n.address===e);return t.length==0?new I(e,"0"):t[0]}}class C{static numberToEncodedLetter(e){if(isNaN(e))return;e=Math.abs(Math.floor(e));let t=e%26,n=e/26,a;return e<=26?this.numToLetter(e):(n>=1&&(t===0&&n--,a=this.numberToEncodedLetter(n)),t===0&&(t=26),a+this.numToLetter(t))}static numToLetter(e){if(!(e>26||e<0))return e===0?"":this.alphabet.slice(e-1,e)}static containsRuPath(e){const t=e.split(/\/(?=.)/);return t.includes("ru")||t.includes("blog-ru")}}C.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var x=(i=>(i[i.uk=0]="uk",i[i.en=1]="en",i))(x||{});class N{constructor(e,t=!1){if(t)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const n in e)if(!(n==="length"||n=="costPerMetre"||n=="color")){if(String(e[n])==="true"){t[n]=1;continue}else if(String(e[n])==="false"){t[n]=0;continue}if(isFinite(Number(e[n]))){t[n]=Number(e[n]);continue}t[n]=e[n]}return JSON.stringify(t)}}function P(i,e,t){var n,a,c;e===void 0&&(e=50),t===void 0&&(t={});var p=(n=t.isImmediate)!=null&&n,l=(a=t.callback)!=null&&a,r=t.maxWait,m=Date.now(),h=[];function v(){if(r!==void 0){var u=Date.now()-m;if(u+e>=r)return r-u}return e}var f=function(){var u=[].slice.call(arguments),g=this;return new Promise(function(b,E){var s=p&&c===void 0;if(c!==void 0&&clearTimeout(c),c=setTimeout(function(){if(c=void 0,m=Date.now(),!p){var _=i.apply(g,u);l&&l(_),h.forEach(function(w){return(0,w.resolve)(_)}),h=[]}},v()),s){var d=i.apply(g,u);return l&&l(d),b(d)}h.push({resolve:b,reject:E})})};return f.cancel=function(u){c!==void 0&&clearTimeout(c),h.forEach(function(g){return(0,g.reject)(u)}),h=[]},f}var q=(i,e,t)=>new Promise((n,a)=>{var c=r=>{try{l(t.next(r))}catch(m){a(m)}},p=r=>{try{l(t.throw(r))}catch(m){a(m)}},l=r=>r.done?n(r.value):Promise.resolve(r.value).then(c,p);l((t=t.apply(i,e)).next())});$(function(){fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json").then(o=>o.text()).then(o=>{const F=JSON.parse(o.substring(o.length-2,0).replace(`/*O_o*/
google.visualization.Query.setResponse(`,"")).table.rows,A=new L(F.map((T,S)=>T.c.map(function(y,O){return y===null||y.v===null?new I("","0"):new I(`${C.numberToEncodedLetter(O+1)}${S+1}`,y.v)}).filter(y=>y!=null)).reduce((T,S)=>[...T,...S]));document.getElementById("dollarCourse").innerText=A.getCell("G7").formattedNumerical()});const i=document.getElementById("floorscreed"),e=document.getElementById("doors"),t=document.getElementById("noise"),n=document.getElementById("bathtub"),a=document.getElementById("shower"),c=document.getElementById("conditioning"),p=document.getElementById("secondGypsumLayer"),l=document.getElementById("hygienicShower"),r=document.getElementById("furnitureBool"),m=document.getElementById("appliancesBool"),h=document.getElementById("total"),v=document.getElementById("totalWhole"),f=document.getElementById("space"),u=document.getElementById("amountOfRooms"),g=document.getElementById("amountOfBathrooms"),b=document.getElementById("heatedFlooring"),E=document.getElementById("node"),s=new N(x.uk,!0);f.value="50";const d=P(_,300);_(),document.querySelectorAll("div.calculator form input").forEach(o=>o.addEventListener("change",()=>d())),$("#space").on("focusout",function(){if($(this).val($(this).val().toString().match(/\d*\.?\d+/)),s.set("space",f.value),parseInt(f.value)===0||parseInt(u.value)===0){h.innerText="0",v.innerText="0";return}d()}),f.addEventListener("focusout",function(){(this.value.length==0||isNaN(parseInt(this.value))||parseInt(this.value)<30)&&(f.value="30",s.set("space",30),d())}),$(".increment-field .increment").on("click",function(o){if(o.preventDefault(),$(this).siblings(".increment-input").val(parseInt($(this).siblings(".increment-input").val())+parseInt($(this).val())),$(this).siblings(".increment-input").val()==="0"?$(this).val()==="1"?$(this).siblings(".increment").toggleClass("disabled"):$(this).toggleClass("disabled"):parseInt($(this).siblings(".increment-input").val())>0&&$(this).siblings(".disabled").toggleClass("disabled"),s.get("amount_of_rooms")==0){h.innerText="0",v.innerText="0";return}d()}),document.querySelectorAll(".calculator-tab, .tab-new").forEach(o=>o.addEventListener("click",()=>d())),$(".choice").on("click",function(){$("#node").is(":checked")&&($(".choiceActiveBorder").removeClass("choiceActiveBorder"),$(this).parent().toggleClass("choiceActiveBorder"),$("#appliancesBool").prop("checked",!0),$("#node").siblings("div").removeClass("w--redirected-checked"),$("#appliancesBool").siblings("div").addClass("w--redirected-checked")),s.set("appliances_bool_total",!0),s.set("appliances",$(this).data("appliances")),d()}),E.addEventListener("click",function(){var o;this.checked&&(s.set("appliances_bool_total",!1),(o=document.querySelector("div.choiceActiveBorder.choice-gradient"))==null||o.classList.remove("choiceActiveBorder"))}),$("#appliancesBool").on("click",function(){$(this).is(":checked")&&(document.querySelector(".choiceActiveBorder")||(s.set("appliances_bool_total",1),s.set("appliances","gorenje"),d()))});function _(){return q(this,null,function*(){return w(),fetch("https://api.fortes.agency/calc",{body:s.storageToRequestBody(localStorage),headers:{"Content-Type":"application/json"},method:"POST"}).then(o=>o.json()).then(o=>{const B=parseFloat(o.cost_per_meter);s.set("costPerMetre",B),s.set("summedPrice",o.cost_per_meter*s.get("space")),h.innerText=k.formatCurrency(B),v.innerText=k.formatCurrency(B*s.get("space"))})})}function w(){s.set("space",f.value),s.set("amount_of_rooms",u.value),s.set("amount_of_bathrooms",g.value),s.set("heated_flooring",b.value),s.set("conditioning",c.value),s.set("hygienic_shower",l.checked),s.set("second_gypsum_layer",p.checked),s.set("furniture_bool",r.checked),s.set("bath",n.checked),s.set("shower",a.checked),s.set("appliances_bool_total",m.checked),s.set("floor_screed",i.checked),s.set("denoising",t.checked),s.set("entrance_doors",e.checked),s.set("ceiling",document.querySelector('input[type="radio"][name="ceiling"]:checked').value),s.set("flooring",document.querySelector('input[type="radio"][name="flooring"]:checked').value)}})})();
