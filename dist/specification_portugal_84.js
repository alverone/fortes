(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class n{constructor(e){this.cells=e}getCell(e){const n=this.cells.filter((t=>t.address===e));return 0==n.length?new t(e,"0"):n[0]}}var i=(e=>(e[e.uk=0]="uk",e[e.en=1]="en",e))(i||{});class o{constructor(e,t=!1){if(t)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const n in e)"length"!==n&&"costPerMetre"!=n&&"color"!=n&&("true"!==String(e[n])?"false"!==String(e[n])?isFinite(Number(e[n]))?t[n]=Number(e[n]):t[n]=e[n]:t[n]=0:t[n]=1);return JSON.stringify(t)}}class a{static numberToEncodedLetter(e){if(isNaN(e))return;let t,n=(e=Math.abs(Math.floor(e)))%26,i=e/26;return e<=26?this.numToLetter(e):(i>=1&&(0===n&&i--,t=this.numberToEncodedLetter(i)),0===n&&(n=26),t+this.numToLetter(n))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}a.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class s{}s.kCost="Cost",s.kAmount="Amount",s.kKitchen="Kitchen",s.kLMonth="month";var l,r=(e=>(e.Cozy="cozy",e.Japandi="japandi",e.Modern="modern",e.Fusion="fusion",e.NeoClassic="neoclassic",e))(r||{});(l=r||(r={})).fromString=function(e){return"japandi"===e?"japandi":"neoclassic"===e?"neoclassic":"modern"===e?"modern":"fusion"===e?"fusion":"cozy"},l.fromNumber=function(e){return 0===e?"cozy":1===e?"japandi":2===e?"fusion":3===e?"modern":"neoclassic"},l.inUkrainian=function(e){switch(e){case"neoclassic":return"Нео Класика";case"japandi":return"Джапанді";case"fusion":return"Фьюжн";case"modern":return"Модерн";default:return"Козі"}};var c=(e,t,n)=>new Promise(((i,o)=>{var a=e=>{try{l(n.next(e))}catch(e){o(e)}},s=e=>{try{l(n.throw(e))}catch(e){o(e)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);l((n=n.apply(e,t)).next())}));class g{constructor(e){this._storage=e}collectPortugalClientData(e){return c(this,null,(function*(){return fetch("https://script.google.com/macros/s/AKfycbzyzzY4bi4yQoHdsTeVmm8BxGQ-bGW_-rK_erhrFA0zKak6rQ27p-k9Mx3HWk6vKEIatw/exec",{method:"POST",body:e}).catch((e=>console.error("Failed to collect consultation data!",e.message)))}))}collectClientData(e){return c(this,null,(function*(){return fetch("https://script.google.com/macros/s/AKfycbyTfAJSAOSn1mB5Ua10w0AHAdKLb1weCd3ve139FkPzbqLEPnBeiE8gGGTq5S6XhmevIQ/exec",{method:"POST",body:e}).catch((e=>console.error("Failed to collect consultation data!",e.message)))}))}collectCalcData(){return c(this,null,(function*(){const e=new FormData,t=r.fromString(this._storage.get("style")),n=this._storage.get("space"),i=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+("modern"==t||"neoclassic"==t?1:0);e.append("Стиль",r.inUkrainian(t)),e.append("Ціна за метр",this._storage.get("costPerMetre")),e.append("Загальна ціна",this._storage.get("summedPrice")),e.append("Площа",n),e.append("Кількість кімнат",this._storage.get("amount_of_rooms")),e.append("Кількість санвузлів",this._storage.get("amount_of_bathrooms")),e.append("Ванна",this._storage.get("bath")?"1":"0"),e.append("Душ",this._storage.get("shower")?"1":"0");const o=this._storage.get("ceiling"),a=this._storage.get("flooring"),s="stretch ceiling"==o?"Натяжна матова":"gapless"==o?"Натяжна бесщелева матова":"Гіпсокартон",l="laminat"==a?"Ламінат":"vynil"==a?"Вінілова підлога":"Паркет",c=this._storage.get("appliances_bool_total")?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"Не обрано";return e.append("Стеля",s),e.append("Підлогове покриття",l),e.append("Стяжка підлоги",this._storage.get("floor_screed")?"1":"0"),e.append("Шумоізоляція",this._storage.get("denoising")?"1":"0"),e.append("Вхідні двері",this._storage.get("entrance_doors")?"1":"0"),e.append("Другий шар гіпсокартону",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("Гігієнічний душ",this._storage.get("hygienic_shower")?"1":"0"),e.append("Тепла підлога",this._storage.get("heated_flooring")?"1":"0"),e.append("Кондиціювання",this._storage.get("conditioning")?"1":"0"),e.append("Меблі",this._storage.get("furniture_bool")?"1":"0"),e.append("Техніка",c),e.append("Термін виконання робіт",i.toString()),fetch("https://script.google.com/macros/s/AKfycbyt7QOcA0Dp_2voHy2w1rVGCllwvW_SX_V8iDTD5E7zJohqH0C4/exec",{method:"POST",body:e}).catch((e=>console.error(e)))}))}collectSpecificationData(){return c(this,null,(function*(){const e=new FormData,t=r.fromString(this._storage.get("style")),n=this._storage.get("space"),i=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+("modern"==t||"neoclassic"==t?1:0);e.append("Стиль",r.inUkrainian(t)),e.append("Ціна за метр",this._storage.get("costPerMetre")),e.append("Загальна ціна",this._storage.get("summedPrice")),e.append("Площа",n),e.append("Кількість кімнат",this._storage.get("amount_of_rooms")),e.append("Кількість санвузлів",this._storage.get("amount_of_bathrooms")),e.append("Ванна",this._storage.get("bath")?"1":"0"),e.append("Душ",this._storage.get("shower")?"1":"0");const o=this._storage.get("ceiling"),a=this._storage.get("flooring"),s="stretch ceiling"==o?"Натяжна матова":"gapless"==o?"Натяжна бесщелева матова":"Гіпсокартон",l="laminat"==a?"Ламінат":"vynil"==a?"Вінілова підлога":"Паркет",c=this._storage.get("appliances_bool_total")?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"Не обрано";return e.append("Стеля",s),e.append("Підлогове покриття",l),e.append("Стяжка підлоги",this._storage.get("floor_screed")?"1":"0"),e.append("Шумоізоляція",this._storage.get("denoising")?"1":"0"),e.append("Вхідні двері",this._storage.get("entrance_doors")?"1":"0"),e.append("Другий шар гіпсокартону",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("Гігієнічний душ",this._storage.get("hygienic_shower")?"1":"0"),e.append("Тепла підлога",this._storage.get("heated_flooring")?"1":"0"),e.append("Кондиціювання",this._storage.get("conditioning")?"1":"0"),e.append("Меблі",this._storage.get("furniture_bool")?"1":"0"),e.append("Техніка",c),e.append("Термін виконання робіт",i.toString()),e.append("Ім'я",document.getElementById("sName").value),e.append("Телефон",document.getElementById("sName").value),e.append("Поштова скринька",document.getElementById("sName").value),fetch("https://script.google.com/macros/s/AKfycbzymV7zIns6N9AdE882E44BwQAFZ_wy0JNIahqsoDWx3kqLi-U/exec",{method:"POST",body:e}).catch((e=>console.error(e)))}))}collectPortugalCalcData(t){return c(this,null,(function*(){const n=Boolean(this._storage.get("appliances_bool_total")),i=Boolean(this._storage.get("furniture_bool")),o=this._storage.get("space"),a=Boolean(this._storage.get("bath")),s=Boolean(this._storage.get("shower")),l=this._storage.get("amount_of_rooms"),r=this._storage.get("amount_of_bathrooms"),c=Boolean(this._storage.get("demontage")),g=this._storage.get("windows_installation"),p=Boolean(this._storage.get("finishing_materials")),u=Boolean(this._storage.get("cement_screed")),d=Boolean(this._storage.get("builtin_furiture")),m=this._storage.get("heated_flooring"),h=Boolean(this._storage.get("denoising")),v=Boolean(this._storage.get("entrance_doors")),f=this._storage.get("conditioning"),C=this._storage.get("flooring"),_=this._storage.get("transportation_expenses"),$=this._storage.get("appliances"),y=this._storage.get("summedPrice"),w=this._storage.get("costPerMetre"),b=(o<=40?3:o<=80?4:o<=100?5:o<=130?6:o<=150?7:o<=175?8:9)+("modern"==t||"neoclassic"==t?1:0),k=new FormData;return k.append("Style",t),k.append("Total cost VAT",e.formatCurrency(y)),k.append("Total cost",e.formatCurrency(y/1.23)),k.append("Cost per metre",e.formatCurrency(w)),k.append("Cost per metre VAT",e.formatCurrency(1.23*w)),k.append("Area",o.toString()),k.append("Number of bedrooms",l.toString()),k.append("Number of bathrooms",r.toString()),k.append("Bath",a?"1":"0"),k.append("Shower",s?"1":"0"),k.append("Distance from Lisbon",_.toString()),k.append("Flooring",C),k.append("Finishing materials",p?"1":"0"),k.append("Dismantling works",c?"1":"0"),k.append("Cement screed",u?"1":"0"),k.append("Entrance doors",v?"1":"0"),k.append("Soundproofing",h?"1":"0"),k.append("Built-in furniture",d?"1":"0"),k.append("Underfloor heating",m.toString()),k.append("Air conditioning",f.toString()),k.append("Window installation",g.toString()),k.append("Decorating",i?"1":"0"),k.append("Appliances",n?$:"0"),k.append("Time to completion",b.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:k}).catch((e=>console.error(e)))}))}collectPortugalSpecificationData(t){return c(this,null,(function*(){const n=this._storage.get("style"),i=Boolean(this._storage.get("appliances_bool_total")),o=Boolean(this._storage.get("furniture_bool")),a=this._storage.get("space"),s=Boolean(this._storage.get("bath")),l=Boolean(this._storage.get("shower")),r=this._storage.get("amount_of_rooms"),c=this._storage.get("amount_of_bathrooms"),g=Boolean(this._storage.get("demontage")),p=this._storage.get("windows_installation"),u=Boolean(this._storage.get("finishing_materials")),d=Boolean(this._storage.get("cement_screed")),m=Boolean(this._storage.get("builtin_furiture")),h=this._storage.get("heated_flooring"),v=Boolean(this._storage.get("denoising")),f=Boolean(this._storage.get("entrance_doors")),C=this._storage.get("conditioning"),_=this._storage.get("flooring"),$=this._storage.get("transportation_expenses"),y=this._storage.get("appliances"),w=this._storage.get("summedPrice"),b=this._storage.get("costPerMetre"),k=(a<=40?3:a<=80?4:a<=100?5:a<=130?6:a<=150?7:a<=175?8:9)+("modern"==n||"neoclassic"==n?1:0);return t.append("Style",n),t.append("Total cost VAT",e.formatCurrency(w)),t.append("Total cost",e.formatCurrency(w/1.23)),t.append("Cost per metre",e.formatCurrency(b)),t.append("Cost per metre VAT",e.formatCurrency(1.23*b)),t.append("Area",a.toString()),t.append("Number of bedrooms",r.toString()),t.append("Number of bathrooms",c.toString()),t.append("Bath",s?"1":"0"),t.append("Shower",l?"1":"0"),t.append("Distance from Lisbon",$.toString()),t.append("Flooring",_),t.append("Finishing materials",u?"1":"0"),t.append("Dismantling works",g?"1":"0"),t.append("Cement screed",d?"1":"0"),t.append("Entrance doors",f?"1":"0"),t.append("Soundproofing",v?"1":"0"),t.append("Built-in furniture",m?"1":"0"),t.append("Underfloor heating",h.toString()),t.append("Air conditioning",C.toString()),t.append("Window installation",p.toString()),t.append("Decorating",o?"1":"0"),t.append("Appliances",i?y:"0"),t.append("Time to completion",k.toString()),fetch("https://script.google.com/macros/s/AKfycbzwN8RKdZRUWDBLNnvUwxxK9FXHUVPeqPpGFJYu9NT9zLsc34JKzIHgHz1CwFbNYGzs/exec",{method:"POST",body:t}).catch((e=>console.error(e)))}))}}var p=(e,t,n)=>new Promise(((i,o)=>{var a=e=>{try{l(n.next(e))}catch(e){o(e)}},s=e=>{try{l(n.throw(e))}catch(e){o(e)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);l((n=n.apply(e,t)).next())}));$((function(){const l=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r=new o(i.en,!1),c=new g(r),u=r.get("style"),d=(function(e){let t="J";"cozy"==e?t="J":"japandi"==e?t="L":"fusion"==e?t="N":"modern"==e?t="P":"neoclassic"==e&&(t="R")}(u),Boolean(r.get("appliances_bool_total"))),m=Boolean(r.get("furniture_bool")),h=r.get("space"),v=Boolean(r.get("bath")),f=Boolean(r.get("shower")),C=r.get("amount_of_rooms"),_=r.get("amount_of_bathrooms"),y=Boolean(r.get("demontage")),w=r.get("windows_installation"),b=Boolean(r.get("finishing_materials")),k=Boolean(r.get("cement_screed")),S=Boolean(r.get("builtin_furiture")),F=r.get("heated_flooring"),L=Boolean(r.get("denoising")),B=Boolean(r.get("entrance_doors")),x=r.get("conditioning"),P=r.get("flooring"),T=r.get("transportation_expenses"),A=r.get("appliances"),E=r.get("summedPrice"),N=r.get("costPerMetre"),D=$("#furnitureList");let G="",M="",z=0,I=0;const K=(h<=40?3:h<=80?4:h<=100?5:h<=130?6:h<=150?7:h<=175?8:9)+("modern"==u||"neoclassic"==u?1:0);$("#months").html(K.toString()),$("#total").html(e.formatCurrency(E)),$("#space").html(h.toString()),$("#pricePerMetre").html(e.formatCurrency(N)),fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json&gid=1219923480").then((e=>e.text())).then((i=>{var o,l,r,c,g,p,E,N,q,j,O,U,V,W,Q,R,Y,Z,X,ee,te,ne,ie,oe,ae,se,le,re,ce,ge,pe,ue,de,me,he,ve,fe,Ce,_e,$e,ye,we,be,ke,Se,Fe,Le,Be,xe,Pe,Te,Ae,Ee,Ne,De,Ge,Me,ze,Ie,Ke,qe,je,Oe;const Ue=JSON.parse(i.substring(i.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,Je=new n(Ue.map(((e,n)=>e.c.map((function(e,i){var o;if(null!==e&&null!==e.v)return new t(`${a.numberToEncodedLetter(i+1)}${n+1}`,null!=(o=e.v)?o:e.f)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t]))),He=Je.getCell("S46").numeric(),Ve=Je.getCell("S44").numeric(),We=Je.getCell("S69").numeric(),Qe=Je.getCell("T103").numeric(),Re=Je.getCell("S104").numeric();"cozy"==u?(G="I",M="A"):"japandi"==u?(G="K",M="B"):"fusion"==u?(G="M",M="C"):"modern"==u?(G="O",M="D"):"neoclassic"==u&&(G="Q",M="E");let Ye,Ze,Xe=0;"vynil"==P?(Ye="60",Ze="86",Xe=h*(h<70?220.33:161.8)*He*3):"parket"==P?(Ye="61",Ze="87",Xe=h*(h<80?369.96:240.31)*He*2):(Ye="59",Ze="85",Xe=h*(h<70?201.26:198.81)*He*2);const et=$("#workList");let tt="";const nt=2523*((C>0?6:0)+(v?2:0)+(f?2:0)+2*_)*He*2*Ve+(v?1:0)*_*2500*2*Ve*He-950*He/41+4e3*(f?1:0)*_*2*Ve*He-800*He/41,it=1974*((C>0?3:0)+(v?1:0)+(f?1:0)+2*_)*He*2*Ve,ot=h*_*(h<=100?83.2:33.98)*Ve*He*2,at=(h/C<=50?850*h:24*C*3519)*He*Ve,st=[Je.getCell("J47").numeric()/Ve,Je.getCell("J48").numeric()/Ve,h/C<=50?h*(h<=60?1142.78:h<=95?883.87:819.43)*He*1.45:4*Math.sqrt(h)*3*600*He,h*(h<=60?283.08:h<=95?281.22:h<=124?338.33:362.47)*He*1.35*1.45,h*(h<=60?700.67:h<=100?687.36:h<=130?341.25:317.36)*He*1.1*1.5/2,2100*He,(h/C<50?1.77*(h<=50?1e3*h:990*h):4*Math.sqrt(h)*3*600)*He,h*(h<=60?418.86:h<=100?416.29:h<=135?416.73:416.67)*1.77*He,140*(h<=60?40:h<=80?50:h<=120?78:h<=180?114:162)*("modern"==u||"neoclassic"==u?1:0)*1.77*He,Xe,h*(h<=70?114.47:86.84)*He*2,h*(h<=70?206.59:170)*He*2*("japandi"==u||"fusion"==u?1:0)],lt=[f?_:0,v?_:0,1,1,_,_+C,1,1,1,1,"japandi"!==u&&"fusion"!==u?1:0,"japandi"===u||"fusion"===u?1:0],rt=[47,48,50,51,52,53,55,56,57,Ye,63,64];z+=nt,tt=J(Je.getCell("F44").value(),"",Math.round(nt)+" €"),$("#workList").append(tt),z+=it,tt=J(Je.getCell("F45").value(),"",Math.round(it)+" €"),$("#workList").append(tt),z+=ot,tt=J(Je.getCell("F46").value(),"",Math.round(ot)+" €"),$("#workList").append(tt),z+=at,tt=J(Je.getCell("F49").value(),"",Math.round(at)+" €"),$("#workList").append(tt);for(let e=0;e<rt.length;e++){const t=st[e]*lt[e]*Ve;0===t||isNaN(t)||(z+=t,tt=J(Je.getCell("F"+rt[e]).value(),"",Math.round(t)+" €"),$("#workList").append(tt))}if(b){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Je.getCell("F68").value()}</h4><span class='notation amount'> </span><span class='notation'>${s.kCost}</span>`);const e=[Je.getCell(`${G}69`).numeric(),Je.getCell(`${G}70`).numeric(),Je.getCell(`${G}71`).numeric(),Je.getCell(`${G}72`).numeric(),Je.getCell(`${G}73`).numeric(),Je.getCell(`${G}74`).numeric(),Je.getCell(`${G}76`).numeric(),Je.getCell(`${G}77`).numeric(),Je.getCell(`${G}78`).numeric(),Je.getCell(`${G}79`).numeric(),Je.getCell(`${G}80`).numeric(),Je.getCell(`${G}81`).numeric(),Je.getCell(`${G}82`).numeric(),Je.getCell(`${G+Ze}`).numeric()];let t=[_+C,35*_,.66*h,.66*h,.59*h,h<=50?42:h<=90?60:h<=120?84:90,_,Number(v),Number(f),Number(v)+Number(f),_,_,_,h<100?h-7*_:h-10*_];const n=[69,70,71,72,73,74,76,77,78,79,80,81,82,Ze];for(let i=0;i<n.length;i++){const o=e[i]*t[i]*Je.getCell("S69").numeric()/1.23;0===o||isNaN(o)||(z+=o,tt=J(Je.getCell("F"+n[i]).value(),"",Math.round(o)+"€"),$("#workList").append(tt))}}tt=`<div class="option-block">\n      <div class="division-block pricelist"></div>\n      <div class="list-option-container">\n        <span class='name'>${Je.getCell("F93").value()}</span>\n        <span class='list-text amount'>${K} months</span>\n        <span class='list-text'> </span>\n      </div>\n    </div>`,$("#workList").append(tt);const ct=[(41e3*Math.ceil((T+2)/5)/1.35/2/1.5+100*h)*Ve*He,.022*z*He,(2*K*1200+3e3+220*h)*Ve*He],gt=[94,95,96];tt="";for(let t=0;t<gt.length;t++){const n=ct[t];z+=n,tt+=`<div class="option-block">\n        <div class="division-block pricelist"></div>\n        <div class="list-option-container">\n          <span class='name'>${Je.getCell(`F${gt[t]}`).value()}</span>\n            <span class='list-text amount'></span>\n          <span class='list-text'>${e.formatCurrency(n)} €</span>\n        </div>\n      </div>`}$("#workList").append(tt),tt="",H(et,'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),H($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(z)} €</span>`),m&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${s.kKitchen}</h4>\n          <span class='notation amount'>${s.kAmount}</span>\n          <span class='notation'>${s.kCost}</span>`),pt(Je.getCell("F121").value(),null==(o=Je.getCell(`${M}121`))?void 0:o.value(),1,Je.getCell(`${G}121`).numeric(),Je.getCell("G121").value()),pt(Je.getCell("F122").value(),null==(l=Je.getCell(`${M}122`))?void 0:l.value(),4,Je.getCell(`${G}122`).numeric(),Je.getCell("G122").value()),pt(Je.getCell("F123").value(),null==(r=Je.getCell(`${M}123`))?void 0:r.value(),1,Je.getCell(`${G}123`).numeric(),Je.getCell("G123").value()),H($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),H($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Je.getCell("F124").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),pt(Je.getCell("F124").value(),null==(c=Je.getCell(M+"124"))?void 0:c.value(),1,null==(g=Je.getCell(`${G}124`))?void 0:g.numeric(),null==(p=Je.getCell("G124"))?void 0:p.value()),pt(Je.getCell("F125").value(),null==(E=Je.getCell(M+"125"))?void 0:E.value(),1,null==(N=Je.getCell(`${G}125`))?void 0:N.numeric(),null==(q=Je.getCell("G125"))?void 0:q.value()),H($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),H($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Je.getCell("F127").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),pt(Je.getCell("F128").value(),null==(j=Je.getCell(M+"128"))?void 0:j.value(),1,null==(O=Je.getCell(`${G}128`))?void 0:O.numeric(),null==(U=Je.getCell("G128"))?void 0:U.value()),pt(Je.getCell("F129").value(),null==(V=Je.getCell(M+"129"))?void 0:V.value(),1,null==(W=Je.getCell(`${G}129`))?void 0:W.numeric(),null==(Q=Je.getCell("G129"))?void 0:Q.value()),pt(Je.getCell("F130").value(),null==(R=Je.getCell(M+"130"))?void 0:R.value(),2,null==(Y=Je.getCell(`${G}130`))?void 0:Y.numeric(),null==(Z=Je.getCell("G130"))?void 0:Z.value()),pt(Je.getCell("F131").value(),null==(X=Je.getCell(M+"131"))?void 0:X.value(),1,null==(ee=Je.getCell(`${G}131`))?void 0:ee.numeric(),null==(te=Je.getCell("G131"))?void 0:te.value()),pt(Je.getCell("F132").value(),null==(ne=Je.getCell(M+"132"))?void 0:ne.value(),1,null==(ie=Je.getCell(`${G}132`))?void 0:ie.numeric(),null==(oe=Je.getCell("G132"))?void 0:oe.value()),H($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Je.getCell("F133").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),pt(Je.getCell("F134").value(),null==(ae=Je.getCell(M+"134"))?void 0:ae.value(),Math.ceil(.48*h),null==(se=Je.getCell(`${G}134`))?void 0:se.numeric(),null==(le=Je.getCell("G134"))?void 0:le.value()),pt(Je.getCell("F135").value(),null==(re=Je.getCell(M+"135"))?void 0:re.value(),1,null==(ce=Je.getCell(`${G}135`))?void 0:ce.numeric(),null==(ge=Je.getCell("G135"))?void 0:ge.value()),pt(Je.getCell("F137").value(),null==(pe=Je.getCell(M+"137"))?void 0:pe.value(),1,null==(ue=Je.getCell(`${G}137`))?void 0:ue.numeric(),null==(de=Je.getCell("G137"))?void 0:de.value()),pt(Je.getCell("F139").value(),null==(me=Je.getCell(M+"139"))?void 0:me.value(),1,null==(he=Je.getCell(`${G}139`))?void 0:he.numeric(),null==(ve=Je.getCell("G139"))?void 0:ve.value()),pt(Je.getCell("F140").value(),null==(fe=Je.getCell(M+"140"))?void 0:fe.value(),1,null==(Ce=Je.getCell(`${G}140`))?void 0:Ce.numeric(),null==(_e=Je.getCell("G140"))?void 0:_e.value()),pt(Je.getCell("F136").value(),null==($e=Je.getCell(M+"136"))?void 0:$e.value(),C>1?1:0,null==(ye=Je.getCell(`${G}136`))?void 0:ye.numeric(),null==(we=Je.getCell("G136"))?void 0:we.value()),pt(Je.getCell("F138").value(),null==(be=Je.getCell(M+"138"))?void 0:be.value(),2,null==(ke=Je.getCell(`${G}138`))?void 0:ke.numeric(),null==(Se=Je.getCell("G138"))?void 0:Se.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Je.getCell("F141").value()}</h4>\n            <span class='notation amount'>${s.kAmount}</span>\n            <span class='notation'>${s.kCost}</span>`),pt(Je.getCell("F142").value(),null==(Fe=Je.getCell(M+"142"))?void 0:Fe.value(),C,null==(Le=Je.getCell(`${G}142`))?void 0:Le.numeric(),null==(Be=Je.getCell("G142"))?void 0:Be.value()),pt(Je.getCell("F143").value(),null==(xe=Je.getCell(M+"143"))?void 0:xe.value(),C,null==(Pe=Je.getCell(`${G}143`))?void 0:Pe.numeric(),null==(Te=Je.getCell("G143"))?void 0:Te.value()),pt(Je.getCell("F144").value(),null==(Ae=Je.getCell(M+"144"))?void 0:Ae.value(),C,null==(Ee=Je.getCell(`${G}144`))?void 0:Ee.numeric(),null==(Ne=Je.getCell("G144"))?void 0:Ne.value()),pt(Je.getCell("F145").value(),null==(De=Je.getCell(M+"145"))?void 0:De.value(),1,null==(Ge=Je.getCell(`${G}145`))?void 0:Ge.numeric(),null==(Me=Je.getCell("G145"))?void 0:Me.value()),pt(Je.getCell("F146").value(),null==(ze=Je.getCell(M+"146"))?void 0:ze.value(),C-1,null==(Ie=Je.getCell(`${G}146`))?void 0:Ie.numeric(),null==(Ke=Je.getCell("G146"))?void 0:Ke.value()),H($("#furnitureList"),J(Je.getCell("F147").value()," ",Math.round(.3*I)+"€")),I*=1.3,H($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),H($("#furnitureList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for furniture:</span><span class='list-text summary work'>${e.formatCurrency(I)} €</span>`));if(S||k||b||w||y||F>0||L||B||x){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Je.getCell("F102").value()}</h4><span class='notation amount'></span><span class='notation'>${s.kCost}</span>`);let t=0;const n=[Je.getCell(`${G}103`).numeric()*h,Je.getCell(`${G}104`).numeric(),(h<=60?440:410)*He*2*h*Ve/Re,Je.getCell(`${G}106`).numeric(),((h<=60?90.02:h<=95?60.78:h<125?58.29:h>=125?79.01:0)+(h<=60?60.91:h<=95?64.57:h<125?63.87:h>=125?66.24:0))*h*Qe,Je.getCell(`${G}108`).numeric()/1.23,Je.getCell(`${G}109`).numeric()*We/Re,Je.getCell(`${G}110`).numeric()*We/Re,Je.getCell(`${G}112`).numeric()*h],i=[y?1:0,w,k?1:0,F,L?1:0,B?1:0,S?1:0,S?1:0,x],o=[103,104,105,106,107,108,109,110,112];for(let a=0;a<o.length;a++){const s=n[a]*i[a]*Je.getCell("S104").numeric();0!==s&&0!=i[a]&&(t+=s,H(et,J(null==(qe=Je.getCell("F"+o[a]))?void 0:qe.value(),"",e.formatCurrency(s)+" €")))}if(x>0){const n=x*Je.getCell(`${G}113`).numeric()*(1+Je.getCell("S113").numeric()/100)/Je.getCell("E5").numeric(),i=.05*n*Qe;H(et,J(null==(je=Je.getCell("F113"))?void 0:je.value(),"",e.formatCurrency(n)+" €")),H(et,J(null==(Oe=Je.getCell("F114"))?void 0:Oe.value(),"",e.formatCurrency(i)+" €")),t+=i+n}H($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),H($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for options:</span><span class='list-text summary work'>${e.formatCurrency(t)} €</span>`),z+=t}function pt(t,n,i,o,a){m&&0!=i&&i&&o&&(I+=o*i,H(D,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),null!==n?H($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${t}, ${n}</span><span class='list-text amount'>${i} ${a}</span><span class='list-text'>${e.formatCurrency(o*i)} €</span>`):H($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${t}</span><span class='list-text'>${i} ${a}</span>`))}d||$(".comfy-section").toggle(!1),m||$("#furnitureList").toggle(!1),H($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),H($("#materialsList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(z)} €</span>`);let ut=0;const dt=document.getElementById("appliancesListTotal"),mt=[];if("gorenje"===A?mt.push(154,9):"bosch"===A?mt.push(169,10):"smeg"===A?mt.push(185,9):mt.push(154,9),d){let t="";for(let n=0;n<mt[1];n++){const i=.9*Je.getCell("D"+(mt[0]+n)).numeric();t+=`<div class="option-block">\n          <div class="division-block pricelist"></div>\n          <div class="list-option-container"><span class='name'>${Je.getCell("F"+(mt[0]+n)).value()} ${Je.getCell("E"+(mt[0]+n)).value()}</span>\n            <span class='list-text amount'>1 piece</span>\n            <span class='list-text'>${e.formatCurrency(i)}€</span>\n            </div>\n            </div>`,ut+=i}const n=Je.getCell("G35").numeric(),i=Je.getCell("E5").numeric();ut+=mt[1]*n/i,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>Appliances delivery</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(mt[1]*n/i)} €</span></div></div>`,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Je.getCell("F165").value()}</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(.2*ut)} €</span></div></div>`,ut*=1.2,t+=`<div class="division-block pricelist"></div><div class="list-option-container summary"><span class='pricelist-header small no-padding'>Total for appliances:</span><span class='list-text summary work'>${e.formatCurrency(ut)} €</span></div>`,dt.innerHTML=dt.innerHTML+t}else dt.style.display="none";if(S){const t=Je.getCell(`${G}109`).numeric();$("#kitchenPrice").html(e.formatCurrency(t*We)+" €")}else $("#kitchenSection").toggle(!1);z+=ut,$("#totalPriceTotal").html(e.formatCurrency(z)+" € *"),$("#totalVAT").html(e.formatCurrency(1.23*z)+" € *"),$("#total").html(e.formatCurrency(1.23*z))})),$("#wf-form-consult").on("submit",(function(e){if(e.preventDefault(),$("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox:not(.specification)").toggle(!1):$(".warning.agreementcheckbox:not(.specification)").toggle(!0),$("#phone").val()?$(".warning.phone:not(.specification)").toggle(!1):$(".warning.phone:not(.specification)").toggle(!0),$("#name").val()?$(".warning.name:not(.specification)").toggle(!1):$(".warning.name:not(.specification)").toggle(!0),$(".warning:not(.specification)").is(":visible"))return e.preventDefault(),!1;c.collectPortugalClientData(new FormData(document.getElementById("wf-form-consult")))}));const q=document.getElementById("sName"),j=document.getElementById("sEmail");$("#wf-form-specification").on("submit",(function(e){return p(this,null,(function*(){e.preventDefault();const t=j.value;if($("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox.specification").toggle(!1):$(".warning.agreementcheckbox.specification").toggle(!0),q.value.length<2?$(".warning.name.specification").toggle(!0):$(".warning.name.specification").toggle(!1),0==t.length?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!0)):l.test(t)?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!1)):($(".warning.wrongEmail.specification").toggle(!0),$(".warning.emptyEmail.specification").toggle(!1)),$(".warning.specification").is(":visible"))return e.stopImmediatePropagation(),!1;c.collectPortugalSpecificationData(new FormData(document.getElementById("wf-form-specification"))),function(){return p(this,null,(function*(){$(".modal-note.specification").html("Please wait...");const e=$("html").clone().find("script").remove().end().html(),t=new File(['<!DOCTYPE html><html lang="en_US">'+e+"</html>"],"source.html",{type:"text/html"}),n=new FormData;n.append("file",t,"source.html");const i=yield fetch("https://api.fortes.agency/convert",{method:"POST",body:n}),o=yield i.json(),a=o.success?o.id:"";$(".modal-note.specification").html("We sent your estimation to your email address. If you don't see it, check Spam folder or wait a few minutes.");const s=q.value,l=j.value,r=new Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}).format(new Date).replace(/\//g,"-");return fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:a,fileName:`${s} ${r}`,recipientMail:l,lang:"eng",name:s}),headers:{"Content-Type":"application/json"}})}))}().finally((()=>{window.location.assign("/sdyakuiemo")}))}))})),document.querySelector('input[name="Phone-Number"]').name="Phone Number";const O=document.querySelector("div.modal-container.consult"),U=document.querySelector("div.modal-container.specification-final");function J(e,t,n){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${e}</span><span class='list-text amount'>${t}</span><span class='list-text'>${n}</span></div></div>`}function H(e,t){e.append(t)}document.querySelectorAll('.gradientrevamped[data-click-action="consultation"]').forEach((e=>e.addEventListener("click",(()=>{O.classList.add("shown")})))),document.querySelector("div.consult-modal .cross-button").addEventListener("click",(()=>O.classList.remove("shown"))),O.addEventListener("click",(()=>O.classList.remove("shown"))),document.querySelectorAll('.gradientrevamped[data-click-action="specification"]').forEach((e=>e.addEventListener("click",(()=>{U.classList.add("shown")})))),document.querySelector("div.specification-modal .cross-button").addEventListener("click",(()=>U.classList.remove("shown"))),U.addEventListener("click",(()=>U.classList.remove("shown"))),document.querySelector("div.consult-modal").addEventListener("click",(function(e){e.stopPropagation()})),document.querySelector("div.specification-modal").addEventListener("click",(function(e){e.stopPropagation()})),$("img").each((function(){$(this).attr("loading","eager")}))}))})();