(()=>{"use strict";var Gt={};class p{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class me{constructor(e,s){this.address=e,this._value=s}hasValue(){return this._value!==null&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return p.formatCurrency(parseFloat(this.value()))}}class Bt{constructor(e){this.cells=e}getCell(e){const s=this.cells.filter(i=>i.address===e);return s.length==0?new me(e,"0"):s[0]}}var he=(r=>(r[r.uk=0]="uk",r[r.en=1]="en",r))(he||{});class Dt{constructor(e,s=!1){if(s)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(s){return localStorage.getItem(e)}}set(e,s){localStorage.setItem(e,s.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const s={};for(const i in e)if(!(i==="length"||i=="costPerMetre"||i=="color")){if(String(e[i])==="true"){s[i]=1;continue}else if(String(e[i])==="false"){s[i]=0;continue}if(isFinite(Number(e[i]))){s[i]=Number(e[i]);continue}s[i]=e[i]}return JSON.stringify(s)}}class fe{static numberToEncodedLetter(e){if(isNaN(e))return;e=Math.abs(Math.floor(e));let s=e%26,i=e/26,a;return e<=26?this.numToLetter(e):(i>=1&&(s===0&&i--,a=this.numberToEncodedLetter(i)),s===0&&(s=26),a+this.numToLetter(s))}static numToLetter(e){if(!(e>26||e<0))return e===0?"":this.alphabet.slice(e-1,e)}}fe.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class D{}D.kCost="Cost",D.kAmount="Amount",D.kKitchen="Kitchen",D.kLMonth="month";var G=(r=>(r.Cozy="cozy",r.Japandi="japandi",r.Modern="modern",r.Fusion="fusion",r.NeoClassic="neoclassic",r))(G||{});(r=>{function e(a){return a==="japandi"?"japandi":a==="neoclassic"?"neoclassic":a==="modern"?"modern":a==="fusion"?"fusion":"cozy"}r.fromString=e;function s(a){return a===0?"cozy":a===1?"japandi":a===2?"fusion":a===3?"modern":"neoclassic"}r.fromNumber=s;function i(a){switch(a){case"neoclassic":return"\u041D\u0435\u043E \u041A\u043B\u0430\u0441\u0438\u043A\u0430";case"japandi":return"\u0414\u0436\u0430\u043F\u0430\u043D\u0434\u0456";case"fusion":return"\u0424\u044C\u044E\u0436\u043D";case"modern":return"\u041C\u043E\u0434\u0435\u0440\u043D";case"cozy":default:return"\u041A\u043E\u0437\u0456"}}r.inUkrainian=i})(G||(G={}));var I=(r,e,s)=>new Promise((i,a)=>{var f=u=>{try{n(s.next(u))}catch(v){a(v)}},E=u=>{try{n(s.throw(u))}catch(v){a(v)}},n=u=>u.done?i(u.value):Promise.resolve(u.value).then(f,E);n((s=s.apply(r,e)).next())});class Et{constructor(e){this._storage=e}collectPortugalClientData(e){return I(this,null,function*(){return fetch("https://script.google.com/macros/s/AKfycbzyzzY4bi4yQoHdsTeVmm8BxGQ-bGW_-rK_erhrFA0zKak6rQ27p-k9Mx3HWk6vKEIatw/exec",{method:"POST",body:e}).catch(s=>console.error("Failed to collect consultation data!",s.message))})}collectClientData(e){return I(this,null,function*(){return fetch("https://script.google.com/macros/s/AKfycbyTfAJSAOSn1mB5Ua10w0AHAdKLb1weCd3ve139FkPzbqLEPnBeiE8gGGTq5S6XhmevIQ/exec",{method:"POST",body:e}).catch(s=>console.error("Failed to collect consultation data!",s.message))})}collectCalcData(){return I(this,null,function*(){const e=new FormData,s=G.fromString(this._storage.get("style")),i=this._storage.get("space"),a=(i<=40?3:i<=80?4:i<=100?5:i<=130?6:i<=150?7:i<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);e.append("\u0421\u0442\u0438\u043B\u044C",G.inUkrainian(s)),e.append("\u0426\u0456\u043D\u0430 \u0437\u0430 \u043C\u0435\u0442\u0440",this._storage.get("costPerMetre")),e.append("\u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430",this._storage.get("summedPrice")),e.append("\u041F\u043B\u043E\u0449\u0430",i),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u043A\u0456\u043C\u043D\u0430\u0442",this._storage.get("amount_of_rooms")),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0430\u043D\u0432\u0443\u0437\u043B\u0456\u0432",this._storage.get("amount_of_bathrooms")),e.append("\u0412\u0430\u043D\u043D\u0430",this._storage.get("bath")?"1":"0"),e.append("\u0414\u0443\u0448",this._storage.get("shower")?"1":"0");const f=this._storage.get("ceiling"),E=this._storage.get("flooring"),n=this._storage.get("appliances_bool_total"),u=f=="stretch ceiling"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":f=="gapless"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u0431\u0435\u0441\u0449\u0435\u043B\u0435\u0432\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":"\u0413\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D",v=E=="laminat"?"\u041B\u0430\u043C\u0456\u043D\u0430\u0442":E=="vynil"?"\u0412\u0456\u043D\u0456\u043B\u043E\u0432\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430":"\u041F\u0430\u0440\u043A\u0435\u0442",y=n?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"\u041D\u0435 \u043E\u0431\u0440\u0430\u043D\u043E";return e.append("\u0421\u0442\u0435\u043B\u044F",u),e.append("\u041F\u0456\u0434\u043B\u043E\u0433\u043E\u0432\u0435 \u043F\u043E\u043A\u0440\u0438\u0442\u0442\u044F",v),e.append("\u0421\u0442\u044F\u0436\u043A\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0438",this._storage.get("floor_screed")?"1":"0"),e.append("\u0428\u0443\u043C\u043E\u0456\u0437\u043E\u043B\u044F\u0446\u0456\u044F",this._storage.get("denoising")?"1":"0"),e.append("\u0412\u0445\u0456\u0434\u043D\u0456 \u0434\u0432\u0435\u0440\u0456",this._storage.get("entrance_doors")?"1":"0"),e.append("\u0414\u0440\u0443\u0433\u0438\u0439 \u0448\u0430\u0440 \u0433\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D\u0443",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("\u0413\u0456\u0433\u0456\u0454\u043D\u0456\u0447\u043D\u0438\u0439 \u0434\u0443\u0448",this._storage.get("hygienic_shower")?"1":"0"),e.append("\u0422\u0435\u043F\u043B\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430",this._storage.get("heated_flooring")?"1":"0"),e.append("\u041A\u043E\u043D\u0434\u0438\u0446\u0456\u044E\u0432\u0430\u043D\u043D\u044F",this._storage.get("conditioning")?"1":"0"),e.append("\u041C\u0435\u0431\u043B\u0456",this._storage.get("furniture_bool")?"1":"0"),e.append("\u0422\u0435\u0445\u043D\u0456\u043A\u0430",y),e.append("\u0422\u0435\u0440\u043C\u0456\u043D \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u0456\u0442",a.toString()),fetch("https://script.google.com/macros/s/AKfycbyt7QOcA0Dp_2voHy2w1rVGCllwvW_SX_V8iDTD5E7zJohqH0C4/exec",{method:"POST",body:e}).catch(d=>console.error(d))})}collectSpecificationData(e){return I(this,null,function*(){const s=G.fromString(this._storage.get("style")),i=this._storage.get("space"),a=(i<=40?3:i<=80?4:i<=100?5:i<=130?6:i<=150?7:i<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);e.append("\u0421\u0442\u0438\u043B\u044C",G.inUkrainian(s)),e.append("\u0426\u0456\u043D\u0430 \u0437\u0430 \u043C\u0435\u0442\u0440",this._storage.get("costPerMetre")),e.append("\u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430",this._storage.get("summedPrice")),e.append("\u041F\u043B\u043E\u0449\u0430",i),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u043A\u0456\u043C\u043D\u0430\u0442",this._storage.get("amount_of_rooms")),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0430\u043D\u0432\u0443\u0437\u043B\u0456\u0432",this._storage.get("amount_of_bathrooms")),e.append("\u0412\u0430\u043D\u043D\u0430",this._storage.get("bath")?"1":"0"),e.append("\u0414\u0443\u0448",this._storage.get("shower")?"1":"0");const f=this._storage.get("ceiling"),E=this._storage.get("flooring"),n=this._storage.get("appliances_bool_total"),u=f=="stretch ceiling"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":f=="gapless"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u0431\u0435\u0441\u0449\u0435\u043B\u0435\u0432\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":"\u0413\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D",v=E=="laminat"?"\u041B\u0430\u043C\u0456\u043D\u0430\u0442":E=="vynil"?"\u0412\u0456\u043D\u0456\u043B\u043E\u0432\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430":"\u041F\u0430\u0440\u043A\u0435\u0442",y=n?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"\u041D\u0435 \u043E\u0431\u0440\u0430\u043D\u043E";return e.append("\u0421\u0442\u0435\u043B\u044F",u),e.append("\u041F\u0456\u0434\u043B\u043E\u0433\u043E\u0432\u0435 \u043F\u043E\u043A\u0440\u0438\u0442\u0442\u044F",v),e.append("\u0421\u0442\u044F\u0436\u043A\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0438",this._storage.get("floor_screed")?"1":"0"),e.append("\u0428\u0443\u043C\u043E\u0456\u0437\u043E\u043B\u044F\u0446\u0456\u044F",this._storage.get("denoising")?"1":"0"),e.append("\u0412\u0445\u0456\u0434\u043D\u0456 \u0434\u0432\u0435\u0440\u0456",this._storage.get("entrance_doors")?"1":"0"),e.append("\u0414\u0440\u0443\u0433\u0438\u0439 \u0448\u0430\u0440 \u0433\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D\u0443",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("\u0413\u0456\u0433\u0456\u0454\u043D\u0456\u0447\u043D\u0438\u0439 \u0434\u0443\u0448",this._storage.get("hygienic_shower")?"1":"0"),e.append("\u0422\u0435\u043F\u043B\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430",this._storage.get("heated_flooring")?"1":"0"),e.append("\u041A\u043E\u043D\u0434\u0438\u0446\u0456\u044E\u0432\u0430\u043D\u043D\u044F",this._storage.get("conditioning")?"1":"0"),e.append("\u041C\u0435\u0431\u043B\u0456",this._storage.get("furniture_bool")?"1":"0"),e.append("\u0422\u0435\u0445\u043D\u0456\u043A\u0430",y),e.append("\u0422\u0435\u0440\u043C\u0456\u043D \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u0456\u0442",a.toString()),fetch("https://script.google.com/macros/s/AKfycbzymV7zIns6N9AdE882E44BwQAFZ_wy0JNIahqsoDWx3kqLi-U/exec",{method:"POST",body:e}).catch(d=>console.error(d))})}collectPortugalCalcData(e){return I(this,null,function*(){const s=!!this._storage.get("appliances_bool_total"),i=!!this._storage.get("furniture_bool"),a=this._storage.get("space"),f=!!this._storage.get("bath"),E=!!this._storage.get("shower"),n=this._storage.get("amount_of_rooms"),u=this._storage.get("amount_of_bathrooms"),v=!!this._storage.get("demontage"),y=this._storage.get("windows_installation"),d=!!this._storage.get("finishing_materials"),K=!!this._storage.get("cement_screed"),j=!!this._storage.get("builtin_furiture"),U=this._storage.get("heated_flooring"),V=!!this._storage.get("denoising"),x=!!this._storage.get("entrance_doors"),H=this._storage.get("conditioning"),J=this._storage.get("flooring"),q=this._storage.get("transportation_expenses"),N=this._storage.get("appliances"),O=this._storage.get("summedPrice"),z=this._storage.get("costPerMetre"),M=(a<=40?3:a<=80?4:a<=100?5:a<=130?6:a<=150?7:a<=175?8:9)+(e=="modern"||e=="neoclassic"?1:0),c=new FormData;return c.append("Style",e),c.append("Total cost VAT",p.formatCurrency(O)),c.append("Total cost",p.formatCurrency(O/1.23)),c.append("Cost per metre",p.formatCurrency(z)),c.append("Cost per metre VAT",p.formatCurrency(z*1.23)),c.append("Area",a.toString()),c.append("Number of bedrooms",n.toString()),c.append("Number of bathrooms",u.toString()),c.append("Bath",f?"1":"0"),c.append("Shower",E?"1":"0"),c.append("Distance from Lisbon",q.toString()),c.append("Flooring",J),c.append("Finishing materials",d?"1":"0"),c.append("Dismantling works",v?"1":"0"),c.append("Cement screed",K?"1":"0"),c.append("Entrance doors",x?"1":"0"),c.append("Soundproofing",V?"1":"0"),c.append("Built-in furniture",j?"1":"0"),c.append("Underfloor heating",U.toString()),c.append("Air conditioning",H.toString()),c.append("Window installation",y.toString()),c.append("Decorating",i?"1":"0"),c.append("Appliances",s?N:"0"),c.append("Time to completion",M.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:c}).catch(Y=>console.error(Y))})}collectPortugalSpecificationData(e){return I(this,null,function*(){const s=this._storage.get("style"),i=!!this._storage.get("appliances_bool_total"),a=!!this._storage.get("furniture_bool"),f=this._storage.get("space"),E=!!this._storage.get("bath"),n=!!this._storage.get("shower"),u=this._storage.get("amount_of_rooms"),v=this._storage.get("amount_of_bathrooms"),y=!!this._storage.get("demontage"),d=this._storage.get("windows_installation"),K=!!this._storage.get("finishing_materials"),j=!!this._storage.get("cement_screed"),U=!!this._storage.get("builtin_furiture"),V=this._storage.get("heated_flooring"),x=!!this._storage.get("denoising"),H=!!this._storage.get("entrance_doors"),J=this._storage.get("conditioning"),q=this._storage.get("flooring"),N=this._storage.get("transportation_expenses"),O=this._storage.get("appliances"),z=this._storage.get("summedPrice"),M=this._storage.get("costPerMetre"),c=(f<=40?3:f<=80?4:f<=100?5:f<=130?6:f<=150?7:f<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);return e.append("Style",s),e.append("Total cost VAT",p.formatCurrency(z)),e.append("Total cost",p.formatCurrency(z/1.23)),e.append("Cost per metre",p.formatCurrency(M)),e.append("Cost per metre VAT",p.formatCurrency(M*1.23)),e.append("Area",f.toString()),e.append("Number of bedrooms",u.toString()),e.append("Number of bathrooms",v.toString()),e.append("Bath",E?"1":"0"),e.append("Shower",n?"1":"0"),e.append("Distance from Lisbon",N.toString()),e.append("Flooring",q),e.append("Finishing materials",K?"1":"0"),e.append("Dismantling works",y?"1":"0"),e.append("Cement screed",j?"1":"0"),e.append("Entrance doors",H?"1":"0"),e.append("Soundproofing",x?"1":"0"),e.append("Built-in furniture",U?"1":"0"),e.append("Underfloor heating",V.toString()),e.append("Air conditioning",J.toString()),e.append("Window installation",d.toString()),e.append("Decorating",a?"1":"0"),e.append("Appliances",i?O:"0"),e.append("Time to completion",c.toString()),fetch("https://script.google.com/macros/s/AKfycbzwN8RKdZRUWDBLNnvUwxxK9FXHUVPeqPpGFJYu9NT9zLsc34JKzIHgHz1CwFbNYGzs/exec",{method:"POST",body:e}).catch(Y=>console.error(Y))})}}var ve=(r,e,s)=>new Promise((i,a)=>{var f=u=>{try{n(s.next(u))}catch(v){a(v)}},E=u=>{try{n(s.throw(u))}catch(v){a(v)}},n=u=>u.done?i(u.value):Promise.resolve(u.value).then(f,E);n((s=s.apply(r,e)).next())});$(function(){const r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e=new Dt(he.en,!1),s=new Et(e),i=e.get("style"),a=Pt(i),f=!!e.get("appliances_bool_total"),E=!!e.get("furniture_bool"),n=e.get("space"),u=!!e.get("bath"),v=!!e.get("shower"),y=e.get("amount_of_rooms"),d=e.get("amount_of_bathrooms"),K=!!e.get("demontage"),j=e.get("windows_installation"),U=!!e.get("finishing_materials"),V=!!e.get("cement_screed"),x=!!e.get("builtin_furiture"),H=e.get("heated_flooring"),J=!!e.get("denoising"),q=!!e.get("entrance_doors"),N=e.get("conditioning"),O=e.get("flooring"),z=e.get("transportation_expenses"),M=e.get("appliances"),c=e.get("summedPrice"),Y=e.get("costPerMetre"),St=$("#furnitureList");let o="",g="",S=0,ne=0;const re=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+(i=="modern"||i=="neoclassic"?1:0);$("#months").html(re.toString()),$("#total").html(p.formatCurrency(c)),$("#space").html(n.toString()),$("#pricePerMetre").html(p.formatCurrency(Y)),fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json&gid=1219923480").then(w=>w.text()).then(w=>{var k,R,Z,ce,X,ie,ee,se,oe,$e,ye,we,Fe,be,Ae,ke,Be,De,Ee,Se,Le,Pe,Te,xe,Ne,Me,Ge,Oe,ze,Ie,Ke,je,Ue,Ve,He,Je,qe,Re,We,Qe,Ye,Ze,Xe,et,tt,nt,it,st,ot,at,lt,ut,rt,ct,pt,gt,dt,mt,ht,ft,vt,_t,Ct;const Tt=JSON.parse(w.substring(w.length-2,0).replace(`/*O_o*/
google.visualization.Query.setResponse(`,"")).table.rows,t=new Bt(Tt.map((l,F)=>l.c.map(function(C,A){var h;if(!(C===null||C.v===null))return new me(`${fe.numberToEncodedLetter(A+1)}${F+1}`,(h=C.v)!=null?h:C.f)}).filter(C=>C!=null)).reduce((l,F)=>[...l,...F])),m=t.getCell("S46").numeric(),L=t.getCell("S44").numeric(),pe=t.getCell("S69").numeric(),$t=t.getCell("T103").numeric(),ge=t.getCell("S104").numeric();i=="cozy"?(o="I",g="A"):i=="japandi"?(o="K",g="B"):i=="fusion"?(o="M",g="C"):i=="modern"?(o="O",g="D"):i=="neoclassic"&&(o="Q",g="E");let ae=0,le,te;O=="vynil"?(le="60",te="86",ae=n*(n<70?220.33:161.8)*m*3):O=="parket"?(le="61",te="87",ae=n*(n<80?369.96:240.31)*m*2):(le="59",te="85",ae=n*(n<70?201.26:198.81)*m*2);const ue=$("#workList");let B="";const yt=2523*((y>0?6:0)+(u?2:0)+(v?2:0)+d*2)*m*2*L+(u?1:0)*d*2500*2*L*m-950*m/41+(v?1:0)*4e3*d*2*L*m-800*m/41,wt=1974*((y>0?3:0)+(u?1:0)+(v?1:0)+d*2)*m*2*L,Ft=n*d*(n<=100?83.2:33.98)*L*m*2,bt=(n/y<=50?850*n:y*24*3519)*m*L,xt=[t.getCell("J47").numeric()/L,t.getCell("J48").numeric()/L,n/y<=50?n*(n<=60?1142.78:n<=95?883.87:(n<=125,819.43))*m*1.45:Math.sqrt(n)*4*3*600*m,n*(n<=60?283.08:n<=95?281.22:n<=124?338.33:362.47)*m*1.35*1.45,n*(n<=60?700.67:n<=100?687.36:n<=130?341.25:317.36)*m*1.1*1.5/2,700*3*m,(n/y<50?(n<=50?1e3*n:990*n)*1.77:Math.sqrt(n)*4*3*600)*m,n*(n<=60?418.86:n<=100?416.29:n<=135?416.73:416.67)*1.77*m,140*(n<=60?40:n<=80?50:n<=120?78:n<=180?114:162)*(i=="modern"||i=="neoclassic"?1:0)*1.77*m,ae,n*(n<=70?114.47:86.84)*m*2,n*(n<=70?206.59:170)*m*2*(i=="japandi"||i=="fusion"?1:0)],Nt=[v?d:0,u?d:0,1,1,d,d+y,1,1,1,1,i!=="japandi"&&i!=="fusion"?1:0,i==="japandi"||i==="fusion"?1:0],At=[47,48,50,51,52,53,55,56,57,le,63,64];S+=yt,B=P(t.getCell("F44").value(),"",Math.round(yt)+" \u20AC"),$("#workList").append(B),S+=wt,B=P(t.getCell("F45").value(),"",Math.round(wt)+" \u20AC"),$("#workList").append(B),S+=Ft,B=P(t.getCell("F46").value(),"",Math.round(Ft)+" \u20AC"),$("#workList").append(B),S+=bt,B=P(t.getCell("F49").value(),"",Math.round(bt)+" \u20AC"),$("#workList").append(B);for(let l=0;l<At.length;l++){const F=xt[l]*Nt[l]*L;F===0||isNaN(F)||(S+=F,B=P(t.getCell("F"+At[l]).value(),"",Math.round(F)+" \u20AC"),$("#workList").append(B))}if(U){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F68").value()}</h4><span class='notation amount'> </span><span class='notation'>${D.kCost}</span>`);const l=[t.getCell(`${o}69`).numeric(),t.getCell(`${o}70`).numeric(),t.getCell(`${o}71`).numeric(),t.getCell(`${o}72`).numeric(),t.getCell(`${o}73`).numeric(),t.getCell(`${o}74`).numeric(),t.getCell(`${o}76`).numeric(),t.getCell(`${o}77`).numeric(),t.getCell(`${o}78`).numeric(),t.getCell(`${o}79`).numeric(),t.getCell(`${o}80`).numeric(),t.getCell(`${o}81`).numeric(),t.getCell(`${o}82`).numeric(),t.getCell(`${o+te}`).numeric()];let F=[d+y,d*35,.66*n,.66*n,.59*n,n<=50?42:n<=90?60:n<=120?84:90,d,Number(u),Number(v),Number(u)+Number(v),d,d,d,n<100?n-d*7:n-d*10];const C=[69,70,71,72,73,74,76,77,78,79,80,81,82,te];for(let A=0;A<C.length;A++){const h=l[A]*F[A]*t.getCell("S69").numeric()/1.23;h===0||isNaN(h)||(S+=h,B=P(t.getCell("F"+C[A]).value(),"",Math.round(h)+"\u20AC"),$("#workList").append(B))}}B=`<div class="option-block">
      <div class="division-block pricelist"></div>
      <div class="list-option-container">
        <span class='name'>${t.getCell("F93").value()}</span>
        <span class='list-text amount'>${re} months</span>
        <span class='list-text'> </span>
      </div>
    </div>`,$("#workList").append(B);const Mt=[(41e3*Math.ceil((z+2)/5)/1.35/2/1.5+100*n)*L*m,S*.022*m,(re*2*1200+3e3+n*220)*L*m],kt=[94,95,96];B="";for(let l=0;l<kt.length;l++){const F=Mt[l];S+=F,B+=`<div class="option-block">
        <div class="division-block pricelist"></div>
        <div class="list-option-container">
          <span class='name'>${t.getCell(`F${kt[l]}`).value()}</span>
            <span class='list-text amount'></span>
          <span class='list-text'>${p.formatCurrency(F)} \u20AC</span>
        </div>
      </div>`}if($("#workList").append(B),B="",b(ue,'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),b($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${p.formatCurrency(S)} \u20AC</span>`),E&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${D.kKitchen}</h4>
          <span class='notation amount'>${D.kAmount}</span>
          <span class='notation'>${D.kCost}</span>`),_(t.getCell("F121").value(),(k=t.getCell(`${g}121`))==null?void 0:k.value(),1,t.getCell(`${o}121`).numeric(),t.getCell("G121").value()),_(t.getCell("F122").value(),(R=t.getCell(`${g}122`))==null?void 0:R.value(),4,t.getCell(`${o}122`).numeric(),t.getCell("G122").value()),_(t.getCell("F123").value(),(Z=t.getCell(`${g}123`))==null?void 0:Z.value(),1,t.getCell(`${o}123`).numeric(),t.getCell("G123").value()),b($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),b($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${t.getCell("F124").value()}</h4><span class='notation amount'>${D.kAmount}</span><span class='notation'>${D.kCost}</span>`),_(t.getCell("F124").value(),(ce=t.getCell(g+"124"))==null?void 0:ce.value(),1,(X=t.getCell(`${o}124`))==null?void 0:X.numeric(),(ie=t.getCell("G124"))==null?void 0:ie.value()),_(t.getCell("F125").value(),(ee=t.getCell(g+"125"))==null?void 0:ee.value(),1,(se=t.getCell(`${o}125`))==null?void 0:se.numeric(),(oe=t.getCell("G125"))==null?void 0:oe.value()),b($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),b($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${t.getCell("F127").value()}</h4><span class='notation amount'>${D.kAmount}</span><span class='notation'>${D.kCost}</span>`),_(t.getCell("F128").value(),($e=t.getCell(g+"128"))==null?void 0:$e.value(),1,(ye=t.getCell(`${o}128`))==null?void 0:ye.numeric(),(we=t.getCell("G128"))==null?void 0:we.value()),_(t.getCell("F129").value(),(Fe=t.getCell(g+"129"))==null?void 0:Fe.value(),1,(be=t.getCell(`${o}129`))==null?void 0:be.numeric(),(Ae=t.getCell("G129"))==null?void 0:Ae.value()),_(t.getCell("F130").value(),(ke=t.getCell(g+"130"))==null?void 0:ke.value(),2,(Be=t.getCell(`${o}130`))==null?void 0:Be.numeric(),(De=t.getCell("G130"))==null?void 0:De.value()),_(t.getCell("F131").value(),(Ee=t.getCell(g+"131"))==null?void 0:Ee.value(),1,(Se=t.getCell(`${o}131`))==null?void 0:Se.numeric(),(Le=t.getCell("G131"))==null?void 0:Le.value()),_(t.getCell("F132").value(),(Pe=t.getCell(g+"132"))==null?void 0:Pe.value(),1,(Te=t.getCell(`${o}132`))==null?void 0:Te.numeric(),(xe=t.getCell("G132"))==null?void 0:xe.value()),b($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F133").value()}</h4><span class='notation amount'>${D.kAmount}</span><span class='notation'>${D.kCost}</span>`),_(t.getCell("F134").value(),(Ne=t.getCell(g+"134"))==null?void 0:Ne.value(),Math.ceil(n*.48),(Me=t.getCell(`${o}134`))==null?void 0:Me.numeric(),(Ge=t.getCell("G134"))==null?void 0:Ge.value()),_(t.getCell("F135").value(),(Oe=t.getCell(g+"135"))==null?void 0:Oe.value(),1,(ze=t.getCell(`${o}135`))==null?void 0:ze.numeric(),(Ie=t.getCell("G135"))==null?void 0:Ie.value()),_(t.getCell("F137").value(),(Ke=t.getCell(g+"137"))==null?void 0:Ke.value(),1,(je=t.getCell(`${o}137`))==null?void 0:je.numeric(),(Ue=t.getCell("G137"))==null?void 0:Ue.value()),_(t.getCell("F139").value(),(Ve=t.getCell(g+"139"))==null?void 0:Ve.value(),1,(He=t.getCell(`${o}139`))==null?void 0:He.numeric(),(Je=t.getCell("G139"))==null?void 0:Je.value()),_(t.getCell("F140").value(),(qe=t.getCell(g+"140"))==null?void 0:qe.value(),1,(Re=t.getCell(`${o}140`))==null?void 0:Re.numeric(),(We=t.getCell("G140"))==null?void 0:We.value()),_(t.getCell("F136").value(),(Qe=t.getCell(g+"136"))==null?void 0:Qe.value(),y>1?1:0,(Ye=t.getCell(`${o}136`))==null?void 0:Ye.numeric(),(Ze=t.getCell("G136"))==null?void 0:Ze.value()),_(t.getCell("F138").value(),(Xe=t.getCell(g+"138"))==null?void 0:Xe.value(),2,(et=t.getCell(`${o}138`))==null?void 0:et.numeric(),(tt=t.getCell("G138"))==null?void 0:tt.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F141").value()}</h4>
            <span class='notation amount'>${D.kAmount}</span>
            <span class='notation'>${D.kCost}</span>`),_(t.getCell("F142").value(),(nt=t.getCell(g+"142"))==null?void 0:nt.value(),y,(it=t.getCell(`${o}142`))==null?void 0:it.numeric(),(st=t.getCell("G142"))==null?void 0:st.value()),_(t.getCell("F143").value(),(ot=t.getCell(g+"143"))==null?void 0:ot.value(),y,(at=t.getCell(`${o}143`))==null?void 0:at.numeric(),(lt=t.getCell("G143"))==null?void 0:lt.value()),_(t.getCell("F144").value(),(ut=t.getCell(g+"144"))==null?void 0:ut.value(),y,(rt=t.getCell(`${o}144`))==null?void 0:rt.numeric(),(ct=t.getCell("G144"))==null?void 0:ct.value()),_(t.getCell("F145").value(),(pt=t.getCell(g+"145"))==null?void 0:pt.value(),1,(gt=t.getCell(`${o}145`))==null?void 0:gt.numeric(),(dt=t.getCell("G145"))==null?void 0:dt.value()),_(t.getCell("F146").value(),(mt=t.getCell(g+"146"))==null?void 0:mt.value(),y-1,(ht=t.getCell(`${o}146`))==null?void 0:ht.numeric(),(ft=t.getCell("G146"))==null?void 0:ft.value()),b($("#furnitureList"),P(t.getCell("F147").value()," ",Math.round(ne*.3)+"\u20AC")),ne*=1.3,b($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),b($("#furnitureList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for furniture:</span><span class='list-text summary work'>${p.formatCurrency(ne)} \u20AC</span>`)),x||V||U||j||K||H>0||J||q||N){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F102").value()}</h4><span class='notation amount'></span><span class='notation'>${D.kCost}</span>`);let l=0;const F=[t.getCell(`${o}103`).numeric()*n,t.getCell(`${o}104`).numeric(),(n<=60?440:410)*m*2*n*L/ge,t.getCell(`${o}106`).numeric(),((n<=60?90.02:n<=95?60.78:n<125?58.29:n>=125?79.01:0)+(n<=60?60.91:n<=95?64.57:n<125?63.87:n>=125?66.24:0))*n*$t,t.getCell(`${o}108`).numeric()/1.23,t.getCell(`${o}109`).numeric()*pe/ge,t.getCell(`${o}110`).numeric()*pe/ge,t.getCell(`${o}112`).numeric()*n],C=[K?1:0,j,V?1:0,H,J?1:0,q?1:0,x?1:0,x?1:0,N],A=[103,104,105,106,107,108,109,110,112];for(let h=0;h<A.length;h++){const Q=F[h]*C[h]*t.getCell("S104").numeric();Q===0||C[h]==0||(l+=Q,b(ue,P((vt=t.getCell("F"+A[h]))==null?void 0:vt.value(),"",p.formatCurrency(Q)+" \u20AC")))}if(N>0){const h=N*t.getCell(`${o}113`).numeric()*(1+t.getCell("S113").numeric()/100)/t.getCell("E5").numeric(),Q=h*.05*$t;b(ue,P((_t=t.getCell("F113"))==null?void 0:_t.value(),"",p.formatCurrency(h)+" \u20AC")),b(ue,P((Ct=t.getCell("F114"))==null?void 0:Ct.value(),"",p.formatCurrency(Q)+" \u20AC")),l+=Q+h}b($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),b($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for options:</span><span class='list-text summary work'>${p.formatCurrency(l)} \u20AC</span>`),S+=l}f||$(".comfy-section").toggle(!1),E||$("#furnitureList").toggle(!1);function _(l,F,C,A,h){if(!(!E||C==0||!C||!A)){if(ne+=A*C,b(St,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),F===null){b($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${l}</span><span class='list-text'>${C} ${h}</span>`);return}b($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${l}, ${F}</span><span class='list-text amount'>${C} ${h}</span><span class='list-text'>${p.formatCurrency(A*C)} \u20AC</span>`)}}b($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),b($("#materialsList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${p.formatCurrency(S)} \u20AC</span>`);let W=0;const de=document.getElementById("appliancesListTotal"),T=[];if(M==="gorenje"?T.push(154,9):M==="bosch"?T.push(169,10):M==="smeg"?T.push(185,9):T.push(154,9),f){let l="";for(let A=0;A<T[1];A++){const h=t.getCell("D"+(T[0]+A)).numeric()*.9;l+=`<div class="option-block">
          <div class="division-block pricelist"></div>
          <div class="list-option-container"><span class='name'>${t.getCell("F"+(T[0]+A)).value()} ${t.getCell("E"+(T[0]+A)).value()}</span>
            <span class='list-text amount'>1 piece</span>
            <span class='list-text'>${p.formatCurrency(h)}\u20AC</span>
            </div>
            </div>`,W+=h}const F=t.getCell("G35").numeric(),C=t.getCell("E5").numeric();W+=T[1]*F/C,l+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>Appliances delivery</span><span class='list-text amount'></span><span class='list-text'>${p.formatCurrency(T[1]*F/C)} \u20AC</span></div></div>`,l+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${t.getCell("F165").value()}</span><span class='list-text amount'></span><span class='list-text'>${p.formatCurrency(W*.2)} \u20AC</span></div></div>`,W*=1.2,l+=`<div class="division-block pricelist"></div><div class="list-option-container summary"><span class='pricelist-header small no-padding'>Total for appliances:</span><span class='list-text summary work'>${p.formatCurrency(W)} \u20AC</span></div>`,de.innerHTML=de.innerHTML+l}else de.style.display="none";if(x){const l=t.getCell(`${o}109`).numeric();$("#kitchenPrice").html(p.formatCurrency(l*pe)+" \u20AC")}else $("#kitchenSection").toggle(!1);S+=W,$("#totalPriceTotal").html(p.formatCurrency(S)+" \u20AC *"),$("#totalVAT").html(p.formatCurrency(S*1.23)+" \u20AC *"),$("#total").html(p.formatCurrency(S*1.23))}),$("#wf-form-consult").on("submit",function(w){if(w.preventDefault(),$("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox:not(.specification)").toggle(!1):$(".warning.agreementcheckbox:not(.specification)").toggle(!0),$("#phone").val()?$(".warning.phone:not(.specification)").toggle(!1):$(".warning.phone:not(.specification)").toggle(!0),$("#name").val()?$(".warning.name:not(.specification)").toggle(!1):$(".warning.name:not(.specification)").toggle(!0),$(".warning:not(.specification)").is(":visible"))return w.preventDefault(),!1;s.collectPortugalClientData(new FormData(document.getElementById("wf-form-consult")))});const _e=document.getElementById("sName"),Ce=document.getElementById("sEmail");$("#wf-form-specification").on("submit",function(w){return ve(this,null,function*(){w.preventDefault();const k=Ce.value;if($("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox.specification").toggle(!1):$(".warning.agreementcheckbox.specification").toggle(!0),_e.value.length<2?$(".warning.name.specification").toggle(!0):$(".warning.name.specification").toggle(!1),k.length==0?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!0)):r.test(k)?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!1)):($(".warning.wrongEmail.specification").toggle(!0),$(".warning.emptyEmail.specification").toggle(!1)),!$(".warning.specification").is(":visible"))s.collectPortugalSpecificationData(new FormData(document.getElementById("wf-form-specification"))),Lt().finally(()=>{window.location.assign("/sdyakuiemo")});else return w.stopImmediatePropagation(),!1})});function Lt(){return ve(this,null,function*(){$(".modal-note.specification").html("Please wait...");const k='<!DOCTYPE html><html lang="en_US">'+$("html").clone().find("script").remove().end().html()+"</html>",R=new File([k],"source.html",{type:"text/html"}),Z=new FormData;Z.append("file",R,"source.html");const X=yield(yield fetch("https://api.fortes.agency/convert",{method:"POST",body:Z})).json(),ie=X.success?X.id:"";$(".modal-note.specification").html("We sent your estimation to your email address. If you don't see it, check Spam folder or wait a few minutes.");const ee=_e.value,se=Ce.value,oe=new Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}).format(new Date).replace(/\//g,"-");return fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:ie,fileName:`${ee} ${oe}`,recipientMail:se,lang:"eng",name:ee}),headers:{"Content-Type":"application/json"}})})}document.querySelector('input[name="Phone-Number"]').name="Phone Number",$("img").each(function(){$(this).attr("loading","eager")});function Pt(w){let k="J";return w=="cozy"?k="J":w=="japandi"?k="L":w=="fusion"?k="N":w=="modern"?k="P":w=="neoclassic"&&(k="R"),k}function P(w,k,R){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${w}</span><span class='list-text amount'>${k}</span><span class='list-text'>${R}</span></div></div>`}function b(w,k){w.append(k)}})})();
