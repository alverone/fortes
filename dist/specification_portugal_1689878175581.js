(()=>{"use strict";var Ut={};class p{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class me{constructor(e,s){this.address=e,this._value=s}hasValue(){return this._value!==null&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return p.formatCurrency(parseFloat(this.value()))}}class Dt{constructor(e){this.cells=e}getCell(e){const s=this.cells.filter(o=>o.address===e);return s.length==0?new me(e,"0"):s[0]}}var he=(r=>(r[r.uk=0]="uk",r[r.en=1]="en",r))(he||{});class St{constructor(e,s=!1){if(s)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(s){return localStorage.getItem(e)}}set(e,s){localStorage.setItem(e,s.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const s={};for(const o in e)if(!(o==="length"||o=="costPerMetre"||o=="color")){if(String(e[o])==="true"){s[o]=1;continue}else if(String(e[o])==="false"){s[o]=0;continue}if(isFinite(Number(e[o]))){s[o]=Number(e[o]);continue}s[o]=e[o]}return JSON.stringify(s)}}class fe{static numberToEncodedLetter(e){if(isNaN(e))return;e=Math.abs(Math.floor(e));let s=e%26,o=e/26,a;return e<=26?this.numToLetter(e):(o>=1&&(s===0&&o--,a=this.numberToEncodedLetter(o)),s===0&&(s=26),a+this.numToLetter(s))}static numToLetter(e){if(!(e>26||e<0))return e===0?"":this.alphabet.slice(e-1,e)}}fe.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class E{}E.kCost="Cost",E.kAmount="Amount",E.kKitchen="Kitchen",E.kLMonth="month";var G=(r=>(r.Cozy="cozy",r.Japandi="japandi",r.Modern="modern",r.Fusion="fusion",r.NeoClassic="neoclassic",r))(G||{});(r=>{function e(a){return a==="japandi"?"japandi":a==="neoclassic"?"neoclassic":a==="modern"?"modern":a==="fusion"?"fusion":"cozy"}r.fromString=e;function s(a){return a===0?"cozy":a===1?"japandi":a===2?"fusion":a===3?"modern":"neoclassic"}r.fromNumber=s;function o(a){switch(a){case"neoclassic":return"\u041D\u0435\u043E \u041A\u043B\u0430\u0441\u0438\u043A\u0430";case"japandi":return"\u0414\u0436\u0430\u043F\u0430\u043D\u0434\u0456";case"fusion":return"\u0424\u044C\u044E\u0436\u043D";case"modern":return"\u041C\u043E\u0434\u0435\u0440\u043D";case"cozy":default:return"\u041A\u043E\u0437\u0456"}}r.inUkrainian=o})(G||(G={}));var z=(r,e,s)=>new Promise((o,a)=>{var _=u=>{try{n(s.next(u))}catch(C){a(C)}},D=u=>{try{n(s.throw(u))}catch(C){a(C)}},n=u=>u.done?o(u.value):Promise.resolve(u.value).then(_,D);n((s=s.apply(r,e)).next())});class Lt{constructor(e){this._storage=e}collectPortugalClientData(e){return z(this,null,function*(){return fetch("https://script.google.com/macros/s/AKfycbzyzzY4bi4yQoHdsTeVmm8BxGQ-bGW_-rK_erhrFA0zKak6rQ27p-k9Mx3HWk6vKEIatw/exec",{method:"POST",body:e}).catch(s=>console.error("Failed to collect consultation data!",s.message))})}collectClientData(e){return z(this,null,function*(){return fetch("https://script.google.com/macros/s/AKfycbyTfAJSAOSn1mB5Ua10w0AHAdKLb1weCd3ve139FkPzbqLEPnBeiE8gGGTq5S6XhmevIQ/exec",{method:"POST",body:e}).catch(s=>console.error("Failed to collect consultation data!",s.message))})}collectCalcData(){return z(this,null,function*(){const e=new FormData,s=G.fromString(this._storage.get("style")),o=this._storage.get("space"),a=(o<=40?3:o<=80?4:o<=100?5:o<=130?6:o<=150?7:o<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);e.append("\u0421\u0442\u0438\u043B\u044C",G.inUkrainian(s)),e.append("\u0426\u0456\u043D\u0430 \u0437\u0430 \u043C\u0435\u0442\u0440",this._storage.get("costPerMetre")),e.append("\u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430",this._storage.get("summedPrice")),e.append("\u041F\u043B\u043E\u0449\u0430",o),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u043A\u0456\u043C\u043D\u0430\u0442",this._storage.get("amount_of_rooms")),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0430\u043D\u0432\u0443\u0437\u043B\u0456\u0432",this._storage.get("amount_of_bathrooms")),e.append("\u0412\u0430\u043D\u043D\u0430",this._storage.get("bath")?"1":"0"),e.append("\u0414\u0443\u0448",this._storage.get("shower")?"1":"0");const _=this._storage.get("ceiling"),D=this._storage.get("flooring"),n=this._storage.get("appliances_bool_total"),u=_=="stretch ceiling"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":_=="gapless"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u0431\u0435\u0441\u0449\u0435\u043B\u0435\u0432\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":"\u0413\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D",C=D=="laminat"?"\u041B\u0430\u043C\u0456\u043D\u0430\u0442":D=="vynil"?"\u0412\u0456\u043D\u0456\u043B\u043E\u0432\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430":"\u041F\u0430\u0440\u043A\u0435\u0442",F=n?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"\u041D\u0435 \u043E\u0431\u0440\u0430\u043D\u043E";return e.append("\u0421\u0442\u0435\u043B\u044F",u),e.append("\u041F\u0456\u0434\u043B\u043E\u0433\u043E\u0432\u0435 \u043F\u043E\u043A\u0440\u0438\u0442\u0442\u044F",C),e.append("\u0421\u0442\u044F\u0436\u043A\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0438",this._storage.get("floor_screed")?"1":"0"),e.append("\u0428\u0443\u043C\u043E\u0456\u0437\u043E\u043B\u044F\u0446\u0456\u044F",this._storage.get("denoising")?"1":"0"),e.append("\u0412\u0445\u0456\u0434\u043D\u0456 \u0434\u0432\u0435\u0440\u0456",this._storage.get("entrance_doors")?"1":"0"),e.append("\u0414\u0440\u0443\u0433\u0438\u0439 \u0448\u0430\u0440 \u0433\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D\u0443",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("\u0413\u0456\u0433\u0456\u0454\u043D\u0456\u0447\u043D\u0438\u0439 \u0434\u0443\u0448",this._storage.get("hygienic_shower")?"1":"0"),e.append("\u0422\u0435\u043F\u043B\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430",this._storage.get("heated_flooring")?"1":"0"),e.append("\u041A\u043E\u043D\u0434\u0438\u0446\u0456\u044E\u0432\u0430\u043D\u043D\u044F",this._storage.get("conditioning")?"1":"0"),e.append("\u041C\u0435\u0431\u043B\u0456",this._storage.get("furniture_bool")?"1":"0"),e.append("\u0422\u0435\u0445\u043D\u0456\u043A\u0430",F),e.append("\u0422\u0435\u0440\u043C\u0456\u043D \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u0456\u0442",a.toString()),fetch("https://script.google.com/macros/s/AKfycbyt7QOcA0Dp_2voHy2w1rVGCllwvW_SX_V8iDTD5E7zJohqH0C4/exec",{method:"POST",body:e}).catch(d=>console.error(d))})}collectSpecificationData(e){return z(this,null,function*(){const s=G.fromString(this._storage.get("style")),o=this._storage.get("space"),a=(o<=40?3:o<=80?4:o<=100?5:o<=130?6:o<=150?7:o<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);e.append("\u0421\u0442\u0438\u043B\u044C",G.inUkrainian(s)),e.append("\u0426\u0456\u043D\u0430 \u0437\u0430 \u043C\u0435\u0442\u0440",this._storage.get("costPerMetre")),e.append("\u0417\u0430\u0433\u0430\u043B\u044C\u043D\u0430 \u0446\u0456\u043D\u0430",this._storage.get("summedPrice")),e.append("\u041F\u043B\u043E\u0449\u0430",o),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u043A\u0456\u043C\u043D\u0430\u0442",this._storage.get("amount_of_rooms")),e.append("\u041A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0430\u043D\u0432\u0443\u0437\u043B\u0456\u0432",this._storage.get("amount_of_bathrooms")),e.append("\u0412\u0430\u043D\u043D\u0430",this._storage.get("bath")?"1":"0"),e.append("\u0414\u0443\u0448",this._storage.get("shower")?"1":"0");const _=this._storage.get("ceiling"),D=this._storage.get("flooring"),n=this._storage.get("appliances_bool_total"),u=_=="stretch ceiling"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":_=="gapless"?"\u041D\u0430\u0442\u044F\u0436\u043D\u0430 \u0431\u0435\u0441\u0449\u0435\u043B\u0435\u0432\u0430 \u043C\u0430\u0442\u043E\u0432\u0430":"\u0413\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D",C=D=="laminat"?"\u041B\u0430\u043C\u0456\u043D\u0430\u0442":D=="vynil"?"\u0412\u0456\u043D\u0456\u043B\u043E\u0432\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430":"\u041F\u0430\u0440\u043A\u0435\u0442",F=n?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"\u041D\u0435 \u043E\u0431\u0440\u0430\u043D\u043E";return e.append("\u0421\u0442\u0435\u043B\u044F",u),e.append("\u041F\u0456\u0434\u043B\u043E\u0433\u043E\u0432\u0435 \u043F\u043E\u043A\u0440\u0438\u0442\u0442\u044F",C),e.append("\u0421\u0442\u044F\u0436\u043A\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0438",this._storage.get("floor_screed")?"1":"0"),e.append("\u0428\u0443\u043C\u043E\u0456\u0437\u043E\u043B\u044F\u0446\u0456\u044F",this._storage.get("denoising")?"1":"0"),e.append("\u0412\u0445\u0456\u0434\u043D\u0456 \u0434\u0432\u0435\u0440\u0456",this._storage.get("entrance_doors")?"1":"0"),e.append("\u0414\u0440\u0443\u0433\u0438\u0439 \u0448\u0430\u0440 \u0433\u0456\u043F\u0441\u043E\u043A\u0430\u0440\u0442\u043E\u043D\u0443",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("\u0413\u0456\u0433\u0456\u0454\u043D\u0456\u0447\u043D\u0438\u0439 \u0434\u0443\u0448",this._storage.get("hygienic_shower")?"1":"0"),e.append("\u0422\u0435\u043F\u043B\u0430 \u043F\u0456\u0434\u043B\u043E\u0433\u0430",this._storage.get("heated_flooring")?"1":"0"),e.append("\u041A\u043E\u043D\u0434\u0438\u0446\u0456\u044E\u0432\u0430\u043D\u043D\u044F",this._storage.get("conditioning")?"1":"0"),e.append("\u041C\u0435\u0431\u043B\u0456",this._storage.get("furniture_bool")?"1":"0"),e.append("\u0422\u0435\u0445\u043D\u0456\u043A\u0430",F),e.append("\u0422\u0435\u0440\u043C\u0456\u043D \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0440\u043E\u0431\u0456\u0442",a.toString()),fetch("https://script.google.com/macros/s/AKfycbzymV7zIns6N9AdE882E44BwQAFZ_wy0JNIahqsoDWx3kqLi-U/exec",{method:"POST",body:e}).catch(d=>console.error(d))})}collectPortugalCalcData(e){return z(this,null,function*(){const s=!!this._storage.get("appliances_bool_total"),o=!!this._storage.get("furniture_bool"),a=this._storage.get("space"),_=!!this._storage.get("bath"),D=!!this._storage.get("shower"),n=this._storage.get("amount_of_rooms"),u=this._storage.get("amount_of_bathrooms"),C=!!this._storage.get("demontage"),F=this._storage.get("windows_installation"),d=!!this._storage.get("finishing_materials"),K=!!this._storage.get("cement_screed"),j=!!this._storage.get("builtin_furiture"),U=this._storage.get("heated_flooring"),V=!!this._storage.get("denoising"),x=!!this._storage.get("entrance_doors"),H=this._storage.get("conditioning"),J=this._storage.get("flooring"),q=this._storage.get("transportation_expenses"),N=this._storage.get("appliances"),O=this._storage.get("summedPrice"),I=this._storage.get("costPerMetre"),M=(a<=40?3:a<=80?4:a<=100?5:a<=130?6:a<=150?7:a<=175?8:9)+(e=="modern"||e=="neoclassic"?1:0),c=new FormData;return c.append("Style",e),c.append("Total cost VAT",p.formatCurrency(O)),c.append("Total cost",p.formatCurrency(O/1.23)),c.append("Cost per metre",p.formatCurrency(I)),c.append("Cost per metre VAT",p.formatCurrency(I*1.23)),c.append("Area",a.toString()),c.append("Number of bedrooms",n.toString()),c.append("Number of bathrooms",u.toString()),c.append("Bath",_?"1":"0"),c.append("Shower",D?"1":"0"),c.append("Distance from Lisbon",q.toString()),c.append("Flooring",J),c.append("Finishing materials",d?"1":"0"),c.append("Dismantling works",C?"1":"0"),c.append("Cement screed",K?"1":"0"),c.append("Entrance doors",x?"1":"0"),c.append("Soundproofing",V?"1":"0"),c.append("Built-in furniture",j?"1":"0"),c.append("Underfloor heating",U.toString()),c.append("Air conditioning",H.toString()),c.append("Window installation",F.toString()),c.append("Decorating",o?"1":"0"),c.append("Appliances",s?N:"0"),c.append("Time to completion",M.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:c}).catch(Y=>console.error(Y))})}collectPortugalSpecificationData(e){return z(this,null,function*(){const s=this._storage.get("style"),o=!!this._storage.get("appliances_bool_total"),a=!!this._storage.get("furniture_bool"),_=this._storage.get("space"),D=!!this._storage.get("bath"),n=!!this._storage.get("shower"),u=this._storage.get("amount_of_rooms"),C=this._storage.get("amount_of_bathrooms"),F=!!this._storage.get("demontage"),d=this._storage.get("windows_installation"),K=!!this._storage.get("finishing_materials"),j=!!this._storage.get("cement_screed"),U=!!this._storage.get("builtin_furiture"),V=this._storage.get("heated_flooring"),x=!!this._storage.get("denoising"),H=!!this._storage.get("entrance_doors"),J=this._storage.get("conditioning"),q=this._storage.get("flooring"),N=this._storage.get("transportation_expenses"),O=this._storage.get("appliances"),I=this._storage.get("summedPrice"),M=this._storage.get("costPerMetre"),c=(_<=40?3:_<=80?4:_<=100?5:_<=130?6:_<=150?7:_<=175?8:9)+(s=="modern"||s=="neoclassic"?1:0);return e.append("Style",s),e.append("Total cost VAT",p.formatCurrency(I)),e.append("Total cost",p.formatCurrency(I/1.23)),e.append("Cost per metre",p.formatCurrency(M)),e.append("Cost per metre VAT",p.formatCurrency(M*1.23)),e.append("Area",_.toString()),e.append("Number of bedrooms",u.toString()),e.append("Number of bathrooms",C.toString()),e.append("Bath",D?"1":"0"),e.append("Shower",n?"1":"0"),e.append("Distance from Lisbon",N.toString()),e.append("Flooring",q),e.append("Finishing materials",K?"1":"0"),e.append("Dismantling works",F?"1":"0"),e.append("Cement screed",j?"1":"0"),e.append("Entrance doors",H?"1":"0"),e.append("Soundproofing",x?"1":"0"),e.append("Built-in furniture",U?"1":"0"),e.append("Underfloor heating",V.toString()),e.append("Air conditioning",J.toString()),e.append("Window installation",d.toString()),e.append("Decorating",a?"1":"0"),e.append("Appliances",o?O:"0"),e.append("Time to completion",c.toString()),fetch("https://script.google.com/macros/s/AKfycbzwN8RKdZRUWDBLNnvUwxxK9FXHUVPeqPpGFJYu9NT9zLsc34JKzIHgHz1CwFbNYGzs/exec",{method:"POST",body:e}).catch(Y=>console.error(Y))})}}var ve=(r,e,s)=>new Promise((o,a)=>{var _=u=>{try{n(s.next(u))}catch(C){a(C)}},D=u=>{try{n(s.throw(u))}catch(C){a(C)}},n=u=>u.done?o(u.value):Promise.resolve(u.value).then(_,D);n((s=s.apply(r,e)).next())});$(function(){const r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e=new St(he.en,!1),s=new Lt(e),o=e.get("style"),a=Ot(o),_=!!e.get("appliances_bool_total"),D=!!e.get("furniture_bool"),n=e.get("space"),u=!!e.get("bath"),C=!!e.get("shower"),F=e.get("amount_of_rooms"),d=e.get("amount_of_bathrooms"),K=!!e.get("demontage"),j=e.get("windows_installation"),U=!!e.get("finishing_materials"),V=!!e.get("cement_screed"),x=!!e.get("builtin_furiture"),H=e.get("heated_flooring"),J=!!e.get("denoising"),q=!!e.get("entrance_doors"),N=e.get("conditioning"),O=e.get("flooring"),I=e.get("transportation_expenses"),M=e.get("appliances"),c=e.get("summedPrice"),Y=e.get("costPerMetre"),Pt=$("#furnitureList");let i="",g="",S=0,ne=0;const re=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+(o=="modern"||o=="neoclassic"?1:0);$("#months").html(re.toString()),$("#total").html(p.formatCurrency(c)),$("#space").html(n.toString()),$("#pricePerMetre").html(p.formatCurrency(Y)),fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json&gid=1219923480").then(m=>m.text()).then(m=>{var f,R,Z,ce,X,oe,ee,se,ie,ye,Fe,be,Ae,ke,Be,Ee,De,Se,Le,Pe,Te,xe,Ne,Me,Ge,Oe,Ie,ze,Ke,je,Ue,Ve,He,Je,qe,Re,We,Qe,Ye,Ze,Xe,et,tt,nt,ot,st,it,at,lt,ut,rt,ct,pt,gt,dt,mt,ht,ft,vt,_t,Ct,$t,wt;const It=JSON.parse(m.substring(m.length-2,0).replace(`/*O_o*/
google.visualization.Query.setResponse(`,"")).table.rows,t=new Dt(It.map((l,b)=>l.c.map(function(y,k){var v;if(!(y===null||y.v===null))return new me(`${fe.numberToEncodedLetter(k+1)}${b+1}`,(v=y.v)!=null?v:y.f)}).filter(y=>y!=null)).reduce((l,b)=>[...l,...b])),h=t.getCell("S46").numeric(),L=t.getCell("S44").numeric(),pe=t.getCell("S69").numeric(),yt=t.getCell("T103").numeric(),ge=t.getCell("S104").numeric();o=="cozy"?(i="I",g="A"):o=="japandi"?(i="K",g="B"):o=="fusion"?(i="M",g="C"):o=="modern"?(i="O",g="D"):o=="neoclassic"&&(i="Q",g="E");let ae=0,le,te;O=="vynil"?(le="60",te="86",ae=n*(n<70?220.33:161.8)*h*3):O=="parket"?(le="61",te="87",ae=n*(n<80?369.96:240.31)*h*2):(le="59",te="85",ae=n*(n<70?201.26:198.81)*h*2);const ue=$("#workList");let B="";const Ft=2523*((F>0?6:0)+(u?2:0)+(C?2:0)+d*2)*h*2*L+(u?1:0)*d*2500*2*L*h-950*h/41+(C?1:0)*4e3*d*2*L*h-800*h/41,bt=1974*((F>0?3:0)+(u?1:0)+(C?1:0)+d*2)*h*2*L,At=n*d*(n<=100?83.2:33.98)*L*h*2,kt=(n/F<=50?850*n:F*24*3519)*h*L,zt=[t.getCell("J47").numeric()/L,t.getCell("J48").numeric()/L,n/F<=50?n*(n<=60?1142.78:n<=95?883.87:(n<=125,819.43))*h*1.45:Math.sqrt(n)*4*3*600*h,n*(n<=60?283.08:n<=95?281.22:n<=124?338.33:362.47)*h*1.35*1.45,n*(n<=60?700.67:n<=100?687.36:n<=130?341.25:317.36)*h*1.1*1.5/2,700*3*h,(n/F<50?(n<=50?1e3*n:990*n)*1.77:Math.sqrt(n)*4*3*600)*h,n*(n<=60?418.86:n<=100?416.29:n<=135?416.73:416.67)*1.77*h,140*(n<=60?40:n<=80?50:n<=120?78:n<=180?114:162)*(o=="modern"||o=="neoclassic"?1:0)*1.77*h,ae,n*(n<=70?114.47:86.84)*h*2,n*(n<=70?206.59:170)*h*2*(o=="japandi"||o=="fusion"?1:0)],Kt=[C?d:0,u?d:0,1,1,d,d+F,1,1,1,1,o!=="japandi"&&o!=="fusion"?1:0,o==="japandi"||o==="fusion"?1:0],Bt=[47,48,50,51,52,53,55,56,57,le,63,64];S+=Ft,B=P(t.getCell("F44").value(),"",Math.round(Ft)+" \u20AC"),$("#workList").append(B),S+=bt,B=P(t.getCell("F45").value(),"",Math.round(bt)+" \u20AC"),$("#workList").append(B),S+=At,B=P(t.getCell("F46").value(),"",Math.round(At)+" \u20AC"),$("#workList").append(B),S+=kt,B=P(t.getCell("F49").value(),"",Math.round(kt)+" \u20AC"),$("#workList").append(B);for(let l=0;l<Bt.length;l++){const b=zt[l]*Kt[l]*L;b===0||isNaN(b)||(S+=b,B=P(t.getCell("F"+Bt[l]).value(),"",Math.round(b)+" \u20AC"),$("#workList").append(B))}if(U){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F68").value()}</h4><span class='notation amount'> </span><span class='notation'>${E.kCost}</span>`);const l=[t.getCell(`${i}69`).numeric(),t.getCell(`${i}70`).numeric(),t.getCell(`${i}71`).numeric(),t.getCell(`${i}72`).numeric(),t.getCell(`${i}73`).numeric(),t.getCell(`${i}74`).numeric(),t.getCell(`${i}76`).numeric(),t.getCell(`${i}77`).numeric(),t.getCell(`${i}78`).numeric(),t.getCell(`${i}79`).numeric(),t.getCell(`${i}80`).numeric(),t.getCell(`${i}81`).numeric(),t.getCell(`${i}82`).numeric(),t.getCell(`${i+te}`).numeric()];let b=[d+F,d*35,.66*n,.66*n,.59*n,n<=50?42:n<=90?60:n<=120?84:90,d,Number(u),Number(C),Number(u)+Number(C),d,d,d,n<100?n-d*7:n-d*10];const y=[69,70,71,72,73,74,76,77,78,79,80,81,82,te];for(let k=0;k<y.length;k++){const v=l[k]*b[k]*t.getCell("S69").numeric()/1.23;v===0||isNaN(v)||(S+=v,B=P(t.getCell("F"+y[k]).value(),"",Math.round(v)+"\u20AC"),$("#workList").append(B))}}B=`<div class="option-block">
      <div class="division-block pricelist"></div>
      <div class="list-option-container">
        <span class='name'>${t.getCell("F93").value()}</span>
        <span class='list-text amount'>${re} months</span>
        <span class='list-text'> </span>
      </div>
    </div>`,$("#workList").append(B);const jt=[(41e3*Math.ceil((I+2)/5)/1.35/2/1.5+100*n)*L*h,S*.022*h,(re*2*1200+3e3+n*220)*L*h],Et=[94,95,96];B="";for(let l=0;l<Et.length;l++){const b=jt[l];S+=b,B+=`<div class="option-block">
        <div class="division-block pricelist"></div>
        <div class="list-option-container">
          <span class='name'>${t.getCell(`F${Et[l]}`).value()}</span>
            <span class='list-text amount'></span>
          <span class='list-text'>${p.formatCurrency(b)} \u20AC</span>
        </div>
      </div>`}if($("#workList").append(B),B="",A(ue,'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),A($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${p.formatCurrency(S)} \u20AC</span>`),D&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${E.kKitchen}</h4>
          <span class='notation amount'>${E.kAmount}</span>
          <span class='notation'>${E.kCost}</span>`),w(t.getCell("F121").value(),(f=t.getCell(`${g}121`))==null?void 0:f.value(),1,t.getCell(`${i}121`).numeric(),t.getCell("G121").value()),w(t.getCell("F122").value(),(R=t.getCell(`${g}122`))==null?void 0:R.value(),4,t.getCell(`${i}122`).numeric(),t.getCell("G122").value()),w(t.getCell("F123").value(),(Z=t.getCell(`${g}123`))==null?void 0:Z.value(),1,t.getCell(`${i}123`).numeric(),t.getCell("G123").value()),A($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),A($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${t.getCell("F124").value()}</h4><span class='notation amount'>${E.kAmount}</span><span class='notation'>${E.kCost}</span>`),w(t.getCell("F124").value(),(ce=t.getCell(g+"124"))==null?void 0:ce.value(),1,(X=t.getCell(`${i}124`))==null?void 0:X.numeric(),(oe=t.getCell("G124"))==null?void 0:oe.value()),w(t.getCell("F125").value(),(ee=t.getCell(g+"125"))==null?void 0:ee.value(),1,(se=t.getCell(`${i}125`))==null?void 0:se.numeric(),(ie=t.getCell("G125"))==null?void 0:ie.value()),A($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),A($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${t.getCell("F127").value()}</h4><span class='notation amount'>${E.kAmount}</span><span class='notation'>${E.kCost}</span>`),w(t.getCell("F128").value(),(ye=t.getCell(g+"128"))==null?void 0:ye.value(),1,(Fe=t.getCell(`${i}128`))==null?void 0:Fe.numeric(),(be=t.getCell("G128"))==null?void 0:be.value()),w(t.getCell("F129").value(),(Ae=t.getCell(g+"129"))==null?void 0:Ae.value(),1,(ke=t.getCell(`${i}129`))==null?void 0:ke.numeric(),(Be=t.getCell("G129"))==null?void 0:Be.value()),w(t.getCell("F130").value(),(Ee=t.getCell(g+"130"))==null?void 0:Ee.value(),2,(De=t.getCell(`${i}130`))==null?void 0:De.numeric(),(Se=t.getCell("G130"))==null?void 0:Se.value()),w(t.getCell("F131").value(),(Le=t.getCell(g+"131"))==null?void 0:Le.value(),1,(Pe=t.getCell(`${i}131`))==null?void 0:Pe.numeric(),(Te=t.getCell("G131"))==null?void 0:Te.value()),w(t.getCell("F132").value(),(xe=t.getCell(g+"132"))==null?void 0:xe.value(),1,(Ne=t.getCell(`${i}132`))==null?void 0:Ne.numeric(),(Me=t.getCell("G132"))==null?void 0:Me.value()),A($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F133").value()}</h4><span class='notation amount'>${E.kAmount}</span><span class='notation'>${E.kCost}</span>`),w(t.getCell("F134").value(),(Ge=t.getCell(g+"134"))==null?void 0:Ge.value(),Math.ceil(n*.48),(Oe=t.getCell(`${i}134`))==null?void 0:Oe.numeric(),(Ie=t.getCell("G134"))==null?void 0:Ie.value()),w(t.getCell("F135").value(),(ze=t.getCell(g+"135"))==null?void 0:ze.value(),1,(Ke=t.getCell(`${i}135`))==null?void 0:Ke.numeric(),(je=t.getCell("G135"))==null?void 0:je.value()),w(t.getCell("F137").value(),(Ue=t.getCell(g+"137"))==null?void 0:Ue.value(),1,(Ve=t.getCell(`${i}137`))==null?void 0:Ve.numeric(),(He=t.getCell("G137"))==null?void 0:He.value()),w(t.getCell("F139").value(),(Je=t.getCell(g+"139"))==null?void 0:Je.value(),1,(qe=t.getCell(`${i}139`))==null?void 0:qe.numeric(),(Re=t.getCell("G139"))==null?void 0:Re.value()),w(t.getCell("F140").value(),(We=t.getCell(g+"140"))==null?void 0:We.value(),1,(Qe=t.getCell(`${i}140`))==null?void 0:Qe.numeric(),(Ye=t.getCell("G140"))==null?void 0:Ye.value()),w(t.getCell("F136").value(),(Ze=t.getCell(g+"136"))==null?void 0:Ze.value(),F>1?1:0,(Xe=t.getCell(`${i}136`))==null?void 0:Xe.numeric(),(et=t.getCell("G136"))==null?void 0:et.value()),w(t.getCell("F138").value(),(tt=t.getCell(g+"138"))==null?void 0:tt.value(),2,(nt=t.getCell(`${i}138`))==null?void 0:nt.numeric(),(ot=t.getCell("G138"))==null?void 0:ot.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F141").value()}</h4>
            <span class='notation amount'>${E.kAmount}</span>
            <span class='notation'>${E.kCost}</span>`),w(t.getCell("F142").value(),(st=t.getCell(g+"142"))==null?void 0:st.value(),F,(it=t.getCell(`${i}142`))==null?void 0:it.numeric(),(at=t.getCell("G142"))==null?void 0:at.value()),w(t.getCell("F143").value(),(lt=t.getCell(g+"143"))==null?void 0:lt.value(),F,(ut=t.getCell(`${i}143`))==null?void 0:ut.numeric(),(rt=t.getCell("G143"))==null?void 0:rt.value()),w(t.getCell("F144").value(),(ct=t.getCell(g+"144"))==null?void 0:ct.value(),F,(pt=t.getCell(`${i}144`))==null?void 0:pt.numeric(),(gt=t.getCell("G144"))==null?void 0:gt.value()),w(t.getCell("F145").value(),(dt=t.getCell(g+"145"))==null?void 0:dt.value(),1,(mt=t.getCell(`${i}145`))==null?void 0:mt.numeric(),(ht=t.getCell("G145"))==null?void 0:ht.value()),w(t.getCell("F146").value(),(ft=t.getCell(g+"146"))==null?void 0:ft.value(),F-1,(vt=t.getCell(`${i}146`))==null?void 0:vt.numeric(),(_t=t.getCell("G146"))==null?void 0:_t.value()),A($("#furnitureList"),P(t.getCell("F147").value()," ",Math.round(ne*.3)+"\u20AC")),ne*=1.3,A($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),A($("#furnitureList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for furniture:</span><span class='list-text summary work'>${p.formatCurrency(ne)} \u20AC</span>`)),x||V||U||j||K||H>0||J||q||N){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${t.getCell("F102").value()}</h4><span class='notation amount'></span><span class='notation'>${E.kCost}</span>`);let l=0;const b=[t.getCell(`${i}103`).numeric()*n,t.getCell(`${i}104`).numeric(),(n<=60?440:410)*h*2*n*L/ge,t.getCell(`${i}106`).numeric(),((n<=60?90.02:n<=95?60.78:n<125?58.29:n>=125?79.01:0)+(n<=60?60.91:n<=95?64.57:n<125?63.87:n>=125?66.24:0))*n*yt,t.getCell(`${i}108`).numeric()/1.23,t.getCell(`${i}109`).numeric()*pe/ge,t.getCell(`${i}110`).numeric()*pe/ge,t.getCell(`${i}112`).numeric()*n],y=[K?1:0,j,V?1:0,H,J?1:0,q?1:0,x?1:0,x?1:0,N],k=[103,104,105,106,107,108,109,110,112];for(let v=0;v<k.length;v++){const Q=b[v]*y[v]*t.getCell("S104").numeric();Q===0||y[v]==0||(l+=Q,A(ue,P((Ct=t.getCell("F"+k[v]))==null?void 0:Ct.value(),"",p.formatCurrency(Q)+" \u20AC")))}if(N>0){const v=N*t.getCell(`${i}113`).numeric()*(1+t.getCell("S113").numeric()/100)/t.getCell("E5").numeric(),Q=v*.05*yt;A(ue,P(($t=t.getCell("F113"))==null?void 0:$t.value(),"",p.formatCurrency(v)+" \u20AC")),A(ue,P((wt=t.getCell("F114"))==null?void 0:wt.value(),"",p.formatCurrency(Q)+" \u20AC")),l+=Q+v}A($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),A($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for options:</span><span class='list-text summary work'>${p.formatCurrency(l)} \u20AC</span>`),S+=l}_||$(".comfy-section").toggle(!1),D||$("#furnitureList").toggle(!1);function w(l,b,y,k,v){if(!(!D||y==0||!y||!k)){if(ne+=k*y,A(Pt,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),b===null){A($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${l}</span><span class='list-text'>${y} ${v}</span>`);return}A($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${l}, ${b}</span><span class='list-text amount'>${y} ${v}</span><span class='list-text'>${p.formatCurrency(k*y)} \u20AC</span>`)}}A($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),A($("#materialsList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${p.formatCurrency(S)} \u20AC</span>`);let W=0;const de=document.getElementById("appliancesListTotal"),T=[];if(M==="gorenje"?T.push(154,9):M==="bosch"?T.push(169,10):M==="smeg"?T.push(185,9):T.push(154,9),_){let l="";for(let k=0;k<T[1];k++){const v=t.getCell("D"+(T[0]+k)).numeric()*.9;l+=`<div class="option-block">
          <div class="division-block pricelist"></div>
          <div class="list-option-container"><span class='name'>${t.getCell("F"+(T[0]+k)).value()} ${t.getCell("E"+(T[0]+k)).value()}</span>
            <span class='list-text amount'>1 piece</span>
            <span class='list-text'>${p.formatCurrency(v)}\u20AC</span>
            </div>
            </div>`,W+=v}const b=t.getCell("G35").numeric(),y=t.getCell("E5").numeric();W+=T[1]*b/y,l+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>Appliances delivery</span><span class='list-text amount'></span><span class='list-text'>${p.formatCurrency(T[1]*b/y)} \u20AC</span></div></div>`,l+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${t.getCell("F165").value()}</span><span class='list-text amount'></span><span class='list-text'>${p.formatCurrency(W*.2)} \u20AC</span></div></div>`,W*=1.2,l+=`<div class="division-block pricelist"></div><div class="list-option-container summary"><span class='pricelist-header small no-padding'>Total for appliances:</span><span class='list-text summary work'>${p.formatCurrency(W)} \u20AC</span></div>`,de.innerHTML=de.innerHTML+l}else de.style.display="none";if(x){const l=t.getCell(`${i}109`).numeric();$("#kitchenPrice").html(p.formatCurrency(l*pe)+" \u20AC")}else $("#kitchenSection").toggle(!1);S+=W,$("#totalPriceTotal").html(p.formatCurrency(S)+" \u20AC *"),$("#totalVAT").html(p.formatCurrency(S*1.23)+" \u20AC *"),$("#total").html(p.formatCurrency(S*1.23))});const _e=document.getElementById("wf-form-consult"),Ce=document.getElementById("wf-form-specification"),$e=document.getElementById("sName"),we=document.getElementById("sEmail"),Tt=document.getElementById("sAgreementCheckbox"),xt=document.getElementById("agreementCheckbox"),Nt=document.getElementById("name"),Mt=document.getElementById("phone");_e.addEventListener("submit",function(m){if(xt.checked?$("form#wf-form-consult .warning.agreementcheckbox").toggle(!1):$("form#wf-form-consult .warning.agreementcheckbox").toggle(!0),Mt.value?$("form#wf-form-consult .warning.phone:not(.specification)").toggle(!1):$("form#wf-form-consult .warning.phone:not(.specification)").toggle(!0),Nt.value?$("form#wf-form-consult .warning.name:not(.specification)").toggle(!1):$("form#wf-form-consult .warning.name:not(.specification)").toggle(!0),$("form#wf-form-consult .warning").is(":visible"))return m.preventDefault(),m.stopImmediatePropagation(),!1;s.collectPortugalClientData(new FormData(_e))}),Ce.addEventListener("submit",function(m){return ve(this,null,function*(){m.preventDefault();const f=we.value;if(Tt.checked?$("form#wf-form-specification .warning.agreementcheckbox").toggle(!1):$("form#wf-form-specification .warning.agreementcheckbox").toggle(!0),$e.value.length<2?$("form#wf-form-specification .warning.name").toggle(!0):$("form#wf-form-specification .warning.name").toggle(!1),f.length==0?($("form#wf-form-specification .warning.wrongEmail").toggle(!1),$("form#wf-form-specification .warning.emptyEmail").toggle(!0)):r.test(f)?($("form#wf-form-specification .warning.wrongEmail").toggle(!1),$("form#wf-form-specification .warning.emptyEmail").toggle(!1)):($("form#wf-form-specification .warning.wrongEmail").toggle(!0),$("form#wf-form-specification .warning.emptyEmail").toggle(!1)),!$("form#wf-form-specification .warning").is(":visible"))s.collectPortugalSpecificationData(new FormData(Ce)),Gt(),window.location.assign("/sdyakuiemo");else return m.stopImmediatePropagation(),!1})});function Gt(){return ve(this,null,function*(){$(".modal-note.specification").html("Please wait...");const f='<!DOCTYPE html><html lang="en_US">'+$("html").clone().find("script").remove().end().html()+"</html>",R=new File([f],"source.html",{type:"text/html"}),Z=new FormData;Z.append("file",R,"source.html");const X=yield(yield fetch("https://api.fortes.agency/convert",{method:"POST",body:Z})).json(),oe=X.success?X.id:"",ee=$e.value,se=we.value,ie=new Intl.DateTimeFormat("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}).format(new Date).replace(/\//g,"-");return fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:oe,fileName:`${ee} ${ie}`,recipientMail:se,lang:"eng",name:ee}),headers:{"Content-Type":"application/json"}})})}document.querySelectorAll("input").forEach(function(m){try{const f=m.dataset.name;f!=null&&f.length>0&&m.name!=f&&(m.name=f)}catch(f){}}),$("img").each(function(){$(this).attr("loading","eager")});function Ot(m){let f="J";return m=="cozy"?f="J":m=="japandi"?f="L":m=="fusion"?f="N":m=="modern"?f="P":m=="neoclassic"&&(f="R"),f}function P(m,f,R){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${m}</span><span class='list-text amount'>${f}</span><span class='list-text'>${R}</span></div></div>`}function A(m,f){m.append(f)}})})();
