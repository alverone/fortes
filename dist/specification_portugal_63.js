(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class l{constructor(e){this.cells=e}getCell(e){const l=this.cells.filter((t=>t.address===e));return 0==l.length?new t(e,"0"):l[0]}}class n{get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50)}initPortugal(){this.set("style","cozy"),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const l in e)"length"!==l&&"costPerMetre"!=l&&("true"!==String(e[l])?"false"!==String(e[l])?isFinite(Number(e[l]))?t[l]=Number(e[l]):t[l]=e[l]:t[l]=0:t[l]=1);return JSON.stringify(t)}}class i{static numberToEncodedLetter(e){if(isNaN(e))return;let t,l=(e=Math.abs(Math.floor(e)))%26,n=e/26;return e<=26?this.numToLetter(e):(n>=1&&(0===l&&n--,t=this.numberToEncodedLetter(n)),0===l&&(l=26),t+this.numToLetter(l))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}i.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class s{}s.kCost="Cost",s.kAmount="Amount",s.kKitchen="Kitchen",s.kLMonth="month";class a{static collectPortugalClientData(e){return fetch("https://script.google.com/macros/s/AKfycbw8iA1vk33T5UIZo_SAFw2gvvI1-sMY9UEQ3i8sDTaNsB2yJ2MKGphRa8PkJmqhgxB51A/exec",{method:"POST",body:e}).catch((e=>console.error("Error!",e.message)))}static collectPortugalCalcData(){const t=new n,l=t.get("style"),i=Boolean(t.get("appliances_bool_total")),s=Boolean(t.get("furniture_bool")),a=t.get("space"),o=Boolean(t.get("bath")),r=Boolean(t.get("shower")),c=t.get("amount_of_rooms"),u=t.get("amount_of_bathrooms"),p=Boolean(t.get("demontage")),d=t.get("windows_installation"),g=Boolean(t.get("finishing_materials")),m=Boolean(t.get("cement_screed")),v=Boolean(t.get("builtin_furiture")),h=t.get("heated_flooring"),C=Boolean(t.get("denoising")),$=Boolean(t.get("entrance_doors")),f=t.get("conditioning"),y=t.get("flooring"),k=t.get("transportation_expenses"),b=t.get("appliances"),w=t.get("summedPrice"),_=t.get("costPerMetre"),F=(a<=40?3:a<=80?4:a<=100?5:a<=130?6:a<=150?7:a<=175?8:9)+("modern"==l||"neoclassic"==l?1:0),L=new FormData;return L.append("Style",l),L.append("Total cost VAT",e.formatCurrency(w)),L.append("Total cost",e.formatCurrency(w/1.23)),L.append("Cost per metre",e.formatCurrency(_)),L.append("Cost per metre VAT",e.formatCurrency(1.23*_)),L.append("Area",a.toString()),L.append("Number of bedrooms",c.toString()),L.append("Number of bathrooms",u.toString()),L.append("Bath",o?"1":"0"),L.append("Shower",r?"1":"0"),L.append("Distance from Lisbon",k.toString()),L.append("Flooring",y),L.append("Finishing materials",g?"1":"0"),L.append("Dismantling works",p?"1":"0"),L.append("Cement screed",m?"1":"0"),L.append("Entrance doors",$?"1":"0"),L.append("Soundproofing",C?"1":"0"),L.append("Built-in furniture",v?"1":"0"),L.append("Underfloor heating",h.toString()),L.append("Air conditioning",f.toString()),L.append("Window installation",d.toString()),L.append("Decorating",s?"1":"0"),L.append("Appliances",i?b:"0"),L.append("Construction term, months",F.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:L}).catch((e=>console.error(e)))}}var o=(e,t,l)=>new Promise(((n,i)=>{var s=e=>{try{o(l.next(e))}catch(e){i(e)}},a=e=>{try{o(l.throw(e))}catch(e){i(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);o((l=l.apply(e,t)).next())}));$((function(){const r=new n,c=r.get("style"),u=(function(e){let t="J";"cozy"==e?t="J":"japandi"==e?t="L":"fusion"==e?t="N":"modern"==e?t="P":"neoclassic"==e&&(t="R")}(c),Boolean(r.get("appliances_bool_total"))),p=Boolean(r.get("furniture_bool")),d=r.get("space"),g=Boolean(r.get("bath")),m=Boolean(r.get("shower")),v=r.get("amount_of_rooms"),h=r.get("amount_of_bathrooms"),C=Boolean(r.get("demontage")),f=r.get("windows_installation"),y=Boolean(r.get("finishing_materials")),k=Boolean(r.get("cement_screed")),b=Boolean(r.get("builtin_furiture")),w=r.get("heated_flooring"),_=Boolean(r.get("denoising")),F=Boolean(r.get("entrance_doors")),L=r.get("conditioning"),S=r.get("flooring"),x=r.get("transportation_expenses"),T=r.get("appliances"),B=r.get("summedPrice"),P=r.get("costPerMetre"),G=$("#furnitureList");let M="",A="",N=0,D=0;const E=(d<=40?3:d<=80?4:d<=100?5:d<=130?6:d<=150?7:d<=175?8:9)+("modern"==c||"neoclassic"==c?1:0);function I(e,t,l){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${e}</span><span class='list-text amount'>${t}</span><span class='list-text'>${l}</span></div></div>`}function j(e,t){e.append(t)}$("#months").html(E.toString()),$("#total").html(e.formatCurrency(B)),$("#space").html(d.toString()),$("#pricePerMetre").html(e.formatCurrency(P)),fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json&gid=1219923480").then((e=>e.text())).then((n=>{var a,o,B,P,K,O,J,z,q,R,U,V,W,Y,H,Q,Z,X,ee,te,le,ne,ie,se,ae,oe,re,ce,ue,pe,de,ge,me,ve,he,Ce,$e,fe,ye,ke,be,we,_e,Fe,Le,Se,xe,Te,Be,Pe,Ge,Me,Ae,Ne,De,Ee,Ie,je,Ke,Oe,Je,ze,qe;const Re=JSON.parse(n.substring(n.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,Ue=new l(Re.map(((e,l)=>e.c.map((function(e,n){var s;if(null!==e&&null!==e.v)return new t(`${i.numberToEncodedLetter(n+1)}${l+1}`,null!=(s=e.v)?s:e.f)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t]))),Ve=Ue.getCell("S46").numeric(),We=Ue.getCell("S44").numeric(),Ye=Ue.getCell("S69").numeric(),He=Ue.getCell("T103").numeric(),Qe=Ue.getCell("S104").numeric();"cozy"==c?(M="I",A="A"):"japandi"==c?(M="K",A="B"):"fusion"==c?(M="M",A="C"):"modern"==c?(M="O",A="D"):"neoclassic"==c&&(M="Q",A="E");let Ze,Xe,et=0;"vynil"==S?(Ze="60",Xe="86",et=d*(d<70?220.33:161.8)*Ve*3):"parket"==S?(Ze="61",Xe="87",et=d*(d<80?369.96:240.31)*Ve*2):(Ze="59",Xe="85",et=d*(d<70?201.26:198.81)*Ve*2);const tt=$("#workList");let lt="";const nt=2523*((v>0?6:0)+(g?2:0)+(m?2:0)+2*h)*Ve*2*We+(g?1:0)*h*2500*2*We*Ve-950*Ve/41+4e3*(m?1:0)*h*2*We*Ve-800*Ve/41,it=1974*((v>0?3:0)+(g?1:0)+(m?1:0)+2*h)*Ve*2*We,st=d*h*(d<=100?83.2:33.98)*We*Ve*2,at=(d/v<=50?850*d:24*v*3519)*Ve*We,ot=[Ue.getCell("J47").numeric()/We,Ue.getCell("J48").numeric()/We,d/v<=50?d*(d<=60?1142.78:d<=95?883.87:819.43)*Ve*1.45:4*Math.sqrt(d)*3*600*Ve,d*(d<=60?283.08:d<=95?281.22:d<=124?338.33:362.47)*Ve*1.35*1.45,d*(d<=60?700.67:d<=100?687.36:d<=130?341.25:317.36)*Ve*1.1*1.5/2,2100*Ve,(d/v<50?1.77*(d<=50?1e3*d:990*d):4*Math.sqrt(d)*3*600)*Ve,d*(d<=60?418.86:d<=100?416.29:d<=135?416.73:416.67)*1.77*Ve,140*(d<=60?Ue.getCell(`${M}55`).numeric():d<=80?50:d<=120?78:d<=180?114:162)*("modern"==c||"neoclassic"==c?1:0),et,d*(d<=70?114.47:86.84)*Ve*2,d*(d<=70?206.59:170)*Ve*2*("japandi"==c||"fusion"==c?1:0)],rt=[m?h:0,g?h:0,1,1,h,h+v,1,1,1,1,"japandi"!==c&&"fusion"!==c?1:0,"japandi"===c||"fusion"===c?1:0],ct=[47,48,50,51,52,53,55,56,57,Ze,63,64];N+=nt,lt=I(Ue.getCell("F44").value(),"",Math.round(nt)+" €"),$("#workList").append(lt),N+=it,lt=I(Ue.getCell("F45").value(),"",Math.round(it)+" €"),$("#workList").append(lt),N+=st,lt=I(Ue.getCell("F46").value(),"",Math.round(st)+" €"),$("#workList").append(lt),N+=at,lt=I(Ue.getCell("F49").value(),"",Math.round(at)+" €"),$("#workList").append(lt);for(let e=0;e<ct.length;e++){const t=ot[e]*rt[e]*We;0===t||isNaN(t)||(N+=t,lt=I(Ue.getCell("F"+ct[e]).value(),"",Math.round(t)+" €"),$("#workList").append(lt))}if(y){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Ue.getCell("F68").value()}</h4><span class='notation amount'> </span><span class='notation'>${s.kCost}</span>`);const e=[Ue.getCell(`${M}69`).numeric(),Ue.getCell(`${M}70`).numeric(),Ue.getCell(`${M}71`).numeric(),Ue.getCell(`${M}72`).numeric(),Ue.getCell(`${M}73`).numeric(),Ue.getCell(`${M}74`).numeric(),Ue.getCell(`${M}76`).numeric(),Ue.getCell(`${M}77`).numeric(),Ue.getCell(`${M}78`).numeric(),Ue.getCell(`${M}79`).numeric(),Ue.getCell(`${M}80`).numeric(),Ue.getCell(`${M}81`).numeric(),Ue.getCell(`${M}82`).numeric(),Ue.getCell(`${M+Xe}`).numeric()];let t=[h+v,35*h,.66*d,.66*d,.59*d,d<=50?42:d<=90?60:d<=120?84:90,h,Number(g),Number(m),Number(g)+Number(m),h,h,h,d<100?d-7*h:d-10*h];const l=[69,70,71,72,73,74,76,77,78,79,80,81,82,Xe];for(let n=0;n<l.length;n++){const i=e[n]*t[n]*Ue.getCell("S69").numeric()/1.23;0===i||isNaN(i)||(N+=i,lt=I(Ue.getCell("F"+l[n]).value(),"",Math.round(i)+"€"),$("#workList").append(lt))}}lt=`<div class="option-block">\n      <div class="division-block pricelist"></div>\n      <div class="list-option-container">\n        <span class='name'>${Ue.getCell("F93").value()}</span>\n        <span class='list-text amount'>${E} months</span>\n        <span class='list-text'> </span>\n      </div>\n    </div>`,$("#workList").append(lt);const ut=[(41e3*Math.ceil((x+2)/5)/1.35/2/1.5+100*d)*We*Ve,.022*N*Ve,(2*E*1200+3e3+220*d)*We*Ve],pt=[94,95,96];lt="";for(let t=0;t<pt.length;t++){const l=ut[t];N+=l,lt+=`<div class="option-block">\n        <div class="division-block pricelist"></div>\n        <div class="list-option-container">\n          <span class='name'>${Ue.getCell(`F${pt[t]}`).value()}</span>\n            <span class='list-text amount'></span>\n          <span class='list-text'>${e.formatCurrency(l)} €</span>\n        </div>\n      </div>`}$("#workList").append(lt),lt="",j(tt,'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),j($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(N)} €</span>`),p&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${s.kKitchen}</h4>\n          <span class='notation amount'>${s.kAmount}</span>\n          <span class='notation'>${s.kCost}</span>`),dt(Ue.getCell("F121").value(),null==(a=Ue.getCell(`${A}121`))?void 0:a.value(),1,Ue.getCell(`${M}121`).numeric(),Ue.getCell("G121").value()),dt(Ue.getCell("F122").value(),null==(o=Ue.getCell(`${A}122`))?void 0:o.value(),4,Ue.getCell(`${M}122`).numeric(),Ue.getCell("G122").value()),dt(Ue.getCell("F123").value(),null==(B=Ue.getCell(`${A}123`))?void 0:B.value(),1,Ue.getCell(`${M}123`).numeric(),Ue.getCell("G123").value()),j($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),j($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Ue.getCell("F124").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),dt(Ue.getCell("F124").value(),null==(P=Ue.getCell(A+"124"))?void 0:P.value(),1,null==(K=Ue.getCell(`${M}124`))?void 0:K.numeric(),null==(O=Ue.getCell("G124"))?void 0:O.value()),dt(Ue.getCell("F125").value(),null==(J=Ue.getCell(A+"125"))?void 0:J.value(),1,null==(z=Ue.getCell(`${M}125`))?void 0:z.numeric(),null==(q=Ue.getCell("G125"))?void 0:q.value()),j($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),j($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Ue.getCell("F127").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),dt(Ue.getCell("F128").value(),null==(R=Ue.getCell(A+"128"))?void 0:R.value(),1,null==(U=Ue.getCell(`${M}128`))?void 0:U.numeric(),null==(V=Ue.getCell("G128"))?void 0:V.value()),dt(Ue.getCell("F129").value(),null==(W=Ue.getCell(A+"129"))?void 0:W.value(),1,null==(Y=Ue.getCell(`${M}129`))?void 0:Y.numeric(),null==(H=Ue.getCell("G129"))?void 0:H.value()),dt(Ue.getCell("F130").value(),null==(Q=Ue.getCell(A+"130"))?void 0:Q.value(),2,null==(Z=Ue.getCell(`${M}130`))?void 0:Z.numeric(),null==(X=Ue.getCell("G130"))?void 0:X.value()),dt(Ue.getCell("F131").value(),null==(ee=Ue.getCell(A+"131"))?void 0:ee.value(),1,null==(te=Ue.getCell(`${M}131`))?void 0:te.numeric(),null==(le=Ue.getCell("G131"))?void 0:le.value()),dt(Ue.getCell("F132").value(),null==(ne=Ue.getCell(A+"132"))?void 0:ne.value(),1,null==(ie=Ue.getCell(`${M}132`))?void 0:ie.numeric(),null==(se=Ue.getCell("G132"))?void 0:se.value()),j($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Ue.getCell("F133").value()}</h4><span class='notation amount'>${s.kAmount}</span><span class='notation'>${s.kCost}</span>`),dt(Ue.getCell("F134").value(),null==(ae=Ue.getCell(A+"134"))?void 0:ae.value(),Math.ceil(.48*d),null==(oe=Ue.getCell(`${M}134`))?void 0:oe.numeric(),null==(re=Ue.getCell("G134"))?void 0:re.value()),dt(Ue.getCell("F135").value(),null==(ce=Ue.getCell(A+"135"))?void 0:ce.value(),1,null==(ue=Ue.getCell(`${M}135`))?void 0:ue.numeric(),null==(pe=Ue.getCell("G135"))?void 0:pe.value()),dt(Ue.getCell("F137").value(),null==(de=Ue.getCell(A+"137"))?void 0:de.value(),1,null==(ge=Ue.getCell(`${M}137`))?void 0:ge.numeric(),null==(me=Ue.getCell("G137"))?void 0:me.value()),dt(Ue.getCell("F139").value(),null==(ve=Ue.getCell(A+"139"))?void 0:ve.value(),1,null==(he=Ue.getCell(`${M}139`))?void 0:he.numeric(),null==(Ce=Ue.getCell("G139"))?void 0:Ce.value()),dt(Ue.getCell("F140").value(),null==($e=Ue.getCell(A+"140"))?void 0:$e.value(),1,null==(fe=Ue.getCell(`${M}140`))?void 0:fe.numeric(),null==(ye=Ue.getCell("G140"))?void 0:ye.value()),dt(Ue.getCell("F136").value(),null==(ke=Ue.getCell(A+"136"))?void 0:ke.value(),v>1?1:0,null==(be=Ue.getCell(`${M}136`))?void 0:be.numeric(),null==(we=Ue.getCell("G136"))?void 0:we.value()),dt(Ue.getCell("F138").value(),null==(_e=Ue.getCell(A+"138"))?void 0:_e.value(),2,null==(Fe=Ue.getCell(`${M}138`))?void 0:Fe.numeric(),null==(Le=Ue.getCell("G138"))?void 0:Le.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Ue.getCell("F141").value()}</h4>\n            <span class='notation amount'>${s.kAmount}</span>\n            <span class='notation'>${s.kCost}</span>`),dt(Ue.getCell("F142").value(),null==(Se=Ue.getCell(A+"142"))?void 0:Se.value(),v,null==(xe=Ue.getCell(`${M}142`))?void 0:xe.numeric(),null==(Te=Ue.getCell("G142"))?void 0:Te.value()),dt(Ue.getCell("F143").value(),null==(Be=Ue.getCell(A+"143"))?void 0:Be.value(),v,null==(Pe=Ue.getCell(`${M}143`))?void 0:Pe.numeric(),null==(Ge=Ue.getCell("G143"))?void 0:Ge.value()),dt(Ue.getCell("F144").value(),null==(Me=Ue.getCell(A+"144"))?void 0:Me.value(),v,null==(Ae=Ue.getCell(`${M}144`))?void 0:Ae.numeric(),null==(Ne=Ue.getCell("G144"))?void 0:Ne.value()),dt(Ue.getCell("F145").value(),null==(De=Ue.getCell(A+"145"))?void 0:De.value(),1,null==(Ee=Ue.getCell(`${M}145`))?void 0:Ee.numeric(),null==(Ie=Ue.getCell("G145"))?void 0:Ie.value()),dt(Ue.getCell("F146").value(),null==(je=Ue.getCell(A+"146"))?void 0:je.value(),v-1,null==(Ke=Ue.getCell(`${M}146`))?void 0:Ke.numeric(),null==(Oe=Ue.getCell("G146"))?void 0:Oe.value()),j($("#furnitureList"),I(Ue.getCell("F147").value()," ",Math.round(.3*D)+"€")),D*=1.3,j($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),j($("#furnitureList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for furniture:</span><span class='list-text summary work'>${e.formatCurrency(D)} €</span>`));if(b||k||y||f||C||w>0||_||F||L){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Ue.getCell("F102").value()}</h4><span class='notation amount'></span><span class='notation'>${s.kCost}</span>`);let t=0;const l=[Ue.getCell(`${M}103`).numeric()*d,Ue.getCell(`${M}104`).numeric(),(d<=60?440:410)*Ve*2*d*We/Qe,Ue.getCell(`${M}106`).numeric(),((d<=60?90.02:d<=95?60.78:d<125?58.29:d>=125?79.01:0)+(d<=60?60.91:d<=95?64.57:d<125?63.87:d>=125?66.24:0))*d*He,Ue.getCell(`${M}108`).numeric()/1.23,Ue.getCell(`${M}109`).numeric()*Ye/Qe,Ue.getCell(`${M}110`).numeric()*Ye/Qe,Ue.getCell(`${M}112`).numeric()*d],n=[C?1:0,f,k?1:0,w,_?1:0,F?1:0,b?1:0,b?1:0,L],i=[103,104,105,106,107,108,109,110,112];for(let s=0;s<i.length;s++){const a=l[s]*n[s]*Ue.getCell("S104").numeric();0!==a&&0!=n[s]&&(t+=a,j(tt,I(null==(Je=Ue.getCell("F"+i[s]))?void 0:Je.value(),"",e.formatCurrency(a)+" €")))}if(L>0){const l=L*Ue.getCell(`${M}113`).numeric()*(1+Ue.getCell("S113").numeric()/100)/Ue.getCell("E5").numeric(),n=.05*l*He;j(tt,I(null==(ze=Ue.getCell("F113"))?void 0:ze.value(),"",e.formatCurrency(l)+" €")),j(tt,I(null==(qe=Ue.getCell("F114"))?void 0:qe.value(),"",e.formatCurrency(n)+" €")),t+=n+l}j($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),j($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for options:</span><span class='list-text summary work'>${e.formatCurrency(t)} €</span>`),N+=t}function dt(t,l,n,i,s){p&&0!=n&&n&&i&&(D+=i*n,j(G,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),null!==l?j($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${t}, ${l}</span><span class='list-text amount'>${n} ${s}</span><span class='list-text'>${e.formatCurrency(i*n)} €</span>`):j($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${t}</span><span class='list-text'>${n} ${s}</span>`))}u||$(".comfy-section").toggle(!1),p||$("#furnitureList").toggle(!1),j($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),j($("#materialsList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(N)} €</span>`);let gt=0;const mt=document.getElementById("appliancesListTotal"),vt=[];if("gorenje"===T?vt.push(154,9):"bosch"===T?vt.push(169,10):"smeg"===T?vt.push(185,9):vt.push(154,9),u){let t="";for(let l=0;l<vt[1];l++){const n=.9*Ue.getCell("D"+(vt[0]+l)).numeric();t+=`<div class="option-block">\n          <div class="division-block pricelist"></div>\n          <div class="list-option-container"><span class='name'>${Ue.getCell("F"+(vt[0]+l)).value()} ${Ue.getCell("E"+(vt[0]+l)).value()}</span>\n            <span class='list-text amount'>1 piece</span>\n            <span class='list-text'>${e.formatCurrency(n)}€</span>\n            </div>\n            </div>`,gt+=n}const l=Ue.getCell("G35").numeric(),n=Ue.getCell("E5").numeric();gt+=vt[1]*l/n,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>Appliances delivery</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(vt[1]*l/n)} €</span></div></div>`,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Ue.getCell("F165").value()}</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(.2*gt)} €</span></div></div>`,gt*=1.2,t+=`<div class="division-block pricelist"></div><div class="list-option-container summary"><span class='pricelist-header small no-padding'>Total for appliances:</span><span class='list-text summary work'>${e.formatCurrency(gt)} €</span></div>`,mt.innerHTML=mt.innerHTML+t}else mt.style.display="none";if(b){const t=Ue.getCell(`${M}109`).numeric();$("#kitchenPrice").html(e.formatCurrency(t*Ye)+" €")}else $("#kitchenSection").toggle(!1);N+=gt,1-Math.abs(r.get("summedPrice")/N)<=.06?($("#totalPriceTotal").html(e.formatCurrency(N)+" € *"),$("#totalVAT").html(e.formatCurrency(1.23*N)+" € *")):($("#totalPriceTotal").html(e.formatCurrency(r.get("summedPrice")/1.23)),$("#totalVAT").html(e.formatCurrency(r.get("summedPrice"))))})),$("#wf-form-consult").on("submit",(function(e){return o(this,null,(function*(){if(e.preventDefault(),$("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox").toggle(!1):$(".warning.agreementcheckbox").toggle(!0),$("#phone").val()?$(".warning.inputs.phone").toggle(!1):$(".warning.inputs.phone").toggle(!0),$("#name").val()?$(".warning.inputs.name").toggle(!1):$(".warning.inputs.name").toggle(!0),$(".warning").is(":visible"))return e.preventDefault(),!1;a.collectPortugalClientData(new FormData(document.getElementById("wf-form-consult"))),function(){o(this,null,(function*(){$(".modal-note").html("Please wait...");const e=$("html").clone().find("script").remove().end().html(),t=new File(['<!DOCTYPE html><html lang="en_US">'+e+"</html>"],"source.html",{type:"text/html"}),l=new FormData;l.append("file",t,"source.html");const n=yield fetch("https://api.fortes.agency/convert",{method:"POST",body:l}),i=yield n.json(),s=i.success?i.id:"";$(".modal-note").html("We sent your estimation to your email address. If you don't see it, check Spam folder or wait a few minutes."),fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:s,fileName:localStorage.getItem("style"),recipientMail:$("#sEmail").val()}),headers:{"Content-Type":"application/json"}}).finally((()=>window.location.assign("/sdyakuiemo")))}))}()}))})),$("img").each((function(){$(this).attr("loading","eager")}))}))})();