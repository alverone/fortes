(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class n{constructor(e){this.cells=e}getCell(e){const n=this.cells.filter((t=>t.address===e));return 0==n.length?new t(e,"0"):n[0]}}class l{get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50)}initPortugal(){this.set("style","cozy"),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const n in e)"length"!==n&&"costPerMetre"!=n&&("true"!==String(e[n])?"false"!==String(e[n])?isFinite(Number(e[n]))?t[n]=Number(e[n]):t[n]=e[n]:t[n]=0:t[n]=1);return JSON.stringify(t)}}class i{static numberToEncodedLetter(e){if(isNaN(e))return;let t,n=(e=Math.abs(Math.floor(e)))%26,l=e/26;return e<=26?this.numToLetter(e):(l>=1&&(0===n&&l--,t=this.numberToEncodedLetter(l)),0===n&&(n=26),t+this.numToLetter(n))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}i.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";class o{}o.kCost="Cost",o.kAmount="Amount",o.kKitchen="Kitchen",o.kLMonth="month";var a=(e,t,n)=>new Promise(((l,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},a=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())}));class s{static collectPortugalClientData(e){return a(this,null,(function*(){return fetch("https://script.google.com/macros/s/AKfycbw8iA1vk33T5UIZo_SAFw2gvvI1-sMY9UEQ3i8sDTaNsB2yJ2MKGphRa8PkJmqhgxB51A/exec",{method:"POST",body:e}).catch((e=>console.error("Error!",e.message)))}))}static collectPortugalCalcData(){return a(this,null,(function*(){const t=new l,n=t.get("style"),i=Boolean(t.get("appliances_bool_total")),o=Boolean(t.get("furniture_bool")),a=t.get("space"),s=Boolean(t.get("bath")),r=Boolean(t.get("shower")),c=t.get("amount_of_rooms"),u=t.get("amount_of_bathrooms"),p=Boolean(t.get("demontage")),g=t.get("windows_installation"),d=Boolean(t.get("finishing_materials")),m=Boolean(t.get("cement_screed")),v=Boolean(t.get("builtin_furiture")),h=t.get("heated_flooring"),C=Boolean(t.get("denoising")),f=Boolean(t.get("entrance_doors")),$=t.get("conditioning"),w=t.get("flooring"),y=t.get("transportation_expenses"),b=t.get("appliances"),k=t.get("summedPrice"),_=t.get("costPerMetre"),F=(a<=40?3:a<=80?4:a<=100?5:a<=130?6:a<=150?7:a<=175?8:9)+("modern"==n||"neoclassic"==n?1:0),S=new FormData;return S.append("Style",n),S.append("Total cost VAT",e.formatCurrency(k)),S.append("Total cost",e.formatCurrency(k/1.23)),S.append("Cost per metre",e.formatCurrency(_)),S.append("Cost per metre VAT",e.formatCurrency(1.23*_)),S.append("Area",a.toString()),S.append("Number of bedrooms",c.toString()),S.append("Number of bathrooms",u.toString()),S.append("Bath",s?"1":"0"),S.append("Shower",r?"1":"0"),S.append("Distance from Lisbon",y.toString()),S.append("Flooring",w),S.append("Finishing materials",d?"1":"0"),S.append("Dismantling works",p?"1":"0"),S.append("Cement screed",m?"1":"0"),S.append("Entrance doors",f?"1":"0"),S.append("Soundproofing",C?"1":"0"),S.append("Built-in furniture",v?"1":"0"),S.append("Underfloor heating",h.toString()),S.append("Air conditioning",$.toString()),S.append("Window installation",g.toString()),S.append("Decorating",o?"1":"0"),S.append("Appliances",i?b:"0"),S.append("Time to completion",F.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:S}).catch((e=>console.error(e)))}))}static collectPortugalSpecificationData(t){return a(this,null,(function*(){const n=new l,i=n.get("style"),o=Boolean(n.get("appliances_bool_total")),a=Boolean(n.get("furniture_bool")),s=n.get("space"),r=Boolean(n.get("bath")),c=Boolean(n.get("shower")),u=n.get("amount_of_rooms"),p=n.get("amount_of_bathrooms"),g=Boolean(n.get("demontage")),d=n.get("windows_installation"),m=Boolean(n.get("finishing_materials")),v=Boolean(n.get("cement_screed")),h=Boolean(n.get("builtin_furiture")),C=n.get("heated_flooring"),f=Boolean(n.get("denoising")),$=Boolean(n.get("entrance_doors")),w=n.get("conditioning"),y=n.get("flooring"),b=n.get("transportation_expenses"),k=n.get("appliances"),_=n.get("summedPrice"),F=n.get("costPerMetre"),S=(s<=40?3:s<=80?4:s<=100?5:s<=130?6:s<=150?7:s<=175?8:9)+("modern"==i||"neoclassic"==i?1:0);return t.append("Style",i),t.append("Total cost VAT",e.formatCurrency(_)),t.append("Total cost",e.formatCurrency(_/1.23)),t.append("Cost per metre",e.formatCurrency(F)),t.append("Cost per metre VAT",e.formatCurrency(1.23*F)),t.append("Area",s.toString()),t.append("Number of bedrooms",u.toString()),t.append("Number of bathrooms",p.toString()),t.append("Bath",r?"1":"0"),t.append("Shower",c?"1":"0"),t.append("Distance from Lisbon",b.toString()),t.append("Flooring",y),t.append("Finishing materials",m?"1":"0"),t.append("Dismantling works",g?"1":"0"),t.append("Cement screed",v?"1":"0"),t.append("Entrance doors",$?"1":"0"),t.append("Soundproofing",f?"1":"0"),t.append("Built-in furniture",h?"1":"0"),t.append("Underfloor heating",C.toString()),t.append("Air conditioning",w.toString()),t.append("Window installation",d.toString()),t.append("Decorating",a?"1":"0"),t.append("Appliances",o?k:"0"),t.append("Time to completion",S.toString()),fetch("https://script.google.com/macros/s/AKfycbzwN8RKdZRUWDBLNnvUwxxK9FXHUVPeqPpGFJYu9NT9zLsc34JKzIHgHz1CwFbNYGzs/exec",{method:"POST",body:t}).catch((e=>console.error(e)))}))}}var r=(e,t,n)=>new Promise(((l,i)=>{var o=e=>{try{s(n.next(e))}catch(e){i(e)}},a=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())}));$((function(){const a=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,c=new l,u=c.get("style"),p=(function(e){let t="J";"cozy"==e?t="J":"japandi"==e?t="L":"fusion"==e?t="N":"modern"==e?t="P":"neoclassic"==e&&(t="R")}(u),Boolean(c.get("appliances_bool_total"))),g=Boolean(c.get("furniture_bool")),d=c.get("space"),m=Boolean(c.get("bath")),v=Boolean(c.get("shower")),h=c.get("amount_of_rooms"),C=c.get("amount_of_bathrooms"),f=Boolean(c.get("demontage")),w=c.get("windows_installation"),y=Boolean(c.get("finishing_materials")),b=Boolean(c.get("cement_screed")),k=Boolean(c.get("builtin_furiture")),_=c.get("heated_flooring"),F=Boolean(c.get("denoising")),S=Boolean(c.get("entrance_doors")),L=c.get("conditioning"),B=c.get("flooring"),x=c.get("transportation_expenses"),T=c.get("appliances"),P=c.get("summedPrice"),A=c.get("costPerMetre"),N=$("#furnitureList");let G="",E="",M=0,D=0;const I=(d<=40?3:d<=80?4:d<=100?5:d<=130?6:d<=150?7:d<=175?8:9)+("modern"==u||"neoclassic"==u?1:0);function K(e,t,n){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${e}</span><span class='list-text amount'>${t}</span><span class='list-text'>${n}</span></div></div>`}function z(e,t){e.append(t)}$("#months").html(I.toString()),$("#total").html(e.formatCurrency(P)),$("#space").html(d.toString()),$("#pricePerMetre").html(e.formatCurrency(A)),fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json&gid=1219923480").then((e=>e.text())).then((l=>{var a,s,r,P,A,j,J,O,U,V,R,q,H,W,Y,Z,Q,X,ee,te,ne,le,ie,oe,ae,se,re,ce,ue,pe,ge,de,me,ve,he,Ce,fe,$e,we,ye,be,ke,_e,Fe,Se,Le,Be,xe,Te,Pe,Ae,Ne,Ge,Ee,Me,De,Ie,Ke,ze,je,Je,Oe,Ue;const Ve=JSON.parse(l.substring(l.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,Re=new n(Ve.map(((e,n)=>e.c.map((function(e,l){var o;if(null!==e&&null!==e.v)return new t(`${i.numberToEncodedLetter(l+1)}${n+1}`,null!=(o=e.v)?o:e.f)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t]))),qe=Re.getCell("S46").numeric(),He=Re.getCell("S44").numeric(),We=Re.getCell("S69").numeric(),Ye=Re.getCell("T103").numeric(),Ze=Re.getCell("S104").numeric();"cozy"==u?(G="I",E="A"):"japandi"==u?(G="K",E="B"):"fusion"==u?(G="M",E="C"):"modern"==u?(G="O",E="D"):"neoclassic"==u&&(G="Q",E="E");let Qe,Xe,et=0;"vynil"==B?(Qe="60",Xe="86",et=d*(d<70?220.33:161.8)*qe*3):"parket"==B?(Qe="61",Xe="87",et=d*(d<80?369.96:240.31)*qe*2):(Qe="59",Xe="85",et=d*(d<70?201.26:198.81)*qe*2);const tt=$("#workList");let nt="";const lt=2523*((h>0?6:0)+(m?2:0)+(v?2:0)+2*C)*qe*2*He+(m?1:0)*C*2500*2*He*qe-950*qe/41+4e3*(v?1:0)*C*2*He*qe-800*qe/41,it=1974*((h>0?3:0)+(m?1:0)+(v?1:0)+2*C)*qe*2*He,ot=d*C*(d<=100?83.2:33.98)*He*qe*2,at=(d/h<=50?850*d:24*h*3519)*qe*He,st=[Re.getCell("J47").numeric()/He,Re.getCell("J48").numeric()/He,d/h<=50?d*(d<=60?1142.78:d<=95?883.87:819.43)*qe*1.45:4*Math.sqrt(d)*3*600*qe,d*(d<=60?283.08:d<=95?281.22:d<=124?338.33:362.47)*qe*1.35*1.45,d*(d<=60?700.67:d<=100?687.36:d<=130?341.25:317.36)*qe*1.1*1.5/2,2100*qe,(d/h<50?1.77*(d<=50?1e3*d:990*d):4*Math.sqrt(d)*3*600)*qe,d*(d<=60?418.86:d<=100?416.29:d<=135?416.73:416.67)*1.77*qe,140*(d<=60?Re.getCell(`${G}55`).numeric():d<=80?50:d<=120?78:d<=180?114:162)*("modern"==u||"neoclassic"==u?1:0),et,d*(d<=70?114.47:86.84)*qe*2,d*(d<=70?206.59:170)*qe*2*("japandi"==u||"fusion"==u?1:0)],rt=[v?C:0,m?C:0,1,1,C,C+h,1,1,1,1,"japandi"!==u&&"fusion"!==u?1:0,"japandi"===u||"fusion"===u?1:0],ct=[47,48,50,51,52,53,55,56,57,Qe,63,64];M+=lt,nt=K(Re.getCell("F44").value(),"",Math.round(lt)+" €"),$("#workList").append(nt),M+=it,nt=K(Re.getCell("F45").value(),"",Math.round(it)+" €"),$("#workList").append(nt),M+=ot,nt=K(Re.getCell("F46").value(),"",Math.round(ot)+" €"),$("#workList").append(nt),M+=at,nt=K(Re.getCell("F49").value(),"",Math.round(at)+" €"),$("#workList").append(nt);for(let e=0;e<ct.length;e++){const t=st[e]*rt[e]*He;0===t||isNaN(t)||(M+=t,nt=K(Re.getCell("F"+ct[e]).value(),"",Math.round(t)+" €"),$("#workList").append(nt))}if(y){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Re.getCell("F68").value()}</h4><span class='notation amount'> </span><span class='notation'>${o.kCost}</span>`);const e=[Re.getCell(`${G}69`).numeric(),Re.getCell(`${G}70`).numeric(),Re.getCell(`${G}71`).numeric(),Re.getCell(`${G}72`).numeric(),Re.getCell(`${G}73`).numeric(),Re.getCell(`${G}74`).numeric(),Re.getCell(`${G}76`).numeric(),Re.getCell(`${G}77`).numeric(),Re.getCell(`${G}78`).numeric(),Re.getCell(`${G}79`).numeric(),Re.getCell(`${G}80`).numeric(),Re.getCell(`${G}81`).numeric(),Re.getCell(`${G}82`).numeric(),Re.getCell(`${G+Xe}`).numeric()];let t=[C+h,35*C,.66*d,.66*d,.59*d,d<=50?42:d<=90?60:d<=120?84:90,C,Number(m),Number(v),Number(m)+Number(v),C,C,C,d<100?d-7*C:d-10*C];const n=[69,70,71,72,73,74,76,77,78,79,80,81,82,Xe];for(let l=0;l<n.length;l++){const i=e[l]*t[l]*Re.getCell("S69").numeric()/1.23;0===i||isNaN(i)||(M+=i,nt=K(Re.getCell("F"+n[l]).value(),"",Math.round(i)+"€"),$("#workList").append(nt))}}nt=`<div class="option-block">\n      <div class="division-block pricelist"></div>\n      <div class="list-option-container">\n        <span class='name'>${Re.getCell("F93").value()}</span>\n        <span class='list-text amount'>${I} months</span>\n        <span class='list-text'> </span>\n      </div>\n    </div>`,$("#workList").append(nt);const ut=[(41e3*Math.ceil((x+2)/5)/1.35/2/1.5+100*d)*He*qe,.022*M*qe,(2*I*1200+3e3+220*d)*He*qe],pt=[94,95,96];nt="";for(let t=0;t<pt.length;t++){const n=ut[t];M+=n,nt+=`<div class="option-block">\n        <div class="division-block pricelist"></div>\n        <div class="list-option-container">\n          <span class='name'>${Re.getCell(`F${pt[t]}`).value()}</span>\n            <span class='list-text amount'></span>\n          <span class='list-text'>${e.formatCurrency(n)} €</span>\n        </div>\n      </div>`}$("#workList").append(nt),nt="",z(tt,'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),z($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(M)} €</span>`),g&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${o.kKitchen}</h4>\n          <span class='notation amount'>${o.kAmount}</span>\n          <span class='notation'>${o.kCost}</span>`),gt(Re.getCell("F121").value(),null==(a=Re.getCell(`${E}121`))?void 0:a.value(),1,Re.getCell(`${G}121`).numeric(),Re.getCell("G121").value()),gt(Re.getCell("F122").value(),null==(s=Re.getCell(`${E}122`))?void 0:s.value(),4,Re.getCell(`${G}122`).numeric(),Re.getCell("G122").value()),gt(Re.getCell("F123").value(),null==(r=Re.getCell(`${E}123`))?void 0:r.value(),1,Re.getCell(`${G}123`).numeric(),Re.getCell("G123").value()),z($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),z($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Re.getCell("F124").value()}</h4><span class='notation amount'>${o.kAmount}</span><span class='notation'>${o.kCost}</span>`),gt(Re.getCell("F124").value(),null==(P=Re.getCell(E+"124"))?void 0:P.value(),1,null==(A=Re.getCell(`${G}124`))?void 0:A.numeric(),null==(j=Re.getCell("G124"))?void 0:j.value()),gt(Re.getCell("F125").value(),null==(J=Re.getCell(E+"125"))?void 0:J.value(),1,null==(O=Re.getCell(`${G}125`))?void 0:O.numeric(),null==(U=Re.getCell("G125"))?void 0:U.value()),z($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),z($("#furnitureList .list-option-container").last(),`<h4 class="pricelist-header small no-padding">${Re.getCell("F127").value()}</h4><span class='notation amount'>${o.kAmount}</span><span class='notation'>${o.kCost}</span>`),gt(Re.getCell("F128").value(),null==(V=Re.getCell(E+"128"))?void 0:V.value(),1,null==(R=Re.getCell(`${G}128`))?void 0:R.numeric(),null==(q=Re.getCell("G128"))?void 0:q.value()),gt(Re.getCell("F129").value(),null==(H=Re.getCell(E+"129"))?void 0:H.value(),1,null==(W=Re.getCell(`${G}129`))?void 0:W.numeric(),null==(Y=Re.getCell("G129"))?void 0:Y.value()),gt(Re.getCell("F130").value(),null==(Z=Re.getCell(E+"130"))?void 0:Z.value(),2,null==(Q=Re.getCell(`${G}130`))?void 0:Q.numeric(),null==(X=Re.getCell("G130"))?void 0:X.value()),gt(Re.getCell("F131").value(),null==(ee=Re.getCell(E+"131"))?void 0:ee.value(),1,null==(te=Re.getCell(`${G}131`))?void 0:te.numeric(),null==(ne=Re.getCell("G131"))?void 0:ne.value()),gt(Re.getCell("F132").value(),null==(le=Re.getCell(E+"132"))?void 0:le.value(),1,null==(ie=Re.getCell(`${G}132`))?void 0:ie.numeric(),null==(oe=Re.getCell("G132"))?void 0:oe.value()),z($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Re.getCell("F133").value()}</h4><span class='notation amount'>${o.kAmount}</span><span class='notation'>${o.kCost}</span>`),gt(Re.getCell("F134").value(),null==(ae=Re.getCell(E+"134"))?void 0:ae.value(),Math.ceil(.48*d),null==(se=Re.getCell(`${G}134`))?void 0:se.numeric(),null==(re=Re.getCell("G134"))?void 0:re.value()),gt(Re.getCell("F135").value(),null==(ce=Re.getCell(E+"135"))?void 0:ce.value(),1,null==(ue=Re.getCell(`${G}135`))?void 0:ue.numeric(),null==(pe=Re.getCell("G135"))?void 0:pe.value()),gt(Re.getCell("F137").value(),null==(ge=Re.getCell(E+"137"))?void 0:ge.value(),1,null==(de=Re.getCell(`${G}137`))?void 0:de.numeric(),null==(me=Re.getCell("G137"))?void 0:me.value()),gt(Re.getCell("F139").value(),null==(ve=Re.getCell(E+"139"))?void 0:ve.value(),1,null==(he=Re.getCell(`${G}139`))?void 0:he.numeric(),null==(Ce=Re.getCell("G139"))?void 0:Ce.value()),gt(Re.getCell("F140").value(),null==(fe=Re.getCell(E+"140"))?void 0:fe.value(),1,null==($e=Re.getCell(`${G}140`))?void 0:$e.numeric(),null==(we=Re.getCell("G140"))?void 0:we.value()),gt(Re.getCell("F136").value(),null==(ye=Re.getCell(E+"136"))?void 0:ye.value(),h>1?1:0,null==(be=Re.getCell(`${G}136`))?void 0:be.numeric(),null==(ke=Re.getCell("G136"))?void 0:ke.value()),gt(Re.getCell("F138").value(),null==(_e=Re.getCell(E+"138"))?void 0:_e.value(),2,null==(Fe=Re.getCell(`${G}138`))?void 0:Fe.numeric(),null==(Se=Re.getCell("G138"))?void 0:Se.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Re.getCell("F141").value()}</h4>\n            <span class='notation amount'>${o.kAmount}</span>\n            <span class='notation'>${o.kCost}</span>`),gt(Re.getCell("F142").value(),null==(Le=Re.getCell(E+"142"))?void 0:Le.value(),h,null==(Be=Re.getCell(`${G}142`))?void 0:Be.numeric(),null==(xe=Re.getCell("G142"))?void 0:xe.value()),gt(Re.getCell("F143").value(),null==(Te=Re.getCell(E+"143"))?void 0:Te.value(),h,null==(Pe=Re.getCell(`${G}143`))?void 0:Pe.numeric(),null==(Ae=Re.getCell("G143"))?void 0:Ae.value()),gt(Re.getCell("F144").value(),null==(Ne=Re.getCell(E+"144"))?void 0:Ne.value(),h,null==(Ge=Re.getCell(`${G}144`))?void 0:Ge.numeric(),null==(Ee=Re.getCell("G144"))?void 0:Ee.value()),gt(Re.getCell("F145").value(),null==(Me=Re.getCell(E+"145"))?void 0:Me.value(),1,null==(De=Re.getCell(`${G}145`))?void 0:De.numeric(),null==(Ie=Re.getCell("G145"))?void 0:Ie.value()),gt(Re.getCell("F146").value(),null==(Ke=Re.getCell(E+"146"))?void 0:Ke.value(),h-1,null==(ze=Re.getCell(`${G}146`))?void 0:ze.numeric(),null==(je=Re.getCell("G146"))?void 0:je.value()),z($("#furnitureList"),K(Re.getCell("F147").value()," ",Math.round(.3*D)+"€")),D*=1.3,z($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),z($("#furnitureList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for furniture:</span><span class='list-text summary work'>${e.formatCurrency(D)} €</span>`));if(k||b||y||w||f||_>0||F||S||L){$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append(`<h4 class="pricelist-header small no-padding">${Re.getCell("F102").value()}</h4><span class='notation amount'></span><span class='notation'>${o.kCost}</span>`);let t=0;const n=[Re.getCell(`${G}103`).numeric()*d,Re.getCell(`${G}104`).numeric(),(d<=60?440:410)*qe*2*d*He/Ze,Re.getCell(`${G}106`).numeric(),((d<=60?90.02:d<=95?60.78:d<125?58.29:d>=125?79.01:0)+(d<=60?60.91:d<=95?64.57:d<125?63.87:d>=125?66.24:0))*d*Ye,Re.getCell(`${G}108`).numeric()/1.23,Re.getCell(`${G}109`).numeric()*We/Ze,Re.getCell(`${G}110`).numeric()*We/Ze,Re.getCell(`${G}112`).numeric()*d],l=[f?1:0,w,b?1:0,_,F?1:0,S?1:0,k?1:0,k?1:0,L],i=[103,104,105,106,107,108,109,110,112];for(let o=0;o<i.length;o++){const a=n[o]*l[o]*Re.getCell("S104").numeric();0!==a&&0!=l[o]&&(t+=a,z(tt,K(null==(Je=Re.getCell("F"+i[o]))?void 0:Je.value(),"",e.formatCurrency(a)+" €")))}if(L>0){const n=L*Re.getCell(`${G}113`).numeric()*(1+Re.getCell("S113").numeric()/100)/Re.getCell("E5").numeric(),l=.05*n*Ye;z(tt,K(null==(Oe=Re.getCell("F113"))?void 0:Oe.value(),"",e.formatCurrency(n)+" €")),z(tt,K(null==(Ue=Re.getCell("F114"))?void 0:Ue.value(),"",e.formatCurrency(l)+" €")),t+=l+n}z($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),z($("#workList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for options:</span><span class='list-text summary work'>${e.formatCurrency(t)} €</span>`),M+=t}function gt(t,n,l,i,o){g&&0!=l&&l&&i&&(D+=i*l,z(N,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),null!==n?z($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${t}, ${n}</span><span class='list-text amount'>${l} ${o}</span><span class='list-text'>${e.formatCurrency(i*l)} €</span>`):z($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${t}</span><span class='list-text'>${l} ${o}</span>`))}p||$(".comfy-section").toggle(!1),g||$("#furnitureList").toggle(!1),z($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),z($("#materialsList .list-option-container").last(),`<span class='pricelist-header small no-padding'>Total for construction with components and finishing materials:</span><span class='list-text summary work'>${e.formatCurrency(M)} €</span>`);let dt=0;const mt=document.getElementById("appliancesListTotal"),vt=[];if("gorenje"===T?vt.push(154,9):"bosch"===T?vt.push(169,10):"smeg"===T?vt.push(185,9):vt.push(154,9),p){let t="";for(let n=0;n<vt[1];n++){const l=.9*Re.getCell("D"+(vt[0]+n)).numeric();t+=`<div class="option-block">\n          <div class="division-block pricelist"></div>\n          <div class="list-option-container"><span class='name'>${Re.getCell("F"+(vt[0]+n)).value()} ${Re.getCell("E"+(vt[0]+n)).value()}</span>\n            <span class='list-text amount'>1 piece</span>\n            <span class='list-text'>${e.formatCurrency(l)}€</span>\n            </div>\n            </div>`,dt+=l}const n=Re.getCell("G35").numeric(),l=Re.getCell("E5").numeric();dt+=vt[1]*n/l,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>Appliances delivery</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(vt[1]*n/l)} €</span></div></div>`,t+=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Re.getCell("F165").value()}</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(.2*dt)} €</span></div></div>`,dt*=1.2,t+=`<div class="division-block pricelist"></div><div class="list-option-container summary"><span class='pricelist-header small no-padding'>Total for appliances:</span><span class='list-text summary work'>${e.formatCurrency(dt)} €</span></div>`,mt.innerHTML=mt.innerHTML+t}else mt.style.display="none";if(k){const t=Re.getCell(`${G}109`).numeric();$("#kitchenPrice").html(e.formatCurrency(t*We)+" €")}else $("#kitchenSection").toggle(!1);M+=dt,1-Math.abs(c.get("summedPrice")/M)<=.06?($("#totalPriceTotal").html(e.formatCurrency(M)+" € *"),$("#totalVAT").html(e.formatCurrency(1.23*M)+" € *")):($("#totalPriceTotal").html(e.formatCurrency(c.get("summedPrice")/1.23)),$("#totalVAT").html(e.formatCurrency(c.get("summedPrice"))))})),$("#wf-form-consult").on("submit",(function(e){if(e.preventDefault(),$("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox:not(.specification)").toggle(!1):$(".warning.agreementcheckbox:not(.specification)").toggle(!0),$("#phone").val()?$(".warning.phone:not(.specification)").toggle(!1):$(".warning.phone:not(.specification)").toggle(!0),$("#name").val()?$(".warning.name:not(.specification)").toggle(!1):$(".warning.name:not(.specification)").toggle(!0),$(".warning:not(.specification)").is(":visible"))return e.preventDefault(),!1;s.collectPortugalClientData(new FormData(document.getElementById("wf-form-consult")))})),$("#wf-form-specification").on("submit",(function(e){return r(this,null,(function*(){e.preventDefault(),e.stopImmediatePropagation(),$("#agreementCheckbox").is(":checked")?$(".warning.agreementcheckbox.specification").toggle(!1):$(".warning.agreementcheckbox.specification").toggle(!0),$("#sPhone").val()?$(".warning.phone.specification").toggle(!1):$(".warning.phone.specification").toggle(!0),$("#sName").val()?$(".warning.name.specification").toggle(!1):$(".warning.name.specification").toggle(!0),0==$("#sEmail").val().length?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!0)):a.test($("#sEmail").val())?($(".warning.wrongEmail.specification").toggle(!1),$(".warning.emptyEmail.specification").toggle(!1)):($(".warning.wrongEmail.specification").toggle(!0),$(".warning.emptyEmail.specification").toggle(!1)),$(".warning.specification").is(":visible")||(s.collectPortugalSpecificationData(new FormData(document.getElementById("wf-form-specification"))),function(){r(this,null,(function*(){$(".modal-note.specification").html("Please wait...");const e=$("html").clone().find("script").remove().end().html(),t=new File(['<!DOCTYPE html><html lang="en_US">'+e+"</html>"],"source.html",{type:"text/html"}),n=new FormData;n.append("file",t,"source.html");const l=yield fetch("https://api.fortes.agency/convert",{method:"POST",body:n}),i=yield l.json(),o=i.success?i.id:"";$(".modal-note.specification").html("We sent your estimation to your email address. If you don't see it, check Spam folder or wait a few minutes."),fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:o,fileName:localStorage.getItem("style"),recipientMail:$("#sEmail").val()}),headers:{"Content-Type":"application/json"}}).finally((()=>window.location.assign("/sdyakuiemo")))}))}())}))})),$("img").each((function(){$(this).attr("loading","eager")}))}))})();