(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class n{constructor(e){this.cells=e}getCell(e){const n=this.cells.filter((t=>t.address===e));return 0==n.length?new t(e,"0"):n[0]}}class s{static numberToEncodedLetter(e){if(isNaN(e))return;let t,n=(e=Math.abs(Math.floor(e)))%26,s=e/26;return e<=26?this.numToLetter(e):(s>=1&&(0===n&&s--,t=this.numberToEncodedLetter(s)),0===n&&(n=26),t+this.numToLetter(n))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}s.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var o=(e=>(e[e.uk=0]="uk",e[e.en=1]="en",e))(o||{});class i{constructor(e,t=!1){if(t)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const n in e)"length"!==n&&"costPerMetre"!=n&&"color"!=n&&("true"!==String(e[n])?"false"!==String(e[n])?isFinite(Number(e[n]))?t[n]=Number(e[n]):t[n]=e[n]:t[n]=0:t[n]=1);return JSON.stringify(t)}}$((function(){fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json").then((e=>e.text())).then((e=>{const o=JSON.parse(e.substring(e.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,i=new n(o.map(((e,n)=>e.c.map((function(e,o){return null===e||null===e.v?new t("","0"):new t(`${s.numberToEncodedLetter(o+1)}${n+1}`,e.v)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t])));document.getElementById("dollarCourse").innerText=i.getCell("G7").formattedNumerical()}));const r=document.getElementById("floorscreed"),a=document.getElementById("doors"),c=document.getElementById("noise"),l=document.getElementById("bathtub"),u=document.getElementById("shower"),h=document.getElementById("conditioning"),d=document.getElementById("secondGypsumLayer"),m=document.getElementById("hygienicShower"),g=document.getElementById("furnitureBool"),p=document.getElementById("appliancesBool"),f=document.querySelector('input[type="radio"][name="flooring"]'),v=document.querySelector('input[type="radio"][name="ceiling"]'),_=document.getElementById("total"),y=document.getElementById("totalWhole"),b=document.getElementById("space"),B=document.getElementById("amountOfRooms"),I=document.getElementById("amountOfBathrooms"),k=document.getElementById("heatedFlooring"),E=new i(o.uk,!0);b.value="50";const w=function(e,t,n){var s,o,i;void 0===t&&(t=50),void 0===n&&(n={});var r=null!=(s=n.isImmediate)&&s,a=null!=(o=n.callback)&&o,c=n.maxWait,l=Date.now(),u=[];function h(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var d=function(){var t=[].slice.call(arguments),n=this;return new Promise((function(s,o){var c=r&&void 0===i;if(void 0!==i&&clearTimeout(i),i=setTimeout((function(){if(i=void 0,l=Date.now(),!r){var s=e.apply(n,t);a&&a(s),u.forEach((function(e){return(0,e.resolve)(s)})),u=[]}}),h()),c){var d=e.apply(n,t);return a&&a(d),s(d)}u.push({resolve:s,reject:o})}))};return d.cancel=function(e){void 0!==i&&clearTimeout(i),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},d}((function(){return t=this,n=null,s=function*(){return T(),fetch("https://api.fortes.agency/calc",{body:E.storageToRequestBody(localStorage),headers:{"Content-Type":"application/json"},method:"POST"}).then((e=>e.json())).then((t=>{const n=parseFloat(t.cost_per_meter);E.set("costPerMetre",n),E.set("summedPrice",t.cost_per_meter*E.get("space")),_.innerText=e.formatCurrency(n),y.innerText=e.formatCurrency(n*E.get("space"))}))},new Promise(((e,o)=>{var i=e=>{try{a(s.next(e))}catch(e){o(e)}},r=e=>{try{a(s.throw(e))}catch(e){o(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,r);a((s=s.apply(t,n)).next())}));var t,n,s}),300);function T(){E.set("space",b.value),E.set("amount_of_rooms",B.value),E.set("amount_of_bathrooms",I.value),E.set("heated_flooring",k.value),E.set("conditioning",h.value),E.set("hygienic_shower",m.checked),E.set("second_gypsum_layer",d.checked),E.set("furniture_bool",g.checked),E.set("bath",l.checked),E.set("shower",u.checked),E.set("appliances_bool_total",p.checked),E.set("floor_screed",r.checked),E.set("denoising",c.checked),E.set("entrance_doors",a.checked),E.set("ceiling",v.value),E.set("flooring",f.value)}w(),$(".calculator input").not(".form-2 input").on("change",(()=>{T(),w()})),$("#space").on("focusout",(function(){if($(this).val($(this).val().toString().match(/\d*\.?\d+/)),E.set("space",b.value),0===E.get("space")||0===E.get("amount_of_rooms"))return _.innerText="0",void(y.innerText="0");w()})),b.addEventListener("focusout",(function(){(0==this.value.length||isNaN(parseInt(this.value))||parseInt(this.value)<30)&&(b.value="30",E.set("space",30),w())})),$(".increment-field .increment").on("click",(function(e){if(e.preventDefault(),$(this).siblings(".increment-input").val(parseInt($(this).siblings(".increment-input").val())+parseInt($(this).val())),"0"===$(this).siblings(".increment-input").val()?"1"===$(this).val()?$(this).siblings(".increment").toggleClass("disabled"):$(this).toggleClass("disabled"):parseInt($(this).siblings(".increment-input").val())>0&&$(this).siblings(".disabled").toggleClass("disabled"),0==E.get("amount_of_rooms"))return _.innerText="0",void(y.innerText="0");w()})),document.querySelectorAll(".calculator-tab, .tab-new").forEach((e=>e.addEventListener("click",(()=>w())))),$(".choice").on("click",(function(){$("#node").is(":checked")&&($(".choiceActiveBorder").removeClass("choiceActiveBorder"),$(this).parent().toggleClass("choiceActiveBorder"),$("#appliancesBool").prop("checked",!0),$("#node").siblings("div").removeClass("w--redirected-checked"),$("#appliancesBool").siblings("div").addClass("w--redirected-checked")),E.set("appliances_bool_total",!0),E.set("appliances",$(this).data("appliances")),w()})),$("#node").on("click",(function(){E.set("appliances_bool_total",!1),w()})),$("#appliancesBool").on("click",(function(){$(this).is(":checked")&&(document.querySelector(".choiceActiveBorder")||(E.set("appliances_bool_total",1),E.set("appliances","gorenje"),w()))})),$("#appliancesBool").on("change",(function(){$(this).is(":checked")&&(E.set("appliances_bool_total",!0),w())}))}))})();