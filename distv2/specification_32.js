(()=>{"use strict";class e{static formatCurrency(e){return Intl.NumberFormat("uk-UA",{maximumFractionDigits:2}).format(e)}}class t{constructor(e,t){this.address=e,this._value=t}hasValue(){return null!==this._value&&this._value.length>0}value(){return this._value}numeric(){return parseFloat(this._value)}formattedNumerical(){return e.formatCurrency(parseFloat(this.value()))}}class n{constructor(e){this.cells=e}getCell(e){const n=this.cells.filter((t=>t.address===e));return 0==n.length?new t(e,"0"):n[0]}}var l=(e=>(e[e.uk=0]="uk",e[e.en=1]="en",e))(l||{});class i{constructor(e,t=!1){if(t)switch(e){case 0:this._init();case 1:this._initPortugal();default:this._init()}}get(e){try{return JSON.parse(localStorage.getItem(e))}catch(t){return localStorage.getItem(e)}}set(e,t){localStorage.setItem(e,t.toString())}_init(){this.set("style","cozy"),this.set("bath",!0),this.set("shower",!1),this.set("ceiling","stretch ceiling"),this.set("flooring","laminat"),this.set("hygienic_shower",!1),this.set("second_gypsum_layer",!1),this.set("floor_screed",!1),this.set("heated_flooring",!1),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("conditioning",!1),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("appliances","gorenje"),this.set("appliances_bool_total",!1),this.set("furniture_bool",!0),this.set("space",50),this.set("color",1)}_initPortugal(){this.set("style","cozy"),this.set("color",1),this.set("space",50),this.set("amount_of_rooms",2),this.set("amount_of_bathrooms",1),this.set("bath",!0),this.set("shower",!1),this.set("flooring","laminat"),this.set("finishing_materials",!1),this.set("demontage",!1),this.set("cement_screed",!1),this.set("heated_flooring",0),this.set("denoising",!1),this.set("entrance_doors",!1),this.set("windows_installation",0),this.set("builtin_furniture",!1),this.set("conditioning",0),this.set("furniture_bool",!1),this.set("appliances_bool_total",!1),this.set("appliances","gorenje"),this.set("transportation_expenses",5)}storageToRequestBody(e){const t={};for(const n in e)"length"!==n&&"costPerMetre"!=n&&"color"!=n&&("true"!==String(e[n])?"false"!==String(e[n])?isFinite(Number(e[n]))?t[n]=Number(e[n]):t[n]=e[n]:t[n]=0:t[n]=1);return JSON.stringify(t)}}class o{static numberToEncodedLetter(e){if(isNaN(e))return;let t,n=(e=Math.abs(Math.floor(e)))%26,l=e/26;return e<=26?this.numToLetter(e):(l>=1&&(0===n&&l--,t=this.numberToEncodedLetter(l)),0===n&&(n=26),t+this.numToLetter(n))}static numToLetter(e){if(!(e>26||e<0))return 0===e?"":this.alphabet.slice(e-1,e)}}o.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var s,a=(e=>(e.Cozy="cozy",e.Japandi="japandi",e.Modern="modern",e.Fusion="fusion",e.NeoClassic="neoclassic",e))(a||{});(s=a||(a={})).fromString=function(e){return"japandi"===e?"japandi":"neoclassic"===e?"neoclassic":"modern"===e?"modern":"fusion"===e?"fusion":"cozy"},s.fromNumber=function(e){return 0===e?"cozy":1===e?"japandi":2===e?"fusion":3===e?"modern":"neoclassic"},s.inUkrainian=function(e){switch(e){case"neoclassic":return"Нео Класика";case"japandi":return"Джапанді";case"fusion":return"Фьюжн";case"modern":return"Модерн";default:return"Козі"}};var r=(e,t,n)=>new Promise(((l,i)=>{var o=e=>{try{a(n.next(e))}catch(e){i(e)}},s=e=>{try{a(n.throw(e))}catch(e){i(e)}},a=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);a((n=n.apply(e,t)).next())}));class c{constructor(e){this._storage=e}collectPortugalClientData(e){return r(this,null,(function*(){return fetch("https://script.google.com/macros/s/AKfycbzyzzY4bi4yQoHdsTeVmm8BxGQ-bGW_-rK_erhrFA0zKak6rQ27p-k9Mx3HWk6vKEIatw/exec",{method:"POST",body:e}).catch((e=>console.error("Failed to collect consultation data!",e.message)))}))}collectClientData(e){return r(this,null,(function*(){return fetch("https://script.google.com/macros/s/AKfycbyTfAJSAOSn1mB5Ua10w0AHAdKLb1weCd3ve139FkPzbqLEPnBeiE8gGGTq5S6XhmevIQ/exec",{method:"POST",body:e}).catch((e=>console.error("Failed to collect consultation data!",e.message)))}))}collectCalcData(){return r(this,null,(function*(){const e=new FormData,t=a.fromString(this._storage.get("style")),n=this._storage.get("space"),l=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+("modern"==t||"neoclassic"==t?1:0);e.append("Стиль",a.inUkrainian(t)),e.append("Ціна за метр",this._storage.get("costPerMetre")),e.append("Загальна ціна",this._storage.get("summedPrice")),e.append("Площа",n),e.append("Кількість кімнат",this._storage.get("amount_of_rooms")),e.append("Кількість санвузлів",this._storage.get("amount_of_bathrooms")),e.append("Ванна",this._storage.get("bath")?"1":"0"),e.append("Душ",this._storage.get("shower")?"1":"0");const i=this._storage.get("ceiling"),o=this._storage.get("flooring"),s="stretch ceiling"==i?"Натяжна матова":"gapless"==i?"Натяжна бесщелева матова":"Гіпсокартон",r="laminat"==o?"Ламінат":"vynil"==o?"Вінілова підлога":"Паркет",c=this._storage.get("appliances_bool_total")?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"Не обрано";return e.append("Стеля",s),e.append("Підлогове покриття",r),e.append("Стяжка підлоги",this._storage.get("floor_screed")?"1":"0"),e.append("Шумоізоляція",this._storage.get("denoising")?"1":"0"),e.append("Вхідні двері",this._storage.get("entrance_doors")?"1":"0"),e.append("Другий шар гіпсокартону",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("Гігієнічний душ",this._storage.get("hygienic_shower")?"1":"0"),e.append("Тепла підлога",this._storage.get("heated_flooring")?"1":"0"),e.append("Кондиціювання",this._storage.get("conditioning")?"1":"0"),e.append("Меблі",this._storage.get("furniture_bool")?"1":"0"),e.append("Техніка",c),e.append("Термін виконання робіт",l.toString()),fetch("https://script.google.com/macros/s/AKfycbyt7QOcA0Dp_2voHy2w1rVGCllwvW_SX_V8iDTD5E7zJohqH0C4/exec",{method:"POST",body:e}).catch((e=>console.error(e)))}))}collectSpecificationData(e){return r(this,null,(function*(){const t=a.fromString(this._storage.get("style")),n=this._storage.get("space"),l=(n<=40?3:n<=80?4:n<=100?5:n<=130?6:n<=150?7:n<=175?8:9)+("modern"==t||"neoclassic"==t?1:0);e.append("Стиль",a.inUkrainian(t)),e.append("Ціна за метр",this._storage.get("costPerMetre")),e.append("Загальна ціна",this._storage.get("summedPrice")),e.append("Площа",n),e.append("Кількість кімнат",this._storage.get("amount_of_rooms")),e.append("Кількість санвузлів",this._storage.get("amount_of_bathrooms")),e.append("Ванна",this._storage.get("bath")?"1":"0"),e.append("Душ",this._storage.get("shower")?"1":"0");const i=this._storage.get("ceiling"),o=this._storage.get("flooring"),s="stretch ceiling"==i?"Натяжна матова":"gapless"==i?"Натяжна бесщелева матова":"Гіпсокартон",r="laminat"==o?"Ламінат":"vynil"==o?"Вінілова підлога":"Паркет",c=this._storage.get("appliances_bool_total")?this._storage.get("appliances").charAt(0).toUpperCase()+this._storage.get("appliances").slice(1):"Не обрано";return e.append("Стеля",s),e.append("Підлогове покриття",r),e.append("Стяжка підлоги",this._storage.get("floor_screed")?"1":"0"),e.append("Шумоізоляція",this._storage.get("denoising")?"1":"0"),e.append("Вхідні двері",this._storage.get("entrance_doors")?"1":"0"),e.append("Другий шар гіпсокартону",this._storage.get("second_gypsum_layer")?"1":"0"),e.append("Гігієнічний душ",this._storage.get("hygienic_shower")?"1":"0"),e.append("Тепла підлога",this._storage.get("heated_flooring")?"1":"0"),e.append("Кондиціювання",this._storage.get("conditioning")?"1":"0"),e.append("Меблі",this._storage.get("furniture_bool")?"1":"0"),e.append("Техніка",c),e.append("Термін виконання робіт",l.toString()),fetch("https://script.google.com/macros/s/AKfycbzymV7zIns6N9AdE882E44BwQAFZ_wy0JNIahqsoDWx3kqLi-U/exec",{method:"POST",body:e}).catch((e=>console.error(e)))}))}collectPortugalCalcData(t){return r(this,null,(function*(){const n=Boolean(this._storage.get("appliances_bool_total")),l=Boolean(this._storage.get("furniture_bool")),i=this._storage.get("space"),o=Boolean(this._storage.get("bath")),s=Boolean(this._storage.get("shower")),a=this._storage.get("amount_of_rooms"),r=this._storage.get("amount_of_bathrooms"),c=Boolean(this._storage.get("demontage")),p=this._storage.get("windows_installation"),g=Boolean(this._storage.get("finishing_materials")),u=Boolean(this._storage.get("cement_screed")),d=Boolean(this._storage.get("builtin_furiture")),m=this._storage.get("heated_flooring"),h=Boolean(this._storage.get("denoising")),v=Boolean(this._storage.get("entrance_doors")),f=this._storage.get("conditioning"),C=this._storage.get("flooring"),$=this._storage.get("transportation_expenses"),_=this._storage.get("appliances"),w=this._storage.get("summedPrice"),y=this._storage.get("costPerMetre"),b=(i<=40?3:i<=80?4:i<=100?5:i<=130?6:i<=150?7:i<=175?8:9)+("modern"==t||"neoclassic"==t?1:0),k=new FormData;return k.append("Style",t),k.append("Total cost VAT",e.formatCurrency(w)),k.append("Total cost",e.formatCurrency(w/1.23)),k.append("Cost per metre",e.formatCurrency(y)),k.append("Cost per metre VAT",e.formatCurrency(1.23*y)),k.append("Area",i.toString()),k.append("Number of bedrooms",a.toString()),k.append("Number of bathrooms",r.toString()),k.append("Bath",o?"1":"0"),k.append("Shower",s?"1":"0"),k.append("Distance from Lisbon",$.toString()),k.append("Flooring",C),k.append("Finishing materials",g?"1":"0"),k.append("Dismantling works",c?"1":"0"),k.append("Cement screed",u?"1":"0"),k.append("Entrance doors",v?"1":"0"),k.append("Soundproofing",h?"1":"0"),k.append("Built-in furniture",d?"1":"0"),k.append("Underfloor heating",m.toString()),k.append("Air conditioning",f.toString()),k.append("Window installation",p.toString()),k.append("Decorating",l?"1":"0"),k.append("Appliances",n?_:"0"),k.append("Time to completion",b.toString()),fetch("https://script.google.com/macros/s/AKfycbwnwi3SZ8gK3zSYW2DEoc6BtY9HS1stpRSHPW6pATmX2UawetpC-74YPZ5LjjX282Ki/exec",{method:"POST",body:k}).catch((e=>console.error(e)))}))}collectPortugalSpecificationData(t){return r(this,null,(function*(){const n=this._storage.get("style"),l=Boolean(this._storage.get("appliances_bool_total")),i=Boolean(this._storage.get("furniture_bool")),o=this._storage.get("space"),s=Boolean(this._storage.get("bath")),a=Boolean(this._storage.get("shower")),r=this._storage.get("amount_of_rooms"),c=this._storage.get("amount_of_bathrooms"),p=Boolean(this._storage.get("demontage")),g=this._storage.get("windows_installation"),u=Boolean(this._storage.get("finishing_materials")),d=Boolean(this._storage.get("cement_screed")),m=Boolean(this._storage.get("builtin_furiture")),h=this._storage.get("heated_flooring"),v=Boolean(this._storage.get("denoising")),f=Boolean(this._storage.get("entrance_doors")),C=this._storage.get("conditioning"),$=this._storage.get("flooring"),_=this._storage.get("transportation_expenses"),w=this._storage.get("appliances"),y=this._storage.get("summedPrice"),b=this._storage.get("costPerMetre"),k=(o<=40?3:o<=80?4:o<=100?5:o<=130?6:o<=150?7:o<=175?8:9)+("modern"==n||"neoclassic"==n?1:0);return t.append("Style",n),t.append("Total cost VAT",e.formatCurrency(y)),t.append("Total cost",e.formatCurrency(y/1.23)),t.append("Cost per metre",e.formatCurrency(b)),t.append("Cost per metre VAT",e.formatCurrency(1.23*b)),t.append("Area",o.toString()),t.append("Number of bedrooms",r.toString()),t.append("Number of bathrooms",c.toString()),t.append("Bath",s?"1":"0"),t.append("Shower",a?"1":"0"),t.append("Distance from Lisbon",_.toString()),t.append("Flooring",$),t.append("Finishing materials",u?"1":"0"),t.append("Dismantling works",p?"1":"0"),t.append("Cement screed",d?"1":"0"),t.append("Entrance doors",f?"1":"0"),t.append("Soundproofing",v?"1":"0"),t.append("Built-in furniture",m?"1":"0"),t.append("Underfloor heating",h.toString()),t.append("Air conditioning",C.toString()),t.append("Window installation",g.toString()),t.append("Decorating",i?"1":"0"),t.append("Appliances",l?w:"0"),t.append("Time to completion",k.toString()),fetch("https://script.google.com/macros/s/AKfycbzwN8RKdZRUWDBLNnvUwxxK9FXHUVPeqPpGFJYu9NT9zLsc34JKzIHgHz1CwFbNYGzs/exec",{method:"POST",body:t}).catch((e=>console.error(e)))}))}}var p=(e,t,n)=>new Promise(((l,i)=>{var o=e=>{try{a(n.next(e))}catch(e){i(e)}},s=e=>{try{a(n.throw(e))}catch(e){i(e)}},a=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);a((n=n.apply(e,t)).next())}));fetch("https://docs.google.com/spreadsheets/d/1KkkpKbytztt48mwP1RGgpVFpfke8-IqB0KLWA8Sn2FE/gviz/tq?tqx=out:json?tq=SELECT *").then((e=>e.text())).then((s=>{var a,r,g,u,d,m,h,v,f,C,_,w,y,b,k,S,F,L,x,T,P,B,G,A,D,N,E,M,z,K,O,I,j,U,J,q,H,V,W,Q,R,Y,X,Z,ee,te,ne,le,ie,oe,se,ae,re,ce,pe,ge,ue,de,me,he,ve,fe,Ce,$e,_e,we,ye,be,ke,Se,Fe,Le,xe,Te,Pe,Be,Ge,Ae;const De=JSON.parse(s.substring(s.length-2,0).replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","")).table.rows,Ne=new n(De.map(((e,n)=>e.c.map((function(e,l){var i;return null===e||null===e.v?new t("","0"):new t(`${o.numberToEncodedLetter(l+1)}${n+1}`,null!=(i=e.v)?i:e.f)})).filter((e=>null!=e)))).reduce(((e,t)=>[...e,...t]))),Ee=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;$("img").each((function(){$(this).attr("loading","eager")}));const Me=document.getElementById("submitBtn"),ze=[168,9],Ke=[182,10],Oe=[197,9],Ie=new i(l.uk,!1);let je=Ie.get("appliances");const Ue=Ne.getCell("G7").numeric();$("#course").html(e.formatCurrency(Ue));const Je=Ie.get("style");let qe=Boolean(Ie.get("appliances_bool_total")),He=Boolean(Ie.get("furniture_bool")),Ve=Ie.get("space"),We=Boolean(Ie.get("bath")),Qe=Boolean(Ie.get("shower")),Re=Ie.get("amount_of_rooms"),Ye=Ie.get("amount_of_bathrooms"),Xe="",Ze="",et=Ie.get("ceiling"),tt=Ie.get("hygienic_shower"),nt=Ie.get("second_gypsum_layer"),lt=Ie.get("floor_screed"),it=Ie.get("heated_flooring"),ot=Ie.get("denoising"),st=Ie.get("entrance_doors"),at=Ie.get("conditioning"),rt=Ie.get("flooring"),ct=0,pt=0,gt=Ie.get("summedPrice"),ut=Ie.get("costPerMetre"),dt=$("#furnitureList");$("#total").html(e.formatCurrency(gt)),$("#space").html(Ve.toString()),$("#pricePerMetre").html(e.formatCurrency(ut));const mt=1+Ne.getCell("S164").numeric()/100,ht=1+Ne.getCell("S120").numeric()/100;let vt=Ve<=40?3:Ve<=80?4:Ve<=100?5:Ve<=130?6:Ve<=150?7:Ve<=175?8:9;"modern"!=Je&&"neoclassic"!=Je||(vt+=1),$("#months").html(vt.toString());const ft=Ne.getCell("S44").numeric(),Ct=Ne.getCell("S42").numeric();"cozy"==Je?(Xe="I",Ze="A"):"japandi"==Je?(Xe="K",Ze="B"):"fusion"==Je?(Xe="M",Ze="C"):"modern"==Je?(Xe="O",Ze="D"):"neoclassic"==Je&&(Xe="Q",Ze="E");let $t,_t,wt,yt,bt=0,kt=0;"laminat"==rt?($t="60",wt="91",kt=Ve*(Ve<=70?201.26:198.81)*ft):"vynil"==rt?($t="61",wt="92",kt=Ve*(Ve<=70?220.33:161.8)*ft):"parket"==rt&&($t="62",wt="93",kt=Ve*(Ve<=80?369.96:240.31)*ft),"stretch ceiling"==et?(_t="56",yt=0,bt=Ne.getCell(`${Xe}56`).numeric()*Ve):"gapless"==et?(_t="57",yt=0,bt=Ve*(Ve<=60?611.64:Ve<=95?548.9:Ve<=1e3?581.94:0)*ft*1.65):"gypsum"==et&&(_t="58",yt=1,bt=Ve*(Ve<=60?283.08:Ve<=95?281.22:Ve<=125?338.33:362.47)*1.35*ft);let St=$("#workList"),Ft="",Lt=2523*((Re>0?6:0)+(We?2:0)+(Qe?2:0)+2*Ye)*ft,xt=1974*((Re>0?3:0)+(We?1:0)+(Qe?1:0)+2*Ye)*ft,Tt=Ve*Ye*(Ve<=100?83.2:33.98);const Pt=Ne.getCell(`${Xe}45`).numeric()*Ve;console.log(`inflation: ${ft}`),console.log(`rooms: ${Re}`),console.log(`baths: ${Ye}`),console.log(`bath: ${We}`),console.log(`shower: ${Qe}`),console.log(`vents: ${Tt}`),console.log(`canalisation: ${xt}`),console.log(`water: ${Lt}`);const Bt=[Ve*(Ve<=60?1142.78:Ve<=95?883.87:Ve<=125?819.43:925.61)*ft,Ve*(Ve<=60?700.67:Ve<=100?687.36:Ve<=130?341.25:317.36)*ft*1.1,Ne.getCell(`${Xe}50`).numeric(),Ve*(Ve<=50?1e3:990)*ft,140*(Ve<=60?Ne.getCell(`${Xe}54`).numeric():Ve<=80?50:Ve<=120?78:Ve<=180?114:162)*("modern"==Je||"neoclassic"==Je?1:0),Ve*(Ve<=60?418.86:Ve<=100?416.29:Ve<=135?443.73:481.67)*("gypsum"==et?1:0)*ft,bt,kt,Ve*(Ve<=70?114.47:86.84)*ft,Ve*(Ve<=70?206.59:170)*ft*("japandi"==Je||"fusion"==Je?1:0)],Gt=[1,Ye,Re+Ye,1,1,yt,1,1,1,1],At=[48,49,50,52,54,53,_t,$t,64,66];ct+=Lt*Ct+((We?Ye*Ne.getCell(`${Xe}47`).numeric():0)+(Qe?Ye*Ne.getCell(`${Xe}46`).numeric():0))*Ct-1750*ft,Ft=Yt(Ne.getCell("F42").value(),"",Math.round(Lt*Ct+((We?Ye*Ne.getCell(`${Xe}47`).numeric():0)+(Qe?Ye*Ne.getCell(`${Xe}46`).numeric():0))*Ct-1750*ft)+" грн."),$("#workList").append(Ft),ct+=xt*Ct,Ft=Yt(Ne.getCell("F43").value(),"",Math.round(xt*Ct)+" грн."),$("#workList").append(Ft),ct+=Tt*Ct*ft,Ft=Yt(Ne.getCell("F44").value(),"",Math.round(Tt*Ct*ft)+" грн."),$("#workList").append(Ft),ct+=Pt*Ct,Ft=Yt(Ne.getCell("F45").value(),"",Math.round(Pt*Ct)+" грн."),$("#workList").append(Ft),Qe&&(Ft=Yt(Ne.getCell("F46").value(),"",Ne.getCell(Zt(Je)+46).numeric().toString()+" грн."),$("#workList").append(Ft)),We&&(Ft=Yt(Ne.getCell("F47").value(),"",Ne.getCell(Zt(Je)+47).numeric().toString()+" грн."),$("#workList").append(Ft));for(let e=0;e<At.length;e++){const t=Bt[e]*Gt[e]*Ct;0===t||isNaN(t)||(ct+=t,Ft=Yt(Ne.getCell("F"+At[e]).value(),"",Math.round(t)+" грн."),$("#workList").append(Ft))}Ft=Yt(Ne.getCell("F66").value(),"",Math.round(.022*ct*Ct)+" грн."),$("#workList").append(Ft),ct+=.022*ct*Ct,Ft=Yt(Ne.getCell("F67").value(),"",Math.round((2*vt*1200+3e3+100*Ve+120*Ve)*Ct)+" грн."),$("#workList").append(Ft),ct+=(2*vt*1200+3e3+100*Ve)*Ct,$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\">Комплектуючі та чистові матеріали</h4><span class='notation amount'> </span><span class='notation'>Ціна</span>");let Dt=[Ne.getCell(`${Xe}72`).numeric(),Ne.getCell(`${Xe}73`).numeric(),Ne.getCell(`${Xe}74`).numeric(),Ne.getCell(`${Xe}75`).numeric(),Ne.getCell(`${Xe}76`).numeric(),Ne.getCell(`${Xe}77`).numeric(),Ne.getCell(`${Xe}79`).numeric(),Ne.getCell(`${Xe}80`).numeric(),Ne.getCell(`${Xe}81`).numeric(),Ne.getCell(`${Xe}82`).numeric(),Ne.getCell(`${Xe}83`).numeric(),Ne.getCell(`${Xe}84`).numeric(),Ne.getCell(`${Xe}85`).numeric(),Ne.getCell(`${Xe}86`).numeric(),Ne.getCell(`${Xe}87`).numeric(),Ne.getCell(`${Xe}88`).numeric(),Ne.getCell(`${Xe}89`).numeric(),Ne.getCell(`${Xe+wt}`).numeric(),100*Ve*Ne.getCell("S74").numeric()],Nt=[Ye+Re,35*Ye,.66*Ve,.66*Ve,.59*Ve,Ve<=50?42:Ve<=90?60:Ve<=120?84:90,Ye,Ye,Ye,Ye,Number(We),Number(Qe),Number(Qe),Ye,Ye,Ye,Ye,Ve<100?Ve-7*Ye:Ve-10*Ye,1],Et=[72,73,74,75,76,77,79,80,81,82,83,84,85,86,87,88,89,wt,94];for(let e=0;e<Et.length;e++){let t=Dt[e]*Nt[e]*Ne.getCell("S72").numeric();0===t||isNaN(t)||(ct+=t,Ft=Yt(Ne.getCell("F"+Et[e]).value(),"",Math.round(t)+" грн."),$("#workList").append(Ft))}$("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\">Витрати компанії</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Ft=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Ne.getCell("F100").value()}</span><span class='list-text amount'>${vt} міс.</span><span class='list-text'> </span></div></div>`,$("#workList").append(Ft);const Mt=[Ne.getCell(`${Xe}101`).numeric(),Ne.getCell(`${Xe}102`).numeric()],zt=[vt,vt],Kt=[101,102];for(let e=0;e<Kt.length;e++){let t=Mt[e]*zt[e];ct+=t,Ft=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Ne.getCell(`F${Kt[e]}`).value()}</span><span class='list-text amount'>${Math.round(t/vt)} грн./місяць</span><span class='list-text'>${Math.round(t)} грн.</span></div></div>`,$("#workList").append(Ft)}ct+=Ue*Ve*Ne.getCell("G37").numeric()+vt*Ne.getCell(`${Xe}214`).numeric(),Ft=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>\n\t\t${Ne.getCell("F212").value()}\n\t\t\t</span><span class='list-text amount'></span><span class='list-text'>${e.formatCurrency(Ue*Ne.getCell("G37").numeric()*Ve)} грн.</span></div></div>`,$("#workList").append(Ft),Ft=`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${Ne.getCell("F214").value()}</span><span class='list-text amount'>${Ne.getCell(`${Xe}214`).numeric()} грн./місяць</span><span class='list-text'>${Math.round(vt*Ne.getCell(`${Xe}214`).numeric())} грн.</span></div></div>`,$("#workList").append(Ft),He&&($("#furnitureList").append('</div><div class="list-option-container"></div>'),$("#furnitureList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\">Кухня</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Jt(Ne.getCell("F127").value(),null==(a=Ne.getCell(`${Ze}127`))?void 0:a.value(),1,Ne.getCell(`${Xe}127`).numeric(),Ne.getCell("G120").value()),pt+=Math.round(Ne.getCell(`${Xe}129`).numeric()*mt)+Math.round(Ne.getCell(`${Xe}128`).numeric()*mt),dt.append('<div class="option-block"><div class="division-block pricelist small-heading"></div><div class="list-option-container"></div></div>'),$("#furnitureList .option-block .list-option-container").last().append(`<span class='name'>${Ne.getCell("F127").value()}\n\t\t\t\t\t\t</span><span class='list-text amount'>1 шт.</span><span class='list-text'>${e.formatCurrency(Ne.getCell(`${Xe}128`).numeric()*mt)} грн.</span>`),dt.append('<div class="option-block"><div class="division-block pricelist small-heading"></div><div class="list-option-container"></div></div>'),$("#furnitureList .option-block .list-option-container").last().append(`<span class='name'>${Ne.getCell("F128").value()}</span><span class='list-text amount'>1 шт.</span><span class='list-text'>${e.formatCurrency(Ne.getCell(`${Xe}129`).numeric()*mt)} грн.</span>`),Jt(Ne.getCell("F130").value(),null==(r=Ne.getCell(`${Ze}130`))?void 0:r.value(),1,null==(g=Ne.getCell(`${Xe}130`))?void 0:g.numeric(),null==(u=Ne.getCell("G130"))?void 0:u.value()),Jt(Ne.getCell("F131").value(),null==(d=Ne.getCell(Ze+"131"))?void 0:d.value(),1,null==(m=Ne.getCell(`${Xe}131`))?void 0:m.numeric(),null==(h=Ne.getCell("G131"))?void 0:h.value()),Jt(Ne.getCell("F132").value(),null==(v=Ne.getCell(Ze+"132"))?void 0:v.value(),1,null==(f=Ne.getCell(`${Xe}132`))?void 0:f.numeric(),null==(C=Ne.getCell("G132"))?void 0:C.value()),Jt(Ne.getCell("F133").value(),null==(_=Ne.getCell(Ze+"133"))?void 0:_.value(),4,null==(w=Ne.getCell(`${Xe}133`))?void 0:w.numeric(),null==(y=Ne.getCell("G133"))?void 0:y.value()),Jt(Ne.getCell("F134").value(),null==(b=Ne.getCell(Ze+"134"))?void 0:b.value(),1,null==(k=Ne.getCell(`${Xe}134`))?void 0:k.numeric(),null==(S=Ne.getCell("G134"))?void 0:S.value()),Xt($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),Xt($("#furnitureList .list-option-container").last(),"<h4 class=\"pricelist-header small no-padding\">Вітальня</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Jt(Ne.getCell("F138").value(),null==(F=Ne.getCell(Ze+"138"))?void 0:F.value(),1,null==(L=Ne.getCell(`${Xe}138`))?void 0:L.numeric(),null==(x=Ne.getCell("G138"))?void 0:x.value()),Jt(Ne.getCell("F139").value(),null==(T=Ne.getCell(Ze+"139"))?void 0:T.value(),1,null==(P=Ne.getCell(`${Xe}139`))?void 0:P.numeric(),null==(B=Ne.getCell("G139"))?void 0:B.value()),Xt($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),Xt($("#furnitureList .list-option-container").last(),"<h4 class=\"pricelist-header small no-padding\">Спальня</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Jt(Ne.getCell("F141").value(),null==(G=Ne.getCell(Ze+"141"))?void 0:G.value(),1,null==(A=Ne.getCell(`${Xe}141`))?void 0:A.numeric(),null==(D=Ne.getCell("G141"))?void 0:D.value()),Jt(Ne.getCell("F142").value(),null==(N=Ne.getCell(Ze+"142"))?void 0:N.value(),1,null==(E=Ne.getCell(`${Xe}142`))?void 0:E.numeric(),null==(M=Ne.getCell("G142"))?void 0:M.value()),Jt(Ne.getCell("F143").value(),null==(z=Ne.getCell(Ze+"143"))?void 0:z.value(),2,null==(K=Ne.getCell(`${Xe}143`))?void 0:K.numeric(),null==(O=Ne.getCell("G143"))?void 0:O.value()),Jt(Ne.getCell("F144").value(),null==(I=Ne.getCell(Ze+"144"))?void 0:I.value(),1,null==(j=Ne.getCell(`${Xe}144`))?void 0:j.numeric(),null==(U=Ne.getCell("G144"))?void 0:U.value()),Jt(Ne.getCell("F145").value(),null==(J=Ne.getCell(Ze+"145"))?void 0:J.value(),1,null==(q=Ne.getCell(`${Xe}145`))?void 0:q.numeric(),null==(H=Ne.getCell("G145"))?void 0:H.value()),Jt(Ne.getCell("F146").value(),null==(V=Ne.getCell(Ze+"146"))?void 0:V.value(),1,null==(W=Ne.getCell(`${Xe}146`))?void 0:W.numeric(),null==(Q=Ne.getCell("G146"))?void 0:Q.value()),Xt($("#furnitureList"),'</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\">Світильники</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Jt(Ne.getCell("F148").value(),null==(R=Ne.getCell(Ze+"148"))?void 0:R.value(),Math.ceil(.48*Ve),null==(Y=Ne.getCell(`${Xe}148`))?void 0:Y.numeric(),null==(X=Ne.getCell("G148"))?void 0:X.value()),Jt(Ne.getCell("F149").value(),null==(Z=Ne.getCell(Ze+"149"))?void 0:Z.value(),1,null==(ee=Ne.getCell(`${Xe}149`))?void 0:ee.numeric(),null==(te=Ne.getCell("G149"))?void 0:te.value()),Jt(Ne.getCell("F151").value(),null==(ne=Ne.getCell(Ze+"151"))?void 0:ne.value(),1,null==(le=Ne.getCell(`${Xe}151`))?void 0:le.numeric(),null==(ie=Ne.getCell("G151"))?void 0:ie.value()),Jt(Ne.getCell("F153").value(),null==(oe=Ne.getCell(Ze+"153"))?void 0:oe.value(),1,null==(se=Ne.getCell(`${Xe}153`))?void 0:se.numeric(),null==(ae=Ne.getCell("G153"))?void 0:ae.value()),Jt(Ne.getCell("F154").value(),null==(re=Ne.getCell(Ze+"154"))?void 0:re.value(),1,null==(ce=Ne.getCell(`${Xe}154`))?void 0:ce.numeric(),null==(pe=Ne.getCell("G154"))?void 0:pe.value()),Jt(Ne.getCell("F150").value(),null==(ge=Ne.getCell(Ze+"150"))?void 0:ge.value(),Re>1?1:0,null==(ue=Ne.getCell(`${Xe}150`))?void 0:ue.numeric(),null==(de=Ne.getCell("G150"))?void 0:de.value()),Jt(Ne.getCell("F152").value(),null==(me=Ne.getCell(Ze+"152"))?void 0:me.value(),2,null==(he=Ne.getCell(`${Xe}152`))?void 0:he.numeric(),null==(ve=Ne.getCell("G152"))?void 0:ve.value()),$("#furnitureList").append('</div><div class="list-option-container margined"></div>'),$("#furnitureList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\">Декор</h4><span class='notation amount'>Кількість</span><span class='notation'>Ціна</span>"),Jt(Ne.getCell("F156").value(),null==(fe=Ne.getCell(Ze+"156"))?void 0:fe.value(),Re,null==(Ce=Ne.getCell(`${Xe}156`))?void 0:Ce.numeric(),null==($e=Ne.getCell("G156"))?void 0:$e.value()),Jt(Ne.getCell("F157").value(),null==(_e=Ne.getCell(Ze+"157"))?void 0:_e.value(),Re,null==(we=Ne.getCell(`${Xe}157`))?void 0:we.numeric(),null==(ye=Ne.getCell("G157"))?void 0:ye.value()),Jt(Ne.getCell("F158").value(),null==(be=Ne.getCell(Ze+"158"))?void 0:be.value(),Re,null==(ke=Ne.getCell(`${Xe}158`))?void 0:ke.numeric(),null==(Se=Ne.getCell("G158"))?void 0:Se.value()),Jt(Ne.getCell("F159").value(),null==(Fe=Ne.getCell(Ze+"159"))?void 0:Fe.value(),1,null==(Le=Ne.getCell(`${Xe}159`))?void 0:Le.numeric(),null==(xe=Ne.getCell("G159"))?void 0:xe.value()),Jt(Ne.getCell("F160").value(),null==(Te=Ne.getCell(Ze+"160"))?void 0:Te.value(),Re-1,null==(Pe=Ne.getCell(`${Xe}160`))?void 0:Pe.numeric(),null==(Be=Ne.getCell("G160"))?void 0:Be.value()),Xt($("#furnitureList"),Yt(Ne.getCell("F162").value()," ",Math.round(.03*pt*mt)+" грн.")),pt+=.03*pt*mt,Xt($("#furnitureList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),Xt($("#furnitureList .list-option-container").last(),`<span class='name summary'>Всього по меблях:</span><span class='list-text summary work'>${e.formatCurrency(Math.round(pt))} грн.</span>`)),(tt||nt||lt||it||ot||st||at)&&($("#workList").append('</div><div class="list-option-container margined"></div>'),$("#workList .list-option-container").last().append("<h4 class=\"pricelist-header small no-padding\"> Опції</h4><span class='notation amount'> </span><span class='notation'>Ціна</span>"));const Ot=Ne.getCell("T109").numeric();let It=[Ve*Ne.getCell(`${Xe}109`).numeric()*1.25,+tt*Ne.getCell(`${Xe}110`).numeric()*1.25,1.25*Ne.getCell(`${Xe}111`).numeric(),1.25*Ve*(Ve<=60?306.26:Ve<=95?246.43:Ve<=125?221.2:277.29)*Ot,(+ot+yt==2?1:0)*Ve*1.25*(Ve<=60?60.91:Ve<=95?64.57:Ve<=125?63.87:66.24)*Ot+(+ot+yt===1?1:0)*Ve*Ne.getCell(`${Xe}114`).numeric()*1.25,+ot>0?1.25*Ve*(Ve<=60?90.02:Ve<=95?60.78:Ve<=125?58.29:79.01)*Ot:0,1.1*Ne.getCell(`${Xe}116`).numeric()+1.25*Ne.getCell(`${Xe}117`).numeric(),Ne.getCell(`${Xe}119`).numeric()*Ve*1.25+Ne.getCell(`${Xe}120`).numeric()*ht*1.05],jt=[lt,tt?Ye:0,it,nt,ot,ot,st,at],Ut=[109,110,111,112,113,115,116,120];for(let e=0;e<Ut.length;e++){let t=It[e]*Number(jt[e]);0===t||isNaN(t)||0==jt[e]||null==Ut[e]||(ct+=t,Xt(St,Yt((null==(Ge=Ne.getCell("F"+Ut[e]))?void 0:Ge.value())+", "+(null==(Ae=Ne.getCell(`${Ze}${Ut[e]}`))?void 0:Ae.value()),"",Math.round(t)+" грн.")))}function Jt(t,n,l,i,o){He&&0!=l&&l&&i&&(pt+=i*mt*l,Xt(dt,'<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),null!==n?Xt($("#furnitureList .option-block .list-option-container").last(),`<span class='name'>${t}, ${n}</span><span class='list-text amount'>${l} ${o}</span><span class='list-text'>${e.formatCurrency(i*l*(1+Ne.getCell("S164").numeric()/100))} грн.</span>`):Xt($("#materialsList .option-block .list-option-container").last(),`<span class='name'>${t}</span><span class='list-text'>${l} ${o} </span>`))}qe||$(".comfy-section").toggle(!1),He||$("#furnitureList").toggle(!1),Xt($("#workList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),Xt($("#workList .list-option-container").last(),`<span class='name summary'>Всього по будівельній частині:</span><span class='list-text summary work'>${e.formatCurrency(ct)} грн.</span>`),Xt($("#materialsList"),'<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),Xt($("#materialsList .list-option-container").last(),`<span class='name summary'>Всього по будівельній частині:</span><span class='list-text summary work'>${e.formatCurrency(ct)} грн.</span>`);let qt,Ht=0,Vt=$("#appliancesList"),Wt=$("#appliancesListTotal");"gorenje"===je?qt=ze:"bosch"===je?qt=Ke:"miele"===je&&(qt=Oe);let Qt=0;if("undefined"!==je){Qt=1;for(let t=0;t<qt[1];t++)Vt.append('<div class="option-block"><div class="division-block white"></div><div class="list-option-container appliances"></div></div>'),$("#appliancesList .option-block .list-option-container.appliances").last().append(`<span class='name white'>${Ne.getCell("F"+(qt[0]+t)).value()} ${Ne.getCell("E"+(qt[0]+t)).value()}</span><span class='list-text white'>${e.formatCurrency(Ne.getCell("D"+(qt[0]+t)).numeric())} грн.</span>`),qe&&(Wt.append('<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),$("#appliancesListTotal .option-block .list-option-container").last().append(`<span class='name'>${Ne.getCell("F"+(qt[0]+t)).value()} ${Ne.getCell("E"+(qt[0]+t)).value()}</span><span class='list-text amount'>1 шт.</span><span class='list-text'>${e.formatCurrency(Ne.getCell("D"+(qt[0]+t)).numeric())} грн.</span>`)),Ht+=Ne.getCell("D"+(qt[0]+t)).numeric(),Ht+=Ne.getCell("G36").numeric(),Qt++;if(qe){const t=Ne.getCell("G36").numeric();Ht+=t,Wt.append('<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"></div></div>'),$("#appliancesListTotal .option-block .list-option-container").last().append(`<span class='name'>Доставка техніки</span><span class='list-text amount'></span><span class='list-text'>${Qt*t} грн.</span>`),Vt.append('<div class="option-block"><div class="division-block white"></div><div class="list-option-container appliances"></div></div>'),$("#appliancesList .option-block .list-option-container.appliances").last().append(`<span class='name white'>Доставка техніки</span><span class='list-text white'>${Qt*t} грн.</span>`),Wt.append('<div class="division-block pricelist"></div><div class="list-option-container summary"></div>'),$("#appliancesTotalDiscount").html(e.formatCurrency(.9*Ht)),$("#appliancesListTotal .list-option-container").last().append(`<span class='name summary'>Всього по техніці:</span><span class='list-text summary work'>${e.formatCurrency(Ht)} грн.</span>`),$("#appliancesListTotal .list-option-container").last().append(`<span class='name summary'><b>Всього по техніці, зі знижкою</b>:</span><span class='list-text summary work'>${e.formatCurrency(.9*Ht)} грн.</span>`)}}qe||$("#appliancesListTotal").toggle(!1);const Rt=Zt(Je);function Yt(e,t,n){return`<div class="option-block"><div class="division-block pricelist"></div><div class="list-option-container"><span class='name'>${e}</span><span class='list-text amount'>${t}</span><span class='list-text'>${n}</span></div></div>`}function Xt(e,t){e.append(t)}function Zt(e){let t="J";return"cozy"==e?t="J":"japandi"==e?t="L":"fusion"==e?t="N":"modern"==e?t="P":"neoclassic"==e&&(t="R"),t}const en=Ne.getCell(`${Rt}127`).numeric(),tn=Ne.getCell(`${Rt}128`).numeric(),nn=Ne.getCell(`${Rt}129`).numeric(),ln=tn+en+nn;$("#kitchenPrice").html(e.formatCurrency(en)+" грн."),$("#kitchenMontage").html(e.formatCurrency(tn)+" грн."),$("#kitchenDelivery").html(e.formatCurrency(nn)+" грн."),$("#kitchenTotal").html(e.formatCurrency(ln)+" грн"),$("#kitchenTotalPrice").html(e.formatCurrency(Ht)+" грн."),He&&(pt=0),$("#kitchenTotalPriceDiscount").html(e.formatCurrency(.9*Ht)),$("#discountTotal").html(`<span class='bold-text-7'>${e.formatCurrency(Ht-.9*Ht)} грн.</span>`),gt*Ue<ct?$("#totalPriceTotal").html(e.formatCurrency(ct)+" грн. *"):$("#totalPriceTotal").html(e.formatCurrency(gt*Ue)+" грн. *"),$("form#wf-form-consult").on("submit",(e=>{if(e.preventDefault(),$("#agreementCheckbox").is(":checked")?$("#wf-form-consult.warning.agreementcheckbox").toggle(!1):$("#wf-form-consult.warning.agreementcheckbox").toggle(!0),$("#phone").val().length<12?$("#wf-form-consult.warning.inputs.phone").toggle(!0):$("#wf-form-consult.warning.inputs.phone").toggle(!1),$("#name").val()?$("#wf-form-consult.warning.inputs.name").toggle(!1):$("#wf-form-consult.warning.inputs.name").toggle(!0),$("#wf-form-consult.warning").is(":visible"))return!1;{const e=Me.innerText;Me.innerText="Зачекайте...",fetch("https://script.google.com/macros/s/AKfycbyTfAJSAOSn1mB5Ua10w0AHAdKLb1weCd3ve139FkPzbqLEPnBeiE8gGGTq5S6XhmevIQ/exec",{method:"POST",body:new FormData(document.getElementById("wf-form-consult"))}).then((()=>{Me.innerText=e})).catch((e=>console.error("Error!",e.message)))}})),$("form#wf-form-client-info").on("submit",(function(e){return p(this,null,(function*(){if(e.preventDefault(),$("#agreementCheckbox").is(":checked")?$("form#wf-form-client-info .warning.agreementcheckbox").toggle(!1):$("form#wf-form-client-info .warning.agreementcheckbox").toggle(!0),$("#sPhone").val()?$("form#wf-form-client-info .warning.inputs.phone").toggle(!1):$("form#wf-form-client-info .warning.inputs.phone").toggle(!0),$("#sName").val()?$("form#wf-form-client-info .warning.inputs.name").toggle(!1):$("form#wf-form-client-info .warning.inputs.name").toggle(!0),0==$("#sEmail").val().length?($("form#wf-form-client-info .warning.inputs.wrongEmail").toggle(!1),$("form#wf-form-client-info .warning.inputs.emptyEmail").toggle(!0)):Ee.test($("#sEmail").val())?($("form#wf-form-client-info .warning.inputs.wrongEmail").toggle(!1),$("form#wf-form-client-info .warning.inputs.emptyEmail").toggle(!1)):($("form#wf-form-client-info .warning.inputs.wrongEmail").toggle(!0),$("form#wf-form-client-info .warning.inputs.emptyEmail").toggle(!1)),$("form#wf-form-client-info .warning").is(":visible"))return e.preventDefault(),e.stopImmediatePropagation(),!1;return new c(Ie).collectSpecificationData(new FormData(document.getElementById("wf-form-client-info"))),yield function(){return p(this,null,(function*(){$(".modal-note").html("Зачекайте...");const e=$("html").clone().find("script").remove().end().html(),t=new File(['<!DOCTYPE html><html lang="uk">'+e+"</html>"],"source.html",{type:"text/html"}),n=new FormData;n.append("file",t,"source.html");const l=yield fetch("https://api.fortes.agency/convert",{method:"POST",body:n}),i=yield l.json(),o=i.success?i.id:"";$(".modal-note").html("Ми надіслали вам лист на електронну пошту. Якщо ви не бачите його у списку, перевірте папку Спам або зачекайте декілька хвилин."),fetch("https://api.fortes.agency/mail",{method:"POST",body:JSON.stringify({fileId:o,fileName:localStorage.getItem("style"),recipientMail:$("#sEmail").val()}),headers:{"Content-Type":"application/json"}}).finally((()=>{setTimeout((()=>{window.location.assign("/sdyakuiemo")}),2e3)}))}))}(),!1}))}))}))})();